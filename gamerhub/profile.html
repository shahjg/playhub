<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Your Profile ‚Äì TheGaming.co</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="description" content="View your gaming stats, achievements, and customize your profile at TheGaming.co">
  <meta name="robots" content="noindex,nofollow">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}:root{--pink:#ff6b9d;--blue:#4facfe;--purple:#a445b2;--dark:#0a0a0f;--gold:#fbbf24;--green:#34d399}body{font-family:'Inter',sans-serif;background:radial-gradient(circle at 0% 0%,rgba(255,107,157,0.12),transparent 50%),radial-gradient(circle at 100% 0%,rgba(79,172,254,0.12),transparent 50%),var(--dark);color:white;overflow-x:hidden;min-height:100vh}input,textarea,select,button{font-size:16px}h1,h2,h3,h4{font-family:'Bebas Neue',sans-serif;letter-spacing:1px}a{color:inherit;text-decoration:none}
    header{position:fixed;top:0;left:0;right:0;z-index:100;height:60px;display:flex;align-items:center;padding:0 max(18px,env(safe-area-inset-left)) 0 max(18px,env(safe-area-inset-right));background:rgba(10,10,15,0.88);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);border-bottom:1px solid rgba(255,255,255,0.06)}.nav-inner{width:100%;max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:24px}.nav-left{display:flex;align-items:center;gap:24px}.nav-links{display:flex;align-items:center;gap:20px}.nav-link{font-size:0.85rem;font-weight:600;color:rgba(255,255,255,0.7);transition:color 0.2s ease}.nav-link:hover{color:white}.header-logo{font-family:'Bebas Neue',sans-serif;font-size:1.6rem;letter-spacing:4px;color:white;position:relative}.header-logo::after{content:'';position:absolute;bottom:-2px;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--pink),var(--blue),var(--purple))}.header-actions{display:flex;align-items:center;gap:16px}.nav-right-logged-out,.nav-right-logged-in{display:none !important}.user-menu-wrapper{position:relative}.user-pill{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--pink),var(--purple));cursor:pointer;transition:transform 0.15s ease,box-shadow 0.15s ease;color:white;border:none}.user-pill:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(255,107,157,0.4)}.user-pill-label{font-size:0.9rem;font-weight:700;color:white;text-transform:uppercase}.user-pill-skeleton{width:36px;height:36px;border-radius:50%;background:linear-gradient(90deg,rgba(255,255,255,0.04) 0%,rgba(255,255,255,0.08) 50%,rgba(255,255,255,0.04) 100%);background-size:200% 100%;animation:shimmer 1.5s infinite}@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}.user-menu{position:absolute;top:calc(100% + 8px);right:0;min-width:170px;padding:6px;border-radius:14px;background:rgba(10,10,15,0.97);border:1px solid rgba(255,255,255,0.14);box-shadow:0 18px 55px rgba(0,0,0,0.8);opacity:0;transform:translateY(-4px);pointer-events:none;transition:all 0.15s ease;z-index:120}.user-menu.open{opacity:1;transform:translateY(0);pointer-events:auto}.user-menu-item{width:100%;display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:9px;font-size:0.85rem;color:rgba(255,255,255,0.9);background:none;border:none;cursor:pointer;font-family:'Inter',sans-serif}.user-menu-item:hover{background:rgba(255,255,255,0.08)}
    .profile-page{min-height:100vh;padding:100px 16px 60px;padding-left:max(16px,env(safe-area-inset-left));padding-right:max(16px,env(safe-area-inset-right))}.profile-container{max-width:900px;margin:0 auto}
    .profile-hero{display:flex;align-items:flex-start;gap:24px;margin-bottom:32px;padding:28px;background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:20px;position:relative;overflow:hidden}.profile-hero::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--pink),var(--blue),var(--purple))}.avatar-wrapper{position:relative;flex-shrink:0}.avatar-display{width:100px;height:100px;border-radius:50%;background:linear-gradient(135deg,var(--pink),var(--purple));display:flex;align-items:center;justify-content:center;font-size:2.5rem;border:3px solid rgba(255,255,255,0.2);cursor:pointer;transition:all 0.2s ease}.avatar-display:hover{transform:scale(1.05);border-color:var(--pink)}.avatar-edit-hint{position:absolute;bottom:-4px;right:-4px;width:28px;height:28px;background:var(--dark);border:2px solid var(--pink);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.75rem}.profile-info{flex:1;min-width:0}.profile-name-row{display:flex;align-items:center;gap:12px;margin-bottom:6px;flex-wrap:wrap}.profile-display-name{font-size:2rem;letter-spacing:2px;word-break:break-word}.profile-badges{display:flex;gap:8px}.profile-badge{padding:4px 10px;border-radius:20px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em}.badge-premium{background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(245,158,11,0.2));border:1px solid rgba(251,191,36,0.4);color:var(--gold)}.badge-level{background:linear-gradient(135deg,rgba(79,172,254,0.2),rgba(164,69,178,0.2));border:1px solid rgba(79,172,254,0.4);color:var(--blue)}.profile-title-text{font-size:0.9rem;color:rgba(255,255,255,0.5);margin-bottom:12px}.profile-meta{display:flex;gap:20px;font-size:0.85rem;color:rgba(255,255,255,0.5);flex-wrap:wrap}.profile-meta-item{display:flex;align-items:center;gap:6px}
    .xp-section{margin-bottom:24px;padding:20px 24px;background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:16px}.xp-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.xp-level{display:flex;align-items:center;gap:10px}.xp-level-number{font-size:2.2rem;font-family:'Bebas Neue',sans-serif;letter-spacing:2px;background:linear-gradient(135deg,var(--pink),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.xp-level-label{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.1em;color:rgba(255,255,255,0.5)}.xp-numbers{text-align:right}.xp-current{font-size:1.1rem;font-weight:700;color:white}.xp-needed{font-size:0.8rem;color:rgba(255,255,255,0.4)}.xp-bar-container{width:100%;height:12px;background:rgba(255,255,255,0.1);border-radius:6px;overflow:hidden;position:relative}.xp-bar-fill{height:100%;background:linear-gradient(90deg,var(--pink),var(--purple));border-radius:6px;transition:width 0.5s ease;position:relative}.xp-bar-fill::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);animation:xpShine 2s infinite}@keyframes xpShine{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}.xp-rewards{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}.xp-reward-item{padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;font-size:0.75rem;color:rgba(255,255,255,0.6)}.xp-reward-item span{margin-right:4px}
    .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}.stat-card{background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:18px;text-align:center;transition:all 0.2s ease}.stat-card:hover{border-color:rgba(255,255,255,0.15);transform:translateY(-2px)}.stat-icon{font-size:1.5rem;margin-bottom:8px}.stat-value{font-size:1.6rem;font-family:'Bebas Neue',sans-serif;letter-spacing:1px;margin-bottom:4px}.stat-label{font-size:0.7rem;text-transform:uppercase;letter-spacing:0.08em;color:rgba(255,255,255,0.5)}
    .favorite-games{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:24px}.favorite-card{background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:18px}.favorite-label{font-size:0.7rem;text-transform:uppercase;letter-spacing:0.1em;color:rgba(255,255,255,0.4);margin-bottom:10px}.favorite-game{display:flex;align-items:center;gap:12px}.favorite-game-icon{width:44px;height:44px;border-radius:10px;background:rgba(255,255,255,0.1);display:flex;align-items:center;justify-content:center;font-size:1.4rem}.favorite-game-info h4{font-size:1rem;letter-spacing:1px;margin-bottom:2px}.favorite-game-info p{font-size:0.8rem;color:rgba(255,255,255,0.5)}
    .leaderboard-section{background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:24px}.leaderboard-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.leaderboard-title{font-size:1.4rem;letter-spacing:2px}.leaderboard-link{font-size:0.85rem;color:var(--pink);transition:color 0.2s}.leaderboard-link:hover{color:white}.leaderboard-ranks{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}.rank-card{display:flex;align-items:center;gap:12px;padding:12px 14px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:10px;transition:all 0.2s ease}.rank-card:hover{background:rgba(255,255,255,0.06);border-color:rgba(255,255,255,0.15)}.rank-game-icon{font-size:1.3rem}.rank-info{flex:1;min-width:0}.rank-game-name{font-size:0.85rem;font-weight:600;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.rank-score{font-size:0.75rem;color:rgba(255,255,255,0.5)}.rank-position{font-size:1.1rem;font-weight:800;color:var(--gold)}.rank-position.top-10{color:var(--gold)}.rank-position.top-100{color:#94a3b8}.rank-position.unranked{color:rgba(255,255,255,0.3);font-size:0.8rem}
    .status-bar{margin-bottom:24px;padding:10px 16px;border-radius:12px;display:none}.status-bar.visible{display:block}.status-bar.success{background:rgba(52,211,153,0.12);border:1px solid rgba(52,211,153,0.3);color:#6ee7b7}.status-bar.error{background:rgba(255,107,157,0.12);border:1px solid rgba(255,107,157,0.3);color:#ffb3c9}
    .profile-tabs{display:flex;gap:8px;margin-bottom:24px;border-bottom:1px solid rgba(255,255,255,0.08);overflow-x:auto;-webkit-overflow-scrolling:touch}.tab-button{padding:10px 20px;background:none;border:none;color:rgba(255,255,255,0.6);font-size:0.9rem;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;cursor:pointer;border-bottom:2px solid transparent;transition:all 0.2s ease;white-space:nowrap}.tab-button:hover{color:rgba(255,255,255,0.9)}.tab-button.active{color:white;border-bottom-color:var(--pink)}.tab-content{display:none}.tab-content.active{display:block}
    .form-section{background:rgba(15,15,25,0.7);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:24px;margin-bottom:20px}.section-title{font-size:1.4rem;letter-spacing:2px;margin-bottom:16px}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}.form-group{display:flex;flex-direction:column;gap:6px}.form-group.full-width{grid-column:1 / -1}.form-label{font-size:0.78rem;font-weight:600;letter-spacing:0.08em;text-transform:uppercase;color:rgba(255,255,255,0.65)}.form-input{padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.16);background:rgba(5,5,15,0.9);color:white;font-size:0.95rem;outline:none;transition:border 0.2s ease}.form-input:focus{border-color:var(--pink);box-shadow:0 0 0 1px rgba(255,107,157,0.4)}.form-input:disabled{opacity:0.5;cursor:not-allowed}.form-hint{font-size:0.8rem;color:rgba(255,255,255,0.4);margin-top:4px}.info-text{font-size:0.85rem;color:rgba(255,255,255,0.5)}.checkbox-group{display:flex;flex-direction:column;gap:12px}.checkbox-item{display:flex;align-items:center;gap:10px}.checkbox-item input[type="checkbox"]{width:18px;height:18px;accent-color:var(--pink);cursor:pointer}.checkbox-label{font-size:0.9rem;color:rgba(255,255,255,0.85);cursor:pointer}.btn-primary{padding:10px 20px;border-radius:999px;border:none;background:linear-gradient(135deg,var(--pink),var(--purple));color:white;font-weight:700;font-size:0.9rem;letter-spacing:0.08em;text-transform:uppercase;cursor:pointer;box-shadow:0 8px 24px rgba(255,107,157,0.4);transition:transform 0.15s ease,box-shadow 0.15s ease}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(255,107,157,0.6)}.btn-primary:disabled{opacity:0.5;cursor:not-allowed;transform:none}
    .avatar-modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity 0.2s ease;padding:20px}.avatar-modal.open{opacity:1;pointer-events:auto}.avatar-modal-box{background:rgba(20,20,30,0.98);border:2px solid rgba(255,255,255,0.1);border-radius:20px;padding:28px;max-width:480px;width:100%;max-height:80vh;overflow-y:auto}.avatar-modal-title{font-size:1.6rem;letter-spacing:2px;margin-bottom:20px;text-align:center}.avatar-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px}.avatar-option{width:100%;aspect-ratio:1;border-radius:50%;background:rgba(255,255,255,0.05);border:3px solid transparent;display:flex;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;transition:all 0.2s ease}.avatar-option:hover{background:rgba(255,255,255,0.1);transform:scale(1.1)}.avatar-option.selected{border-color:var(--pink);box-shadow:0 0 20px rgba(255,107,157,0.4)}.avatar-modal-actions{display:flex;gap:12px;margin-top:24px;justify-content:center}.btn-ghost{padding:10px 20px;border-radius:999px;border:1px solid rgba(255,255,255,0.2);background:transparent;color:rgba(255,255,255,0.7);font-weight:600;font-size:0.9rem;cursor:pointer;transition:all 0.2s ease}.btn-ghost:hover{border-color:rgba(255,255,255,0.4);color:white}
    .premium-cta-card{background:linear-gradient(135deg,rgba(255,107,157,0.15),rgba(164,69,178,0.15));border:2px solid rgba(255,107,157,0.3);border-radius:20px;padding:32px;text-align:center;margin-bottom:24px;position:relative;overflow:hidden}.premium-cta-card::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,107,157,0.1) 0%,transparent 70%);animation:rotate 20s linear infinite}@keyframes rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.premium-cta-content{position:relative;z-index:1}.premium-cta-title{font-size:2.2rem;letter-spacing:2px;margin-bottom:8px}.premium-cta-subtitle{font-size:1rem;color:rgba(255,255,255,0.7);margin-bottom:20px}.premium-price{font-size:3rem;font-weight:900;margin-bottom:20px;background:linear-gradient(135deg,var(--pink),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.premium-features{text-align:left;max-width:400px;margin:0 auto 24px}.premium-feature-item{display:flex;align-items:center;gap:10px;margin-bottom:10px;font-size:0.95rem}.premium-active-banner{background:linear-gradient(135deg,rgba(251,191,36,0.15),rgba(245,158,11,0.15));border:2px solid rgba(251,191,36,0.4);border-radius:16px;padding:20px 24px;margin-bottom:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}.premium-active-info{display:flex;align-items:center;gap:12px}.premium-active-icon{font-size:2rem}.premium-active-text h3{font-size:1.2rem;letter-spacing:1px;color:var(--gold)}.premium-active-text p{font-size:0.85rem;color:rgba(255,255,255,0.6)}.manage-sub-btn{padding:8px 16px;border-radius:8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:white;font-size:0.85rem;cursor:pointer;transition:all 0.2s}.manage-sub-btn:hover{background:rgba(255,255,255,0.15)}
    .cosmetics-locked-overlay{position:relative}.cosmetics-locked-overlay::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(10,10,15,0.7);backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);border-radius:16px;z-index:10;pointer-events:none}.cosmetics-locked-overlay .lock-badge{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:11;background:linear-gradient(135deg,var(--pink),var(--purple));padding:12px 24px;border-radius:50px;font-weight:700;font-size:0.9rem;letter-spacing:1px;text-transform:uppercase;box-shadow:0 8px 30px rgba(255,107,157,0.5);cursor:pointer;transition:all 0.2s ease}.cosmetics-locked-overlay .lock-badge:hover{transform:translate(-50%,-50%) scale(1.05)}
    .preview-section{background:linear-gradient(135deg,rgba(15,15,25,0.9),rgba(20,20,35,0.9));border:2px solid rgba(255,255,255,0.1);border-radius:16px;padding:24px;margin-bottom:24px;text-align:center}.preview-title{font-size:0.8rem;text-transform:uppercase;letter-spacing:0.1em;color:rgba(255,255,255,0.5);margin-bottom:20px}.preview-nameplate{display:inline-flex;align-items:center;gap:12px;padding:14px 24px;border-radius:12px;background:rgba(255,255,255,0.03);border-width:3px;border-style:solid;border-color:rgba(255,255,255,0.2);transition:all 0.3s ease}.preview-badge{font-size:1.6rem;line-height:1}.preview-name-wrapper{display:flex;flex-direction:column;align-items:flex-start;gap:2px}.preview-name{font-size:1.2rem;font-weight:700;color:white;transition:all 0.3s ease}.preview-title-text{font-size:0.7rem;text-transform:uppercase;letter-spacing:0.08em;color:rgba(255,255,255,0.5)}.preview-nameplate[data-border="solid"]{border-style:solid}.preview-nameplate[data-border="glow"]{border-style:solid;box-shadow:0 0 15px var(--current-color),0 0 30px var(--current-color)}.preview-nameplate[data-border="pulse"]{border-style:solid;animation:borderPulse 1.5s ease-in-out infinite !important}.preview-nameplate[data-border="double"]{border-style:double;border-width:5px}.preview-nameplate[data-border="dotted"]{border-style:dotted;border-width:4px}@keyframes borderPulse{0%,100%{box-shadow:0 0 5px var(--current-color);filter:brightness(1)}50%{box-shadow:0 0 20px var(--current-color),0 0 40px var(--current-color);filter:brightness(1.2)}}.preview-nameplate[data-color="rainbow"]{border-color:transparent !important;background:linear-gradient(rgba(15,15,25,0.95),rgba(15,15,25,0.95)) padding-box,linear-gradient(90deg,#f87171,#fbbf24,#34d399,#67e8f9,#c084fc,#f87171) border-box;background-size:100% 100%,300% 100%;animation:rainbowBorder 3s linear infinite}@keyframes rainbowBorder{0%{background-position:0 0,0% 0}100%{background-position:0 0,300% 0}}.preview-name[data-effect="none"]{text-shadow:none !important}.preview-name[data-effect="glow"]{text-shadow:0 0 10px currentColor,0 0 20px currentColor,0 0 30px currentColor !important}.preview-name[data-effect="shadow"]{text-shadow:4px 4px 0px rgba(0,0,0,0.9),6px 6px 10px rgba(0,0,0,0.5) !important}.preview-name[data-effect="shimmer"]{background:linear-gradient(90deg,currentColor 0%,white 50%,currentColor 100%) !important;background-size:200% 100% !important;-webkit-background-clip:text !important;-webkit-text-fill-color:transparent !important;animation:shimmerText 2s linear infinite !important}.preview-name[data-effect="neon"]{text-shadow:0 0 5px currentColor,0 0 10px currentColor,0 0 20px currentColor,0 0 40px currentColor,0 0 80px currentColor !important}@keyframes shimmerText{0%{background-position:200% 0}100%{background-position:-200% 0}}@keyframes entranceFade{from{opacity:0}to{opacity:1}}@keyframes entranceSlide{from{opacity:0;transform:translateX(-30px)}to{opacity:1;transform:translateX(0)}}@keyframes entrancePop{from{opacity:0;transform:scale(0.3)}to{opacity:1;transform:scale(1)}}@keyframes entranceLightning{0%{opacity:0;filter:brightness(5)}30%{opacity:1;filter:brightness(5)}100%{opacity:1;filter:brightness(1)}}@keyframes entranceFire{0%{opacity:0;transform:translateY(20px) scale(0.8);filter:blur(10px)}100%{opacity:1;transform:translateY(0) scale(1);filter:blur(0)}}@keyframes entranceSparkle{0%{opacity:0;transform:scale(0) rotate(-180deg)}100%{opacity:1;transform:scale(1) rotate(0deg)}}@keyframes entranceSmoke{0%{opacity:0;filter:blur(20px);transform:scale(1.5)}100%{opacity:1;filter:blur(0);transform:scale(1)}}@keyframes entranceGlitch{0%{opacity:0;transform:translateX(-10px) skewX(-10deg);filter:hue-rotate(90deg)}20%{opacity:1;transform:translateX(10px) skewX(10deg);filter:hue-rotate(180deg)}40%{transform:translateX(-5px) skewX(-5deg);filter:hue-rotate(270deg)}60%{transform:translateX(5px) skewX(5deg);filter:hue-rotate(360deg)}100%{transform:translateX(0) skewX(0deg);filter:hue-rotate(0deg)}}
    .option-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(85px,1fr));gap:10px;margin-top:10px}.option-item{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:14px 8px;border-radius:12px;background:rgba(255,255,255,0.03);border:2px solid rgba(255,255,255,0.1);cursor:pointer;transition:all 0.2s ease;min-height:75px}.option-item:hover{border-color:rgba(255,255,255,0.3);background:rgba(255,255,255,0.06);transform:translateY(-2px)}.option-item.selected{border-color:var(--pink);background:rgba(255,107,157,0.15);box-shadow:0 0 20px rgba(255,107,157,0.3)}.option-icon{font-size:1.6rem;margin-bottom:6px}.option-label{font-size:0.7rem;text-transform:uppercase;letter-spacing:0.05em;color:rgba(255,255,255,0.7);text-align:center}.color-grid{display:flex;flex-wrap:wrap;gap:12px;margin-top:10px}.color-option{width:44px;height:44px;border-radius:50%;border:3px solid transparent;cursor:pointer;transition:all 0.2s ease;position:relative}.color-option:hover{transform:scale(1.15)}.color-option.selected{border-color:white;box-shadow:0 0 15px currentColor;transform:scale(1.1)}.color-option.selected::after{content:'‚úì';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;font-weight:bold;color:white;text-shadow:0 1px 3px rgba(0,0,0,0.5)}.title-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px;margin-top:10px}.title-option{padding:12px 16px;border-radius:10px;background:rgba(255,255,255,0.03);border:2px solid rgba(255,255,255,0.1);cursor:pointer;transition:all 0.2s ease;text-align:center;font-size:0.9rem;color:rgba(255,255,255,0.8)}.title-option:hover{border-color:rgba(255,255,255,0.3);transform:translateY(-2px)}.title-option.selected{border-color:var(--pink);background:rgba(255,107,157,0.15)}.custom-title-wrapper{margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.1)}.custom-title-label{font-size:0.85rem;color:rgba(255,255,255,0.6);margin-bottom:8px;display:block}.custom-title-input{width:100%;max-width:300px;padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.16);background:rgba(5,5,15,0.9);color:white;font-size:0.95rem;outline:none}.custom-title-input:focus{border-color:var(--pink)}.custom-title-input::placeholder{color:rgba(255,255,255,0.3)}.char-count{font-size:0.75rem;color:rgba(255,255,255,0.4);margin-top:6px}.loading-spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
    .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity 0.2s ease;padding:20px}.modal-overlay.open{opacity:1;pointer-events:auto}.modal-box{background:rgba(20,20,30,0.98);border:2px solid rgba(255,255,255,0.1);border-radius:20px;padding:32px;max-width:420px;width:100%;text-align:center;transform:scale(0.9);transition:transform 0.2s ease}.modal-overlay.open .modal-box{transform:scale(1)}.modal-title{font-size:1.6rem;letter-spacing:2px;margin-bottom:16px}.modal-text{font-size:0.95rem;color:rgba(255,255,255,0.7);line-height:1.6;margin-bottom:24px}.modal-buttons{display:flex;flex-direction:column;gap:12px}.modal-btn{padding:12px 20px;border-radius:10px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;border:none}.modal-btn-primary{background:linear-gradient(135deg,var(--pink),var(--purple));color:white}.modal-btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(255,107,157,0.4)}.modal-btn-danger{background:rgba(239,68,68,0.2);border:1px solid rgba(239,68,68,0.4);color:#f87171}.modal-btn-danger:hover{background:rgba(239,68,68,0.3)}.modal-btn-ghost{background:transparent;color:rgba(255,255,255,0.6)}.modal-btn-ghost:hover{color:white}
    footer{background:#000;position:relative;overflow:hidden}.footer-border{height:3px;background:linear-gradient(90deg,var(--pink),var(--blue),var(--purple),var(--pink));background-size:300% 100%;animation:gradientSlide 6s linear infinite}@keyframes gradientSlide{0%{background-position:0% 50%}100%{background-position:300% 50%}}.footer-main{max-width:1100px;margin:0 auto;padding:50px 20px 30px;padding-left:max(20px,env(safe-area-inset-left));padding-right:max(20px,env(safe-area-inset-right));padding-bottom:max(30px,env(safe-area-inset-bottom))}.footer-links{display:grid;grid-template-columns:repeat(3,1fr);gap:40px;margin-bottom:40px;max-width:600px;margin-left:auto;margin-right:auto}.footer-column{text-align:center}.footer-column h5{font-family:'Bebas Neue',sans-serif;font-size:1rem;letter-spacing:2px;margin-bottom:15px;color:rgba(255,255,255,0.9)}.footer-column ul{list-style:none}.footer-column li{margin-bottom:10px}.footer-column a{color:rgba(255,255,255,0.5);font-size:0.9rem;transition:color 0.2s ease}.footer-column a:hover{color:white}.footer-bottom{text-align:center;padding-top:25px;border-top:1px solid rgba(255,255,255,0.08)}.footer-copyright{font-size:0.85rem;color:rgba(255,255,255,0.4)}
    @media (max-width:900px){.stats-grid{grid-template-columns:repeat(2,1fr)}.premium-active-banner{flex-direction:column;text-align:center}.nav-links{display:none}}@media (max-width:700px){header{height:56px;padding:0 14px}.header-logo{font-size:1.4rem;letter-spacing:3px}.profile-page{padding:80px 16px 40px}.profile-hero{flex-direction:column;align-items:center;text-align:center;padding:24px 18px}.profile-name-row{justify-content:center}.profile-meta{justify-content:center}.avatar-display{width:90px;height:90px;font-size:2.2rem}.profile-display-name{font-size:1.8rem}.stats-grid{grid-template-columns:repeat(2,1fr);gap:12px}.stat-card{padding:14px}.stat-value{font-size:1.4rem}.favorite-games{grid-template-columns:1fr}.form-row{grid-template-columns:1fr}.option-grid{grid-template-columns:repeat(4,1fr)}.title-grid{grid-template-columns:repeat(2,1fr)}.footer-links{grid-template-columns:1fr;gap:30px}.leaderboard-ranks{grid-template-columns:1fr 1fr}}@media (max-width:600px){.profile-display-name{font-size:1.6rem}.section-title{font-size:1.2rem}.form-section{padding:18px}.preview-section{padding:18px}.preview-nameplate{padding:12px 18px;gap:10px}.preview-name{font-size:1rem}.option-grid{grid-template-columns:repeat(3,1fr);gap:8px}.option-item{padding:10px 6px;min-height:65px}.option-icon{font-size:1.3rem}.option-label{font-size:0.65rem}.color-option{width:38px;height:38px}.title-grid{grid-template-columns:1fr}.avatar-grid{grid-template-columns:repeat(4,1fr)}.xp-level-number{font-size:1.8rem}.leaderboard-ranks{grid-template-columns:1fr}}@media (max-width:375px){.header-logo{font-size:1.2rem;letter-spacing:2px}.profile-page{padding:75px 12px 30px}.profile-display-name{font-size:1.4rem}.tab-button{padding:8px 14px;font-size:0.8rem}.form-section{padding:14px}.btn-primary{padding:10px 16px;font-size:0.85rem}.stats-grid{gap:10px}.stat-card{padding:12px}.stat-value{font-size:1.2rem}.stat-icon{font-size:1.2rem}}@supports (-webkit-touch-callout:none){.profile-page{min-height:-webkit-fill-available}}@media (max-height:500px) and (orientation:landscape){.profile-page{padding-top:70px}}
  </style>
</head>
<body>
  <header><nav class="nav-inner"><div class="nav-left"><a href="/" class="header-logo">THEGAMING.CO</a><div class="nav-links"><a href="/leaderboards" class="nav-link">Leaderboards</a><a href="/supporters" class="nav-link">Supporters</a></div></div><div class="header-actions"><div class="user-pill-skeleton" id="auth-skeleton"></div><div class="nav-right-logged-out"><a href="/login" class="auth-link">Sign In</a></div><div class="nav-right-logged-in"><div class="user-menu-wrapper"><button class="user-pill" type="button" id="user-menu-button"><span class="user-pill-label" id="header-username-label">P</span></button><div class="user-menu" id="user-menu"><a href="/profile" class="user-menu-item">Profile</a><button type="button" class="user-menu-item" id="user-menu-signout">Sign Out</button></div></div></div></div></nav></header>

  <main><section class="profile-page"><div class="profile-container">
    <div class="status-bar" id="status-bar"><div class="status-message" id="status-message"></div></div>
    <div class="profile-hero"><div class="avatar-wrapper"><div class="avatar-display" id="avatar-display" onclick="openAvatarModal()">üòé</div><div class="avatar-edit-hint">‚úèÔ∏è</div></div><div class="profile-info"><div class="profile-name-row"><h1 class="profile-display-name" id="profile-display-name">Loading...</h1><div class="profile-badges"><span class="profile-badge badge-level" id="level-badge">LVL 1</span><span class="profile-badge badge-premium" id="premium-badge" style="display:none;">PREMIUM</span></div></div><p class="profile-title-text" id="profile-title-display"></p><div class="profile-meta"><div class="profile-meta-item"><span>üìÖ</span><span id="member-since-text">Member since Jan 2025</span></div><div class="profile-meta-item"><span>üéÆ</span><span id="total-games-text">0 games played</span></div></div></div></div>
    <div class="xp-section"><div class="xp-header"><div class="xp-level"><span class="xp-level-number" id="xp-level-number">1</span><div><div class="xp-level-label">LEVEL</div></div></div><div class="xp-numbers"><div class="xp-current"><span id="xp-current">0</span> XP</div><div class="xp-needed"><span id="xp-needed">100</span> XP to next level</div></div></div><div class="xp-bar-container"><div class="xp-bar-fill" id="xp-bar-fill" style="width:0%;"></div></div><div class="xp-rewards"><div class="xp-reward-item"><span>üéÆ</span> Complete game: +10 XP</div><div class="xp-reward-item"><span>üèÜ</span> Beat personal best: +25 XP</div><div class="xp-reward-item"><span>ü•á</span> Top 10 leaderboard: +50 XP</div></div></div>
    <div class="stats-grid"><div class="stat-card"><div class="stat-icon">üéÆ</div><div class="stat-value" id="stat-games-played">0</div><div class="stat-label">Games Played</div></div><div class="stat-card"><div class="stat-icon">‚è±Ô∏è</div><div class="stat-value" id="stat-playtime">0h</div><div class="stat-label">Playtime</div></div><div class="stat-card"><div class="stat-icon">üèÜ</div><div class="stat-value" id="stat-personal-bests">0</div><div class="stat-label">Personal Bests</div></div><div class="stat-card"><div class="stat-icon">üî•</div><div class="stat-value" id="stat-best-rank">#--</div><div class="stat-label">Best Rank</div></div></div>
    <div class="favorite-games"><div class="favorite-card"><div class="favorite-label">‚ù§Ô∏è Most Played</div><div class="favorite-game" id="favorite-game"><div class="favorite-game-icon">üéØ</div><div class="favorite-game-info"><h4>--</h4><p>No games yet</p></div></div></div><div class="favorite-card"><div class="favorite-label">üÜï Try Something New</div><div class="favorite-game" id="least-played-game"><div class="favorite-game-icon">‚ùì</div><div class="favorite-game-info"><h4>--</h4><p>Play more to unlock</p></div></div></div></div>
    <div class="leaderboard-section"><div class="leaderboard-header"><h2 class="leaderboard-title">YOUR RANKINGS</h2><a href="/leaderboards" class="leaderboard-link">View All ‚Üí</a></div><div class="leaderboard-ranks" id="leaderboard-ranks"><div class="rank-card"><span class="rank-game-icon">üéØ</span><div class="rank-info"><div class="rank-game-name">Aim Trainer</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">‚å®Ô∏è</span><div class="rank-info"><div class="rank-game-name">Typing Test</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">‚ö°</span><div class="rank-info"><div class="rank-game-name">Reaction Time</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">üêµ</span><div class="rank-info"><div class="rank-game-name">Chimp Test</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">üî¢</span><div class="rank-info"><div class="rank-game-name">Number Memory</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div></div></div>
    <div class="profile-tabs"><button class="tab-button active" data-tab="settings">Settings</button><button class="tab-button" data-tab="premium">Premium & Cosmetics</button></div>
    <div class="tab-content active" id="settings-tab"><form class="form-section" id="profile-form"><h2 class="section-title">Profile Information</h2><div class="form-group" style="margin-bottom:16px;"><label class="form-label">Display Name</label><input type="text" class="form-input" id="display-name" placeholder="Your display name" maxlength="20"><span class="form-hint">This is how you'll appear in games (max 20 characters)</span></div><button type="submit" class="btn-primary">Save Changes</button></form><div class="form-section"><h2 class="section-title">Account Info</h2><div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="email" disabled></div><div class="form-group"><label class="form-label">Account Type</label><input type="text" class="form-input" id="account-type" value="Free" disabled></div></div><div class="form-group"><label class="form-label">Member Since</label><input type="text" class="form-input" id="member-since" disabled></div></div><div class="form-section"><h2 class="section-title">Email Preferences</h2><div class="checkbox-group"><div class="checkbox-item"><input type="checkbox" id="email-newsletter"><label class="checkbox-label" for="email-newsletter">Newsletter & Updates</label></div><div class="checkbox-item"><input type="checkbox" id="email-new-games"><label class="checkbox-label" for="email-new-games">New Game Releases</label></div><div class="checkbox-item"><input type="checkbox" id="email-sponsored"><label class="checkbox-label" for="email-sponsored">Sponsored Content & Partners</label></div></div><button type="button" class="btn-primary" id="save-email-prefs" style="margin-top:16px;">Save Preferences</button></div></div>
    <div class="tab-content" id="premium-tab"><div class="premium-active-banner" id="premium-active-banner" style="display:none;"><div class="premium-active-info"><span class="premium-active-icon">üëë</span><div class="premium-active-text"><h3>PREMIUM ACTIVE</h3><p>Thanks for supporting TheGaming.co!</p></div></div><button class="manage-sub-btn" id="manage-sub-btn">Manage Subscription</button></div><div class="premium-cta-card" id="premium-cta"><div class="premium-cta-content"><h2 class="premium-cta-title">UPGRADE TO PREMIUM</h2><p class="premium-cta-subtitle">Stand out in every lobby with custom cosmetics</p><div class="premium-price">$1.50 <span style="font-size:1.5rem;">/month</span></div><div class="premium-features"><div class="premium-feature-item"><span>üö´</span><span>Ad-free experience</span></div><div class="premium-feature-item"><span>üëë</span><span>Badge icons (16+ options)</span></div><div class="premium-feature-item"><span>üé®</span><span>Border colors & styles</span></div><div class="premium-feature-item"><span>‚ú®</span><span>Name effects (glow, neon, shimmer)</span></div><div class="premium-feature-item"><span>üöÄ</span><span>Entrance animations</span></div><div class="premium-feature-item"><span>üè∑Ô∏è</span><span>Custom titles</span></div></div><button type="button" class="btn-primary" id="upgrade-btn" style="font-size:1rem;padding:14px 32px;"><span id="upgrade-btn-text">Upgrade Now</span><span id="upgrade-btn-loading" style="display:none;"><span class="loading-spinner"></span> Processing...</span></button></div></div>
    <div id="cosmetics-section"><div class="preview-section" id="preview-section-wrapper"><div class="preview-title">Live Preview ‚Äî How You'll Appear in Games</div><div class="preview-nameplate" id="preview-nameplate" data-border="solid"><span class="preview-badge" id="preview-badge">üëë</span><div class="preview-name-wrapper"><span class="preview-name" id="preview-name" data-effect="none">YourName</span><span class="preview-title-text" id="preview-title-text"></span></div></div><button class="btn-primary" style="margin-top:20px;" onclick="playEntranceAnimation()">‚ñ∂ Preview Entrance</button></div>
    <div class="form-section" id="badge-section"><h2 class="section-title">Badge Icon</h2><p class="info-text">Shows before your name</p><div class="option-grid" id="badge-options"><div class="option-item" data-value=""><span class="option-icon">‚úï</span><span class="option-label">None</span></div><div class="option-item" data-value="üëë"><span class="option-icon">üëë</span><span class="option-label">Crown</span></div><div class="option-item" data-value="‚≠ê"><span class="option-icon">‚≠ê</span><span class="option-label">Star</span></div><div class="option-item" data-value="üíé"><span class="option-icon">üíé</span><span class="option-label">Diamond</span></div><div class="option-item" data-value="üî•"><span class="option-icon">üî•</span><span class="option-label">Fire</span></div><div class="option-item" data-value="‚ö°"><span class="option-icon">‚ö°</span><span class="option-label">Lightning</span></div><div class="option-item" data-value="‚ùÑÔ∏è"><span class="option-icon">‚ùÑÔ∏è</span><span class="option-label">Ice</span></div><div class="option-item" data-value="üåü"><span class="option-icon">üåü</span><span class="option-label">Sparkle</span></div><div class="option-item" data-value="üíÄ"><span class="option-icon">üíÄ</span><span class="option-label">Skull</span></div><div class="option-item" data-value="üëª"><span class="option-icon">üëª</span><span class="option-label">Ghost</span></div><div class="option-item" data-value="üéÆ"><span class="option-icon">üéÆ</span><span class="option-label">Gamer</span></div><div class="option-item" data-value="üèÜ"><span class="option-icon">üèÜ</span><span class="option-label">Trophy</span></div><div class="option-item" data-value="üéØ"><span class="option-icon">üéØ</span><span class="option-label">Target</span></div><div class="option-item" data-value="ü¶Ñ"><span class="option-icon">ü¶Ñ</span><span class="option-label">Unicorn</span></div><div class="option-item" data-value="üê∫"><span class="option-icon">üê∫</span><span class="option-label">Wolf</span></div><div class="option-item" data-value="üóø"><span class="option-icon">üóø</span><span class="option-label">Moai</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <div class="form-section" id="color-section"><h2 class="section-title">Border Color</h2><p class="info-text">Your nameplate border color</p><div class="color-grid" id="color-options"><div class="color-option" data-value="gray" style="background:#6b7280;" title="Gray"></div><div class="color-option" data-value="gold" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);" title="Gold"></div><div class="color-option" data-value="diamond" style="background:linear-gradient(135deg,#67e8f9,#06b6d4);" title="Diamond"></div><div class="color-option" data-value="ruby" style="background:linear-gradient(135deg,#f87171,#dc2626);" title="Ruby"></div><div class="color-option" data-value="emerald" style="background:linear-gradient(135deg,#34d399,#10b981);" title="Emerald"></div><div class="color-option" data-value="amethyst" style="background:linear-gradient(135deg,#c084fc,#a855f7);" title="Amethyst"></div><div class="color-option" data-value="platinum" style="background:linear-gradient(135deg,#e2e8f0,#94a3b8);" title="Platinum"></div><div class="color-option" data-value="obsidian" style="background:linear-gradient(135deg,#312e81,#1e1b4b);" title="Obsidian"></div><div class="color-option" data-value="rose" style="background:linear-gradient(135deg,#fb7185,#f43f5e);" title="Rose"></div><div class="color-option" data-value="rainbow" style="background:linear-gradient(90deg,#f87171,#fbbf24,#34d399,#67e8f9,#c084fc);" title="Rainbow"></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <div class="form-section" id="border-section"><h2 class="section-title">Border Style</h2><p class="info-text">How your border appears</p><div class="option-grid" id="border-options"><div class="option-item" data-value="solid"><span class="option-icon">‚ñ¨</span><span class="option-label">Solid</span></div><div class="option-item" data-value="glow"><span class="option-icon">‚ú®</span><span class="option-label">Glow</span></div><div class="option-item" data-value="pulse"><span class="option-icon">üí´</span><span class="option-label">Pulse</span></div><div class="option-item" data-value="double"><span class="option-icon">‚ñ≠</span><span class="option-label">Double</span></div><div class="option-item" data-value="dotted"><span class="option-icon">‚îÖ</span><span class="option-label">Dotted</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <div class="form-section" id="effect-section"><h2 class="section-title">Name Effect</h2><p class="info-text">Special effect on your name</p><div class="option-grid" id="effect-options"><div class="option-item" data-value="none"><span class="option-icon">Aa</span><span class="option-label">None</span></div><div class="option-item" data-value="glow"><span class="option-icon">üåü</span><span class="option-label">Glow</span></div><div class="option-item" data-value="shadow"><span class="option-icon">üåë</span><span class="option-label">Shadow</span></div><div class="option-item" data-value="shimmer"><span class="option-icon">‚ú®</span><span class="option-label">Shimmer</span></div><div class="option-item" data-value="neon"><span class="option-icon">üí°</span><span class="option-label">Neon</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <div class="form-section" id="entrance-section"><h2 class="section-title">Entrance Animation</h2><p class="info-text">How you appear when joining a lobby</p><div class="option-grid" id="entrance-options"><div class="option-item" data-value="fade"><span class="option-icon">üëÅÔ∏è</span><span class="option-label">Fade</span></div><div class="option-item" data-value="slide"><span class="option-icon">‚û°Ô∏è</span><span class="option-label">Slide</span></div><div class="option-item" data-value="pop"><span class="option-icon">üí•</span><span class="option-label">Pop</span></div><div class="option-item" data-value="lightning"><span class="option-icon">‚ö°</span><span class="option-label">Lightning</span></div><div class="option-item" data-value="fire"><span class="option-icon">üî•</span><span class="option-label">Fire</span></div><div class="option-item" data-value="sparkle"><span class="option-icon">‚ú®</span><span class="option-label">Sparkle</span></div><div class="option-item" data-value="smoke"><span class="option-icon">üí®</span><span class="option-label">Smoke</span></div><div class="option-item" data-value="glitch"><span class="option-icon">üì∫</span><span class="option-label">Glitch</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <div class="form-section" id="title-section"><h2 class="section-title">Title</h2><p class="info-text">Shows below your name</p><div class="title-grid" id="title-options"><div class="title-option" data-value="">None</div><div class="title-option" data-value="Not a Brokie">Not a Brokie</div><div class="title-option" data-value="Main Character">Main Character</div><div class="title-option" data-value="NPC Energy">NPC Energy</div><div class="title-option" data-value="Delulu">Delulu</div><div class="title-option" data-value="Built Different">Built Different</div><div class="title-option" data-value="No Cap">No Cap</div><div class="title-option" data-value="Touch Grass">Touch Grass</div><div class="title-option" data-value="Down Bad">Down Bad</div><div class="title-option" data-value="Certified Menace">Certified Menace</div><div class="title-option" data-value="Lowkey Goated">Lowkey Goated</div><div class="title-option" data-value="Unhinged">Unhinged</div><div class="title-option" data-value="Chaotic Neutral">Chaotic Neutral</div></div><div class="custom-title-wrapper"><label class="custom-title-label">Or write your own:</label><input type="text" class="custom-title-input" id="custom-title-input" placeholder="Your custom title..." maxlength="25"><div class="char-count"><span id="custom-title-count">0</span>/25 characters</div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
    <button class="btn-primary" id="save-cosmetics" style="width:100%;padding:16px;font-size:1rem;">Save Cosmetics</button></div></div>
  </div></section></main>

  <div class="avatar-modal" id="avatar-modal"><div class="avatar-modal-box"><h2 class="avatar-modal-title">CHOOSE AVATAR</h2><div class="avatar-grid" id="avatar-grid"><div class="avatar-option" data-value="üòé">üòé</div><div class="avatar-option" data-value="üéÆ">üéÆ</div><div class="avatar-option" data-value="üéØ">üéØ</div><div class="avatar-option" data-value="üèÜ">üèÜ</div><div class="avatar-option" data-value="‚ö°">‚ö°</div><div class="avatar-option" data-value="üî•">üî•</div><div class="avatar-option" data-value="‚ùÑÔ∏è">‚ùÑÔ∏è</div><div class="avatar-option" data-value="üåü">üåü</div><div class="avatar-option" data-value="üíé">üíé</div><div class="avatar-option" data-value="üëë">üëë</div><div class="avatar-option" data-value="üê∫">üê∫</div><div class="avatar-option" data-value="ü¶ä">ü¶ä</div><div class="avatar-option" data-value="ü¶Å">ü¶Å</div><div class="avatar-option" data-value="üêª">üêª</div><div class="avatar-option" data-value="ü¶Ñ">ü¶Ñ</div><div class="avatar-option" data-value="üêâ">üêâ</div><div class="avatar-option" data-value="üëª">üëª</div><div class="avatar-option" data-value="üíÄ">üíÄ</div><div class="avatar-option" data-value="ü§ñ">ü§ñ</div><div class="avatar-option" data-value="üëΩ">üëΩ</div><div class="avatar-option" data-value="ü•∑">ü•∑</div><div class="avatar-option" data-value="üßô">üßô</div><div class="avatar-option" data-value="üßõ">üßõ</div><div class="avatar-option" data-value="üßü">üßü</div><div class="avatar-option" data-value="üóø">üóø</div></div><div class="avatar-modal-actions"><button class="btn-ghost" onclick="closeAvatarModal()">Cancel</button><button class="btn-primary" onclick="saveAvatar()">Save Avatar</button></div></div></div>
  <div class="modal-overlay" id="sub-modal"><div class="modal-box"><h2 class="modal-title">MANAGE SUBSCRIPTION</h2><div class="modal-text">You're currently on <strong>Premium</strong>. Your subscription renews monthly at $1.50 CAD.</div><div class="modal-buttons"><button class="modal-btn modal-btn-primary" onclick="closeModal()">Keep Premium üëë</button><button class="modal-btn modal-btn-danger" onclick="confirmCancel()">Cancel Subscription</button><button class="modal-btn modal-btn-ghost" onclick="closeModal()">Close</button></div></div></div>
  <div class="modal-overlay" id="cancel-modal"><div class="modal-box"><h2 class="modal-title">üò¢ ARE YOU SURE?</h2><div class="modal-text">You'll lose access to all cosmetics and go back to seeing ads.<br><br>To cancel, reply to your Stripe payment receipt email with "cancel" or message us on <a href="https://ko-fi.com/thegamingco" target="_blank" style="color:var(--pink);">Ko-fi</a>.</div><div class="modal-buttons"><button class="modal-btn modal-btn-primary" onclick="closeCancelModal()">Nevermind, Keep Premium</button><button class="modal-btn modal-btn-ghost" onclick="closeCancelModal()">Close</button></div></div></div>

  <footer><div class="footer-border"></div><div class="footer-main"><div class="footer-links"><div class="footer-column"><h5>GAMES</h5><ul><li><a href="/solo">Solo</a></li><li><a href="/duos">Duos</a></li><li><a href="/squad-games">Squad</a></li><li><a href="/party-games">Party</a></li></ul></div><div class="footer-column"><h5>COMMUNITY</h5><ul><li><a href="/leaderboards">Leaderboards</a></li><li><a href="/supporters">Hall of Champions</a></li></ul></div><div class="footer-column"><h5>COMPANY</h5><ul><li><a href="/about">About</a></li><li><a href="mailto:hello@thegaming.co">Contact</a></li></ul></div></div><div class="footer-bottom"><p class="footer-copyright">¬© 2025 TheGaming.co ‚Äî Free party games, forever.</p></div></div></footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
  <main><section class="profile-page"><div class="profile-container">
    <div class="status-bar" id="status-bar"><div class="status-message" id="status-message"></div></div>
    <div class="profile-hero"><div class="avatar-wrapper"><div class="avatar-display" id="avatar-display" onclick="openAvatarModal()">üòé</div><div class="avatar-edit-hint">‚úèÔ∏è</div></div><div class="profile-info"><div class="profile-name-row"><h1 class="profile-display-name" id="profile-display-name">Loading...</h1><div class="profile-badges"><span class="profile-badge badge-level" id="level-badge">LVL 1</span><span class="profile-badge badge-premium" id="premium-badge" style="display:none;">PREMIUM</span></div></div><p class="profile-title-text" id="profile-title-display"></p><div class="profile-meta"><div class="profile-meta-item"><span>üìÖ</span><span id="member-since-text">Member since Jan 2025</span></div><div class="profile-meta-item"><span>üéÆ</span><span id="total-games-text">0 games played</span></div></div></div></div>
    <div class="xp-section"><div class="xp-header"><div class="xp-level"><span class="xp-level-number" id="xp-level-number">1</span><div><div class="xp-level-label">LEVEL</div></div></div><div class="xp-numbers"><div class="xp-current"><span id="xp-current">0</span> XP</div><div class="xp-needed"><span id="xp-needed">100</span> XP to next level</div></div></div><div class="xp-bar-container"><div class="xp-bar-fill" id="xp-bar-fill" style="width:0%;"></div></div><div class="xp-rewards"><div class="xp-reward-item"><span>üéÆ</span> Complete game: +10 XP</div><div class="xp-reward-item"><span>üèÜ</span> Beat personal best: +25 XP</div><div class="xp-reward-item"><span>ü•á</span> Top 10 leaderboard: +50 XP</div></div></div>
    <div class="stats-grid"><div class="stat-card"><div class="stat-icon">üéÆ</div><div class="stat-value" id="stat-games-played">0</div><div class="stat-label">Games Played</div></div><div class="stat-card"><div class="stat-icon">‚è±Ô∏è</div><div class="stat-value" id="stat-playtime">0h</div><div class="stat-label">Playtime</div></div><div class="stat-card"><div class="stat-icon">üèÜ</div><div class="stat-value" id="stat-personal-bests">0</div><div class="stat-label">Personal Bests</div></div><div class="stat-card"><div class="stat-icon">üî•</div><div class="stat-value" id="stat-best-rank">#--</div><div class="stat-label">Best Rank</div></div></div>
    <div class="favorite-games"><div class="favorite-card"><div class="favorite-label">‚ù§Ô∏è Most Played</div><div class="favorite-game" id="favorite-game"><div class="favorite-game-icon">üéØ</div><div class="favorite-game-info"><h4>--</h4><p>No games yet</p></div></div></div><div class="favorite-card"><div class="favorite-label">üÜï Try Something New</div><div class="favorite-game" id="least-played-game"><div class="favorite-game-icon">‚ùì</div><div class="favorite-game-info"><h4>--</h4><p>Play more to unlock</p></div></div></div></div>
    <div class="leaderboard-section"><div class="leaderboard-header"><h2 class="leaderboard-title">YOUR RANKINGS</h2><a href="/leaderboards" class="leaderboard-link">View All ‚Üí</a></div><div class="leaderboard-ranks" id="leaderboard-ranks"><div class="rank-card"><span class="rank-game-icon">üéØ</span><div class="rank-info"><div class="rank-game-name">Aim Trainer</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">‚å®Ô∏è</span><div class="rank-info"><div class="rank-game-name">Typing Test</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">‚ö°</span><div class="rank-info"><div class="rank-game-name">Reaction Time</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">üêµ</span><div class="rank-info"><div class="rank-game-name">Chimp Test</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div><div class="rank-card"><span class="rank-game-icon">üî¢</span><div class="rank-info"><div class="rank-game-name">Number Memory</div><div class="rank-score">--</div></div><span class="rank-position unranked">--</span></div></div></div>
    <div class="profile-tabs"><button class="tab-button active" data-tab="settings">Settings</button><button class="tab-button" data-tab="premium">Premium & Cosmetics</button></div>
    <div class="tab-content active" id="settings-tab"><form class="form-section" id="profile-form"><h2 class="section-title">Profile Information</h2><div class="form-group" style="margin-bottom:16px;"><label class="form-label">Display Name</label><input type="text" class="form-input" id="display-name" placeholder="Your display name" maxlength="20"><span class="form-hint">This is how you'll appear in games (max 20 characters)</span></div><button type="submit" class="btn-primary">Save Changes</button></form><div class="form-section"><h2 class="section-title">Account Info</h2><div class="form-row"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="email" disabled></div><div class="form-group"><label class="form-label">Account Type</label><input type="text" class="form-input" id="account-type" value="Free" disabled></div></div><div class="form-group"><label class="form-label">Member Since</label><input type="text" class="form-input" id="member-since" disabled></div></div><div class="form-section"><h2 class="section-title">Email Preferences</h2><div class="checkbox-group"><div class="checkbox-item"><input type="checkbox" id="email-newsletter"><label class="checkbox-label" for="email-newsletter">Newsletter & Updates</label></div><div class="checkbox-item"><input type="checkbox" id="email-new-games"><label class="checkbox-label" for="email-new-games">New Game Releases</label></div><div class="checkbox-item"><input type="checkbox" id="email-sponsored"><label class="checkbox-label" for="email-sponsored">Sponsored Content & Partners</label></div></div><button type="button" class="btn-primary" id="save-email-prefs" style="margin-top:16px;">Save Preferences</button></div></div>
    <div class="tab-content" id="premium-tab">
      <div class="premium-active-banner" id="premium-active-banner" style="display:none;"><div class="premium-active-info"><span class="premium-active-icon">üëë</span><div class="premium-active-text"><h3>PREMIUM ACTIVE</h3><p>Thanks for supporting TheGaming.co!</p></div></div><button class="manage-sub-btn" id="manage-sub-btn">Manage Subscription</button></div>
      <div class="premium-cta-card" id="premium-cta"><div class="premium-cta-content"><h2 class="premium-cta-title">UPGRADE TO PREMIUM</h2><p class="premium-cta-subtitle">Stand out in every lobby with custom cosmetics</p><div class="premium-price">$1.50 <span style="font-size:1.5rem;">/month</span></div><div class="premium-features"><div class="premium-feature-item"><span>üö´</span><span>Ad-free experience</span></div><div class="premium-feature-item"><span>üëë</span><span>Badge icons (16+ options)</span></div><div class="premium-feature-item"><span>üé®</span><span>Border colors & styles</span></div><div class="premium-feature-item"><span>‚ú®</span><span>Name effects (glow, neon, shimmer)</span></div><div class="premium-feature-item"><span>üöÄ</span><span>Entrance animations</span></div><div class="premium-feature-item"><span>üè∑Ô∏è</span><span>Custom titles</span></div></div><button type="button" class="btn-primary" id="upgrade-btn" style="font-size:1rem;padding:14px 32px;"><span id="upgrade-btn-text">Upgrade Now</span><span id="upgrade-btn-loading" style="display:none;"><span class="loading-spinner"></span> Processing...</span></button></div></div>
      <div id="cosmetics-section">
        <div class="preview-section"><div class="preview-title">Live Preview ‚Äî How You'll Appear in Games</div><div class="preview-nameplate" id="preview-nameplate" data-border="solid"><span class="preview-badge" id="preview-badge">üëë</span><div class="preview-name-wrapper"><span class="preview-name" id="preview-name" data-effect="none">YourName</span><span class="preview-title-text" id="preview-title-text"></span></div></div><button class="btn-primary" style="margin-top:20px;" onclick="playEntranceAnimation()">‚ñ∂ Preview Entrance</button></div>
        <div class="form-section" id="badge-section"><h2 class="section-title">Badge Icon</h2><p class="info-text">Shows before your name</p><div class="option-grid" id="badge-options"><div class="option-item" data-value=""><span class="option-icon">‚úï</span><span class="option-label">None</span></div><div class="option-item" data-value="üëë"><span class="option-icon">üëë</span><span class="option-label">Crown</span></div><div class="option-item" data-value="‚≠ê"><span class="option-icon">‚≠ê</span><span class="option-label">Star</span></div><div class="option-item" data-value="üíé"><span class="option-icon">üíé</span><span class="option-label">Diamond</span></div><div class="option-item" data-value="üî•"><span class="option-icon">üî•</span><span class="option-label">Fire</span></div><div class="option-item" data-value="‚ö°"><span class="option-icon">‚ö°</span><span class="option-label">Lightning</span></div><div class="option-item" data-value="‚ùÑÔ∏è"><span class="option-icon">‚ùÑÔ∏è</span><span class="option-label">Ice</span></div><div class="option-item" data-value="üåü"><span class="option-icon">üåü</span><span class="option-label">Sparkle</span></div><div class="option-item" data-value="üíÄ"><span class="option-icon">üíÄ</span><span class="option-label">Skull</span></div><div class="option-item" data-value="üëª"><span class="option-icon">üëª</span><span class="option-label">Ghost</span></div><div class="option-item" data-value="üéÆ"><span class="option-icon">üéÆ</span><span class="option-label">Gamer</span></div><div class="option-item" data-value="üèÜ"><span class="option-icon">üèÜ</span><span class="option-label">Trophy</span></div><div class="option-item" data-value="üéØ"><span class="option-icon">üéØ</span><span class="option-label">Target</span></div><div class="option-item" data-value="ü¶Ñ"><span class="option-icon">ü¶Ñ</span><span class="option-label">Unicorn</span></div><div class="option-item" data-value="üê∫"><span class="option-icon">üê∫</span><span class="option-label">Wolf</span></div><div class="option-item" data-value="üóø"><span class="option-icon">üóø</span><span class="option-label">Moai</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <div class="form-section" id="color-section"><h2 class="section-title">Border Color</h2><p class="info-text">Your nameplate border color</p><div class="color-grid" id="color-options"><div class="color-option" data-value="gray" style="background:#6b7280;" title="Gray"></div><div class="color-option" data-value="gold" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);" title="Gold"></div><div class="color-option" data-value="diamond" style="background:linear-gradient(135deg,#67e8f9,#06b6d4);" title="Diamond"></div><div class="color-option" data-value="ruby" style="background:linear-gradient(135deg,#f87171,#dc2626);" title="Ruby"></div><div class="color-option" data-value="emerald" style="background:linear-gradient(135deg,#34d399,#10b981);" title="Emerald"></div><div class="color-option" data-value="amethyst" style="background:linear-gradient(135deg,#c084fc,#a855f7);" title="Amethyst"></div><div class="color-option" data-value="platinum" style="background:linear-gradient(135deg,#e2e8f0,#94a3b8);" title="Platinum"></div><div class="color-option" data-value="obsidian" style="background:linear-gradient(135deg,#312e81,#1e1b4b);" title="Obsidian"></div><div class="color-option" data-value="rose" style="background:linear-gradient(135deg,#fb7185,#f43f5e);" title="Rose"></div><div class="color-option" data-value="rainbow" style="background:linear-gradient(90deg,#f87171,#fbbf24,#34d399,#67e8f9,#c084fc);" title="Rainbow"></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <div class="form-section" id="border-section"><h2 class="section-title">Border Style</h2><p class="info-text">How your border appears</p><div class="option-grid" id="border-options"><div class="option-item" data-value="solid"><span class="option-icon">‚ñ¨</span><span class="option-label">Solid</span></div><div class="option-item" data-value="glow"><span class="option-icon">‚ú®</span><span class="option-label">Glow</span></div><div class="option-item" data-value="pulse"><span class="option-icon">üí´</span><span class="option-label">Pulse</span></div><div class="option-item" data-value="double"><span class="option-icon">‚ñ≠</span><span class="option-label">Double</span></div><div class="option-item" data-value="dotted"><span class="option-icon">‚îÖ</span><span class="option-label">Dotted</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <div class="form-section" id="effect-section"><h2 class="section-title">Name Effect</h2><p class="info-text">Special effect on your name</p><div class="option-grid" id="effect-options"><div class="option-item" data-value="none"><span class="option-icon">Aa</span><span class="option-label">None</span></div><div class="option-item" data-value="glow"><span class="option-icon">üåü</span><span class="option-label">Glow</span></div><div class="option-item" data-value="shadow"><span class="option-icon">üåë</span><span class="option-label">Shadow</span></div><div class="option-item" data-value="shimmer"><span class="option-icon">‚ú®</span><span class="option-label">Shimmer</span></div><div class="option-item" data-value="neon"><span class="option-icon">üí°</span><span class="option-label">Neon</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <div class="form-section" id="entrance-section"><h2 class="section-title">Entrance Animation</h2><p class="info-text">How you appear when joining a lobby</p><div class="option-grid" id="entrance-options"><div class="option-item" data-value="fade"><span class="option-icon">üëÅÔ∏è</span><span class="option-label">Fade</span></div><div class="option-item" data-value="slide"><span class="option-icon">‚û°Ô∏è</span><span class="option-label">Slide</span></div><div class="option-item" data-value="pop"><span class="option-icon">üí•</span><span class="option-label">Pop</span></div><div class="option-item" data-value="lightning"><span class="option-icon">‚ö°</span><span class="option-label">Lightning</span></div><div class="option-item" data-value="fire"><span class="option-icon">üî•</span><span class="option-label">Fire</span></div><div class="option-item" data-value="sparkle"><span class="option-icon">‚ú®</span><span class="option-label">Sparkle</span></div><div class="option-item" data-value="smoke"><span class="option-icon">üí®</span><span class="option-label">Smoke</span></div><div class="option-item" data-value="glitch"><span class="option-icon">üì∫</span><span class="option-label">Glitch</span></div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <div class="form-section" id="title-section"><h2 class="section-title">Title</h2><p class="info-text">Shows below your name</p><div class="title-grid" id="title-options"><div class="title-option" data-value="">None</div><div class="title-option" data-value="Not a Brokie">Not a Brokie</div><div class="title-option" data-value="Main Character">Main Character</div><div class="title-option" data-value="NPC Energy">NPC Energy</div><div class="title-option" data-value="Delulu">Delulu</div><div class="title-option" data-value="Built Different">Built Different</div><div class="title-option" data-value="No Cap">No Cap</div><div class="title-option" data-value="Touch Grass">Touch Grass</div><div class="title-option" data-value="Down Bad">Down Bad</div><div class="title-option" data-value="Certified Menace">Certified Menace</div><div class="title-option" data-value="Lowkey Goated">Lowkey Goated</div><div class="title-option" data-value="Unhinged">Unhinged</div><div class="title-option" data-value="Chaotic Neutral">Chaotic Neutral</div></div><div class="custom-title-wrapper"><label class="custom-title-label">Or write your own:</label><input type="text" class="custom-title-input" id="custom-title-input" placeholder="Your custom title..." maxlength="25"><div class="char-count"><span id="custom-title-count">0</span>/25 characters</div></div><span class="lock-badge" style="display:none;">üîí Upgrade to Unlock</span></div>
        <button class="btn-primary" id="save-cosmetics" style="width:100%;padding:16px;font-size:1rem;">Save Cosmetics</button>
      </div>
    </div>
  </div></section></main>
  <div class="avatar-modal" id="avatar-modal"><div class="avatar-modal-box"><h2 class="avatar-modal-title">CHOOSE AVATAR</h2><div class="avatar-grid" id="avatar-grid"><div class="avatar-option" data-value="üòé">üòé</div><div class="avatar-option" data-value="üéÆ">üéÆ</div><div class="avatar-option" data-value="üéØ">üéØ</div><div class="avatar-option" data-value="üèÜ">üèÜ</div><div class="avatar-option" data-value="‚ö°">‚ö°</div><div class="avatar-option" data-value="üî•">üî•</div><div class="avatar-option" data-value="‚ùÑÔ∏è">‚ùÑÔ∏è</div><div class="avatar-option" data-value="üåü">üåü</div><div class="avatar-option" data-value="üíé">üíé</div><div class="avatar-option" data-value="üëë">üëë</div><div class="avatar-option" data-value="üê∫">üê∫</div><div class="avatar-option" data-value="ü¶ä">ü¶ä</div><div class="avatar-option" data-value="ü¶Å">ü¶Å</div><div class="avatar-option" data-value="üêª">üêª</div><div class="avatar-option" data-value="ü¶Ñ">ü¶Ñ</div><div class="avatar-option" data-value="üêâ">üêâ</div><div class="avatar-option" data-value="üëª">üëª</div><div class="avatar-option" data-value="üíÄ">üíÄ</div><div class="avatar-option" data-value="ü§ñ">ü§ñ</div><div class="avatar-option" data-value="üëΩ">üëΩ</div><div class="avatar-option" data-value="ü•∑">ü•∑</div><div class="avatar-option" data-value="üßô">üßô</div><div class="avatar-option" data-value="üßõ">üßõ</div><div class="avatar-option" data-value="üßü">üßü</div><div class="avatar-option" data-value="üóø">üóø</div></div><div class="avatar-modal-actions"><button class="btn-ghost" onclick="closeAvatarModal()">Cancel</button><button class="btn-primary" onclick="saveAvatar()">Save Avatar</button></div></div></div>
  <div class="modal-overlay" id="sub-modal"><div class="modal-box"><h2 class="modal-title">MANAGE SUBSCRIPTION</h2><div class="modal-text">You're currently on <strong>Premium</strong>. Your subscription renews monthly at $1.50 CAD.</div><div class="modal-buttons"><button class="modal-btn modal-btn-primary" onclick="closeModal()">Keep Premium üëë</button><button class="modal-btn modal-btn-danger" onclick="confirmCancel()">Cancel Subscription</button><button class="modal-btn modal-btn-ghost" onclick="closeModal()">Close</button></div></div></div>
  <div class="modal-overlay" id="cancel-modal"><div class="modal-box"><h2 class="modal-title">üò¢ ARE YOU SURE?</h2><div class="modal-text">You'll lose access to all cosmetics and go back to seeing ads.<br><br>To cancel, reply to your Stripe payment receipt email with "cancel" or message us on <a href="https://ko-fi.com/thegamingco" target="_blank" style="color:var(--pink);">Ko-fi</a>.</div><div class="modal-buttons"><button class="modal-btn modal-btn-primary" onclick="closeCancelModal()">Nevermind, Keep Premium</button><button class="modal-btn modal-btn-ghost" onclick="closeCancelModal()">Close</button></div></div></div>
  <footer><div class="footer-border"></div><div class="footer-main"><div class="footer-links"><div class="footer-column"><h5>GAMES</h5><ul><li><a href="/solo">Solo</a></li><li><a href="/duos">Duos</a></li><li><a href="/squad-games">Squad</a></li><li><a href="/party-games">Party</a></li></ul></div><div class="footer-column"><h5>COMMUNITY</h5><ul><li><a href="/leaderboards">Leaderboards</a></li><li><a href="/supporters">Hall of Champions</a></li></ul></div><div class="footer-column"><h5>COMPANY</h5><ul><li><a href="/about">About</a></li><li><a href="mailto:hello@thegaming.co">Contact</a></li></ul></div></div><div class="footer-bottom"><p class="footer-copyright">¬© 2025 TheGaming.co ‚Äî Free party games, forever.</p></div></div></footer>
    const SUPABASE_URL = 'https://tvvivtmzofsyehatzlvl.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR2dml2dG16b2ZzeWVoYXR6bHZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4OTExODYsImV4cCI6MjA4MDQ2NzE4Nn0.Qy8kHMO0Nb4yJ0ZHjby7RuQtzwWB8rUcZvkdnbL1b3M';
    const RAILWAY_URL = 'https://web-production-519c7.up.railway.app';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let currentUser = null, currentProfile = null, isPremium = false, selectedAvatar = 'üòé';
    let cosmetics = { border_style: 'solid', border_color: 'gold', badge_icon: 'üëë', name_effect: 'none', title: null, entrance_animation: 'fade' };

    const LEVEL_THRESHOLDS = [0, 100, 250, 500, 1000, 1750, 2750, 4000, 5500, 7500, 10000, 13000, 16500, 20500, 25000, 30000, 36000, 43000, 51000, 60000];
    const GAME_ICONS = { 'aim-trainer': 'üéØ', 'typing-test': '‚å®Ô∏è', 'reaction-time': '‚ö°', 'chimp-test': 'üêµ', 'number-memory': 'üî¢' };
    const GAME_NAMES = { 'aim-trainer': 'Aim Trainer', 'typing-test': 'Typing Test', 'reaction-time': 'Reaction Time', 'chimp-test': 'Chimp Test', 'number-memory': 'Number Memory' };
    const blockedWords = ['fuck', 'shit', 'ass', 'bitch', 'dick', 'pussy', 'cock', 'cunt', 'nigger', 'faggot', 'retard'];
    const colorMap = { gray: '#6b7280', gold: '#fbbf24', diamond: '#67e8f9', ruby: '#f87171', emerald: '#34d399', amethyst: '#c084fc', platinum: '#e2e8f0', obsidian: '#312e81', rose: '#fb7185', rainbow: '#c084fc' };

    function containsProfanity(text) { return blockedWords.some(word => text.toLowerCase().includes(word)); }
    function getLevelFromXP(xp) { for (let i = LEVEL_THRESHOLDS.length - 1; i >= 0; i--) { if (xp >= LEVEL_THRESHOLDS[i]) return i + 1; } return 1; }
    function getXPProgress(xp) { const level = getLevelFromXP(xp); const curr = LEVEL_THRESHOLDS[level - 1] || 0; const next = LEVEL_THRESHOLDS[level] || LEVEL_THRESHOLDS[LEVEL_THRESHOLDS.length - 1]; return { progress: xp - curr, needed: next - curr, percentage: Math.min(((xp - curr) / (next - curr)) * 100, 100) }; }
    function formatPlaytime(m) { if (!m || m < 1) return '0m'; const h = Math.floor(m / 60); return h > 0 ? `${h}h ${m % 60}m` : `${m}m`; }

    const authSkeleton = document.getElementById('auth-skeleton'), headerUsernameLabel = document.getElementById('header-username-label');
    const loggedOutNav = document.querySelector('.nav-right-logged-out'), loggedInNav = document.querySelector('.nav-right-logged-in');
    const userMenuButton = document.getElementById('user-menu-button'), userMenu = document.getElementById('user-menu'), userMenuSignOut = document.getElementById('user-menu-signout');

    function primeHeaderFromCache() { try { const c = localStorage.getItem('tgco_header_label'); if (c) { headerUsernameLabel.textContent = c; authSkeleton && (authSkeleton.style.display = 'none'); loggedInNav && loggedInNav.style.setProperty('display', 'flex', 'important'); } else { authSkeleton && (authSkeleton.style.display = 'none'); loggedOutNav && loggedOutNav.style.setProperty('display', 'flex', 'important'); } } catch (e) { authSkeleton && (authSkeleton.style.display = 'none'); loggedOutNav && loggedOutNav.style.setProperty('display', 'flex', 'important'); } }
    function updateAuthUI(user) { authSkeleton && (authSkeleton.style.display = 'none'); if (user) { loggedOutNav && loggedOutNav.style.setProperty('display', 'none', 'important'); loggedInNav && loggedInNav.style.setProperty('display', 'flex', 'important'); } else { loggedOutNav && loggedOutNav.style.setProperty('display', 'flex', 'important'); loggedInNav && loggedInNav.style.setProperty('display', 'none', 'important'); } }
    async function checkSession() { const { data } = await supabaseClient.auth.getSession(); const user = data?.session?.user ?? null; updateAuthUI(user); return user; }

    let userMenuOpen = false;
    function setUserMenuOpen(o) { userMenuOpen = o; o ? userMenu.classList.add('open') : userMenu.classList.remove('open'); }
    userMenuButton && userMenuButton.addEventListener('click', (e) => { e.stopPropagation(); setUserMenuOpen(!userMenuOpen); });
    document.addEventListener('click', () => { if (userMenuOpen) setUserMenuOpen(false); });
    async function signOut() { await supabaseClient.auth.signOut(); localStorage.removeItem('tgco_header_label'); window.location.href = '/'; }
    userMenuSignOut && userMenuSignOut.addEventListener('click', (e) => { e.preventDefault(); signOut(); });
    primeHeaderFromCache();

    function showStatus(msg, type = 'success') { const s = document.getElementById('status-bar'); s.className = `status-bar visible ${type}`; document.getElementById('status-message').textContent = msg; setTimeout(() => s.classList.remove('visible'), 5000); }

    document.querySelectorAll('.tab-button').forEach(btn => { btn.addEventListener('click', () => { document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active')); document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active')); btn.classList.add('active'); document.getElementById(`${btn.dataset.tab}-tab`).classList.add('active'); }); });

    function openAvatarModal() { document.getElementById('avatar-modal').classList.add('open'); document.querySelectorAll('.avatar-option').forEach(o => o.classList.toggle('selected', o.dataset.value === selectedAvatar)); }
    function closeAvatarModal() { document.getElementById('avatar-modal').classList.remove('open'); }
    document.querySelectorAll('.avatar-option').forEach(o => { o.addEventListener('click', () => { document.querySelectorAll('.avatar-option').forEach(x => x.classList.remove('selected')); o.classList.add('selected'); selectedAvatar = o.dataset.value; }); });
    async function saveAvatar() { const { error } = await supabaseClient.from('profiles').update({ avatar: selectedAvatar }).eq('id', currentUser.id); if (error) { showStatus('Error: ' + error.message, 'error'); return; } document.getElementById('avatar-display').textContent = selectedAvatar; closeAvatarModal(); showStatus('Avatar saved! üé®', 'success'); }

    function lockCosmeticsForFreeUsers() { ['badge-section', 'color-section', 'border-section', 'effect-section', 'entrance-section', 'title-section'].forEach(id => { const s = document.getElementById(id); if (s) { s.classList.add('cosmetics-locked-overlay'); const b = s.querySelector('.lock-badge'); if (b) { b.style.display = 'block'; b.onclick = () => document.getElementById('upgrade-btn').scrollIntoView({ behavior: 'smooth', block: 'center' }); } } }); const btn = document.getElementById('save-cosmetics'); btn.textContent = 'üîí Upgrade to Save Cosmetics'; btn.disabled = true; }
    function unlockCosmeticsForPremium() { ['badge-section', 'color-section', 'border-section', 'effect-section', 'entrance-section', 'title-section'].forEach(id => { const s = document.getElementById(id); if (s) { s.classList.remove('cosmetics-locked-overlay'); const b = s.querySelector('.lock-badge'); if (b) b.style.display = 'none'; } }); const btn = document.getElementById('save-cosmetics'); btn.textContent = 'Save Cosmetics'; btn.disabled = false; }

    async function loadProfile() {
      const user = await checkSession(); if (!user) { window.location.href = '/login'; return; } currentUser = user;
      const { data: profile, error } = await supabaseClient.from('profiles').select('*').eq('id', user.id).single(); if (error) { showStatus('Error: ' + error.message, 'error'); return; } currentProfile = profile;
      const initial = (profile.display_name || profile.email || 'U').charAt(0).toUpperCase(); headerUsernameLabel.textContent = initial; localStorage.setItem('tgco_header_label', initial);
      const displayName = profile.display_name || 'Player'; document.getElementById('profile-display-name').textContent = displayName; document.getElementById('display-name').value = profile.display_name || '';
      document.getElementById('email').value = profile.email || user.email || ''; document.getElementById('account-type').value = profile.account_type === 'premium' ? 'Premium ‚≠ê' : 'Free'; document.getElementById('member-since').value = new Date(profile.created_at).toLocaleDateString();
      selectedAvatar = profile.avatar || 'üòé'; document.getElementById('avatar-display').textContent = selectedAvatar;
      document.getElementById('member-since-text').textContent = `Member since ${new Date(profile.created_at).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}`;
      const xp = profile.xp || 0, level = getLevelFromXP(xp), { progress, needed, percentage } = getXPProgress(xp);
      document.getElementById('xp-level-number').textContent = level; document.getElementById('level-badge').textContent = `LVL ${level}`; document.getElementById('xp-current').textContent = xp.toLocaleString(); document.getElementById('xp-needed').textContent = needed.toLocaleString(); document.getElementById('xp-bar-fill').style.width = `${percentage}%`;
      document.getElementById('stat-games-played').textContent = (profile.games_played || 0).toLocaleString(); document.getElementById('stat-playtime').textContent = formatPlaytime(profile.playtime_minutes || 0); document.getElementById('stat-personal-bests').textContent = profile.personal_bests || 0; document.getElementById('stat-best-rank').textContent = profile.best_rank ? `#${profile.best_rank}` : '#--';
      document.getElementById('total-games-text').textContent = `${profile.games_played || 0} games played`;
      if (profile.favorite_game) { document.getElementById('favorite-game').innerHTML = `<div class="favorite-game-icon">${GAME_ICONS[profile.favorite_game] || 'üéÆ'}</div><div class="favorite-game-info"><h4>${GAME_NAMES[profile.favorite_game] || profile.favorite_game}</h4><p>${profile.favorite_game_plays || 0} plays</p></div>`; }
      if (profile.least_played_game) { document.getElementById('least-played-game').innerHTML = `<div class="favorite-game-icon">${GAME_ICONS[profile.least_played_game] || '‚ùì'}</div><div class="favorite-game-info"><h4>${GAME_NAMES[profile.least_played_game] || profile.least_played_game}</h4><p>Give it a try!</p></div>`; }
      if (profile.cosmetics?.title) document.getElementById('profile-title-display').textContent = profile.cosmetics.title;
      document.getElementById('email-newsletter').checked = profile.email_newsletter || false; document.getElementById('email-new-games').checked = profile.email_new_games || false; document.getElementById('email-sponsored').checked = profile.email_sponsored || false;
      if (profile.cosmetics) cosmetics = { ...cosmetics, ...profile.cosmetics }; document.getElementById('preview-name').textContent = displayName;
      isPremium = profile.account_type === 'premium';
      if (isPremium) { document.getElementById('premium-cta').style.display = 'none'; document.getElementById('premium-active-banner').style.display = 'flex'; document.getElementById('premium-badge').style.display = 'inline-block'; unlockCosmeticsForPremium(); }
      else { document.getElementById('premium-cta').style.display = 'block'; document.getElementById('premium-active-banner').style.display = 'none'; document.getElementById('premium-badge').style.display = 'none'; lockCosmeticsForFreeUsers(); }
      initCosmeticsUI(); loadLeaderboardRanks();
    }

    async function loadLeaderboardRanks() {
      const games = ['aim-trainer', 'typing-test', 'reaction-time', 'chimp-test', 'number-memory'];
      const container = document.getElementById('leaderboard-ranks'); container.innerHTML = '';
      for (const game of games) {
        const isLower = game === 'reaction-time';
        const { data: userScore } = await supabaseClient.from('leaderboard_entries').select('score').eq('user_id', currentUser.id).eq('game_id', game).order('score', { ascending: isLower }).limit(1).single();
        let rank = '--', score = '--', rankClass = 'unranked';
        if (userScore) {
          score = userScore.score.toLocaleString() + (game === 'reaction-time' ? 'ms' : game === 'typing-test' ? ' WPM' : '');
          const { count } = await supabaseClient.from('leaderboard_entries').select('*', { count: 'exact', head: true }).eq('game_id', game)[isLower ? 'lt' : 'gt']('score', userScore.score);
          const r = (count || 0) + 1; rank = `#${r}`; rankClass = r <= 10 ? 'top-10' : r <= 100 ? 'top-100' : '';
        }
        container.innerHTML += `<div class="rank-card"><span class="rank-game-icon">${GAME_ICONS[game]}</span><div class="rank-info"><div class="rank-game-name">${GAME_NAMES[game]}</div><div class="rank-score">${score}</div></div><span class="rank-position ${rankClass}">${rank}</span></div>`;
      }
    }

    function initCosmeticsUI() {
      selectOption('badge-options', cosmetics.badge_icon || ''); selectOption('border-options', cosmetics.border_style || 'solid'); selectColor(cosmetics.border_color || 'gold'); selectOption('effect-options', cosmetics.name_effect || 'none'); selectOption('entrance-options', cosmetics.entrance_animation || 'fade');
      const presetTitles = Array.from(document.querySelectorAll('#title-options .title-option')).map(t => t.dataset.value);
      if (cosmetics.title && !presetTitles.includes(cosmetics.title)) { document.getElementById('custom-title-input').value = cosmetics.title; document.getElementById('custom-title-count').textContent = cosmetics.title.length; selectTitle(''); } else { selectTitle(cosmetics.title || ''); }
      updatePreview();
      document.querySelectorAll('#badge-options .option-item').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.badge_icon = i.dataset.value || null; selectOption('badge-options', i.dataset.value); updatePreview(); }); });
      document.querySelectorAll('#border-options .option-item').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.border_style = i.dataset.value; selectOption('border-options', i.dataset.value); updatePreview(); }); });
      document.querySelectorAll('#color-options .color-option').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.border_color = i.dataset.value; selectColor(i.dataset.value); updatePreview(); }); });
      document.querySelectorAll('#effect-options .option-item').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.name_effect = i.dataset.value; selectOption('effect-options', i.dataset.value); updatePreview(); }); });
      document.querySelectorAll('#entrance-options .option-item').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.entrance_animation = i.dataset.value; selectOption('entrance-options', i.dataset.value); }); });
      document.querySelectorAll('#title-options .title-option').forEach(i => { i.addEventListener('click', () => { if (!isPremium) return; cosmetics.title = i.dataset.value || null; selectTitle(i.dataset.value); document.getElementById('custom-title-input').value = ''; document.getElementById('custom-title-count').textContent = '0'; updatePreview(); }); });
      const customInput = document.getElementById('custom-title-input');
      customInput.addEventListener('input', (e) => { if (!isPremium) { e.target.value = ''; return; } const v = e.target.value; document.getElementById('custom-title-count').textContent = v.length; if (v.trim()) { cosmetics.title = v.trim(); document.querySelectorAll('#title-options .title-option').forEach(t => t.classList.remove('selected')); } else { cosmetics.title = null; } updatePreview(); });
    }

    function selectOption(cid, val) { document.querySelectorAll(`#${cid} .option-item`).forEach(i => i.classList.toggle('selected', i.dataset.value === val)); }
    function selectColor(val) { document.querySelectorAll('#color-options .color-option').forEach(i => i.classList.toggle('selected', i.dataset.value === val)); }
    function selectTitle(val) { document.querySelectorAll('#title-options .title-option').forEach(i => i.classList.toggle('selected', i.dataset.value === val)); }

    function updatePreview() {
      const np = document.getElementById('preview-nameplate'), badge = document.getElementById('preview-badge'), name = document.getElementById('preview-name'), title = document.getElementById('preview-title-text');
      badge.textContent = cosmetics.badge_icon || ''; badge.style.display = cosmetics.badge_icon ? 'inline' : 'none';
      const ck = cosmetics.border_color || 'gold', color = colorMap[ck] || colorMap.gold;
      np.setAttribute('data-color', ck); if (ck === 'rainbow') { name.style.color = '#c084fc'; np.style.borderColor = 'transparent'; } else { np.style.borderColor = color; name.style.color = color; }
      np.style.setProperty('--current-color', color); np.setAttribute('data-border', cosmetics.border_style || 'solid'); name.setAttribute('data-effect', cosmetics.name_effect || 'none');
      title.textContent = cosmetics.title || ''; title.style.display = cosmetics.title ? 'block' : 'none';
    }

    function playEntranceAnimation() { const np = document.getElementById('preview-nameplate'); np.style.animation = 'none'; void np.offsetWidth; const m = { fade: 'entranceFade', slide: 'entranceSlide', pop: 'entrancePop', lightning: 'entranceLightning', fire: 'entranceFire', sparkle: 'entranceSparkle', smoke: 'entranceSmoke', glitch: 'entranceGlitch' }; np.style.animation = `${m[cosmetics.entrance_animation] || 'entranceFade'} 0.6s ease both`; }

    document.getElementById('save-cosmetics').addEventListener('click', async () => { if (!isPremium) { showStatus('Upgrade to Premium!', 'error'); return; } if (cosmetics.title && containsProfanity(cosmetics.title)) { showStatus('Title contains inappropriate language.', 'error'); return; } const { error } = await supabaseClient.from('profiles').update({ cosmetics }).eq('id', currentUser.id); if (error) { showStatus('Error: ' + error.message, 'error'); return; } document.getElementById('profile-title-display').textContent = cosmetics.title || ''; showStatus('Cosmetics saved! üé®', 'success'); });

    document.getElementById('profile-form').addEventListener('submit', async (e) => { e.preventDefault(); const dn = document.getElementById('display-name').value.trim(); if (containsProfanity(dn)) { showStatus('Display name contains inappropriate language.', 'error'); return; } const { error } = await supabaseClient.from('profiles').update({ display_name: dn, gamer_tag: dn }).eq('id', currentUser.id); if (error) { showStatus('Error: ' + error.message, 'error'); return; } document.getElementById('preview-name').textContent = dn || 'YourName'; document.getElementById('profile-display-name').textContent = dn || 'Player'; try { const i = (dn || 'P').charAt(0).toUpperCase(); localStorage.setItem('tgco_header_label', i); headerUsernameLabel.textContent = i; } catch (e) {} showStatus('Profile updated!', 'success'); });

    document.getElementById('save-email-prefs').addEventListener('click', async () => { const { error } = await supabaseClient.from('profiles').update({ email_newsletter: document.getElementById('email-newsletter').checked, email_new_games: document.getElementById('email-new-games').checked, email_sponsored: document.getElementById('email-sponsored').checked }).eq('id', currentUser.id); if (error) { showStatus('Error: ' + error.message, 'error'); return; } showStatus('Preferences saved!', 'success'); });

    document.getElementById('upgrade-btn').addEventListener('click', async () => { const btn = document.getElementById('upgrade-btn'), txt = document.getElementById('upgrade-btn-text'), ld = document.getElementById('upgrade-btn-loading'); btn.disabled = true; txt.style.display = 'none'; ld.style.display = 'inline-flex'; try { const r = await fetch(`${RAILWAY_URL}/create-checkout-session`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ userId: currentUser.id, email: currentUser.email }) }); if (!r.ok) throw new Error(`Server error: ${r.status}`); const d = await r.json(); window.location.href = d.url; } catch (e) { showStatus('Error: ' + e.message, 'error'); btn.disabled = false; txt.style.display = 'inline'; ld.style.display = 'none'; } });

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true') { showStatus('üéâ Welcome to Premium! Cosmetics unlocked.', 'success'); window.history.replaceState({}, document.title, '/profile'); }
    else if (urlParams.get('canceled') === 'true') { showStatus('Payment canceled. Upgrade anytime!', 'error'); window.history.replaceState({}, document.title, '/profile'); }

    function openModal() { document.getElementById('sub-modal').classList.add('open'); }
    function closeModal() { document.getElementById('sub-modal').classList.remove('open'); }
    function confirmCancel() { document.getElementById('sub-modal').classList.remove('open'); document.getElementById('cancel-modal').classList.add('open'); }
    function closeCancelModal() { document.getElementById('cancel-modal').classList.remove('open'); }
    document.querySelectorAll('.modal-overlay').forEach(m => { m.addEventListener('click', (e) => { if (e.target === m) m.classList.remove('open'); }); });
    document.getElementById('avatar-modal').addEventListener('click', (e) => { if (e.target.id === 'avatar-modal') closeAvatarModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('open')); closeAvatarModal(); } });
    document.getElementById('manage-sub-btn').addEventListener('click', openModal);

    loadProfile();
  </script>
  <link rel="stylesheet" href="/social.css">
  <script src="/social.js"></script>
</body>
</html>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL='https://tvvivtmzofsyehatzlvl.supabase.co';
    const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR2dml2dG16b2ZzeWVoYXR6bHZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4OTExODYsImV4cCI6MjA4MDQ2NzE4Nn0.Qy8kHMO0Nb4yJ0ZHjby7RuQtzwWB8rUcZvkdnbL1b3M';
    const RAILWAY_URL='https://web-production-519c7.up.railway.app';
    const supabaseClient=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);
    let currentUser=null,currentProfile=null,isPremium=false,selectedAvatar='üòé';
    let cosmetics={border_style:'solid',border_color:'gold',badge_icon:'üëë',name_effect:'none',title:null,entrance_animation:'fade'};
    const LEVEL_THRESHOLDS=[0,100,250,500,1000,1750,2750,4000,5500,7500,10000,13000,16500,20500,25000,30000,36000,43000,51000,60000];
    const GAME_ICONS={'aim-trainer':'üéØ','typing-test':'‚å®Ô∏è','reaction-time':'‚ö°','chimp-test':'üêµ','number-memory':'üî¢'};
    const GAME_NAMES={'aim-trainer':'Aim Trainer','typing-test':'Typing Test','reaction-time':'Reaction Time','chimp-test':'Chimp Test','number-memory':'Number Memory'};
    const blockedWords=['fuck','shit','ass','bitch','dick','pussy','cock','cunt','nigger','faggot','retard'];
    const colorMap={gray:'#6b7280',gold:'#fbbf24',diamond:'#67e8f9',ruby:'#f87171',emerald:'#34d399',amethyst:'#c084fc',platinum:'#e2e8f0',obsidian:'#312e81',rose:'#fb7185',rainbow:'#c084fc'};
    function containsProfanity(t){return blockedWords.some(w=>t.toLowerCase().includes(w));}
    function getLevelFromXP(xp){for(let i=LEVEL_THRESHOLDS.length-1;i>=0;i--){if(xp>=LEVEL_THRESHOLDS[i])return i+1;}return 1;}
    function getXPProgress(xp){const l=getLevelFromXP(xp),c=LEVEL_THRESHOLDS[l-1]||0,n=LEVEL_THRESHOLDS[l]||LEVEL_THRESHOLDS[LEVEL_THRESHOLDS.length-1];return{progress:xp-c,needed:n-c,percentage:Math.min(((xp-c)/(n-c))*100,100)};}
    function formatPlaytime(m){if(!m||m<1)return'0m';const h=Math.floor(m/60);return h>0?`${h}h ${m%60}m`:`${m}m`;}
    const authSkeleton=document.getElementById('auth-skeleton'),headerUsernameLabel=document.getElementById('header-username-label');
    const loggedOutNav=document.querySelector('.nav-right-logged-out'),loggedInNav=document.querySelector('.nav-right-logged-in');
    const userMenuButton=document.getElementById('user-menu-button'),userMenu=document.getElementById('user-menu'),userMenuSignOut=document.getElementById('user-menu-signout');
    function primeHeaderFromCache(){try{const c=localStorage.getItem('tgco_header_label');if(c){headerUsernameLabel.textContent=c;authSkeleton&&(authSkeleton.style.display='none');loggedInNav&&loggedInNav.style.setProperty('display','flex','important');}else{authSkeleton&&(authSkeleton.style.display='none');loggedOutNav&&loggedOutNav.style.setProperty('display','flex','important');}}catch(e){authSkeleton&&(authSkeleton.style.display='none');loggedOutNav&&loggedOutNav.style.setProperty('display','flex','important');}}
    function updateAuthUI(user){authSkeleton&&(authSkeleton.style.display='none');if(user){loggedOutNav&&loggedOutNav.style.setProperty('display','none','important');loggedInNav&&loggedInNav.style.setProperty('display','flex','important');}else{loggedOutNav&&loggedOutNav.style.setProperty('display','flex','important');loggedInNav&&loggedInNav.style.setProperty('display','none','important');}}
    async function checkSession(){const{data}=await supabaseClient.auth.getSession();const user=data?.session?.user??null;updateAuthUI(user);return user;}
    let userMenuOpen=false;
    function setUserMenuOpen(o){userMenuOpen=o;o?userMenu.classList.add('open'):userMenu.classList.remove('open');}
    userMenuButton&&userMenuButton.addEventListener('click',(e)=>{e.stopPropagation();setUserMenuOpen(!userMenuOpen);});
    document.addEventListener('click',()=>{if(userMenuOpen)setUserMenuOpen(false);});
    async function signOut(){await supabaseClient.auth.signOut();localStorage.removeItem('tgco_header_label');window.location.href='/';}
    userMenuSignOut&&userMenuSignOut.addEventListener('click',(e)=>{e.preventDefault();signOut();});
    primeHeaderFromCache();
    function showStatus(msg,type='success'){const s=document.getElementById('status-bar');s.className=`status-bar visible ${type}`;document.getElementById('status-message').textContent=msg;setTimeout(()=>s.classList.remove('visible'),5000);}
    document.querySelectorAll('.tab-button').forEach(btn=>{btn.addEventListener('click',()=>{document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));btn.classList.add('active');document.getElementById(`${btn.dataset.tab}-tab`).classList.add('active');});});
    function openAvatarModal(){document.getElementById('avatar-modal').classList.add('open');document.querySelectorAll('.avatar-option').forEach(o=>o.classList.toggle('selected',o.dataset.value===selectedAvatar));}
    function closeAvatarModal(){document.getElementById('avatar-modal').classList.remove('open');}
    document.querySelectorAll('.avatar-option').forEach(o=>{o.addEventListener('click',()=>{document.querySelectorAll('.avatar-option').forEach(x=>x.classList.remove('selected'));o.classList.add('selected');selectedAvatar=o.dataset.value;});});
    async function saveAvatar(){const{error}=await supabaseClient.from('profiles').update({avatar:selectedAvatar}).eq('id',currentUser.id);if(error){showStatus('Error: '+error.message,'error');return;}document.getElementById('avatar-display').textContent=selectedAvatar;closeAvatarModal();showStatus('Avatar saved! üé®','success');}
    function lockCosmeticsForFreeUsers(){['badge-section','color-section','border-section','effect-section','entrance-section','title-section'].forEach(id=>{const s=document.getElementById(id);if(s){s.classList.add('cosmetics-locked-overlay');const b=s.querySelector('.lock-badge');if(b){b.style.display='block';b.onclick=()=>document.getElementById('upgrade-btn').scrollIntoView({behavior:'smooth',block:'center'});}}});const btn=document.getElementById('save-cosmetics');btn.textContent='üîí Upgrade to Save Cosmetics';btn.disabled=true;}
    function unlockCosmeticsForPremium(){['badge-section','color-section','border-section','effect-section','entrance-section','title-section'].forEach(id=>{const s=document.getElementById(id);if(s){s.classList.remove('cosmetics-locked-overlay');const b=s.querySelector('.lock-badge');if(b)b.style.display='none';}});const btn=document.getElementById('save-cosmetics');btn.textContent='Save Cosmetics';btn.disabled=false;}
    async function loadProfile(){
      const user=await checkSession();if(!user){window.location.href='/login';return;}currentUser=user;
      const{data:profile,error}=await supabaseClient.from('profiles').select('*').eq('id',user.id).single();if(error){showStatus('Error: '+error.message,'error');return;}currentProfile=profile;
      const initial=(profile.display_name||profile.email||'U').charAt(0).toUpperCase();headerUsernameLabel.textContent=initial;localStorage.setItem('tgco_header_label',initial);
      const displayName=profile.display_name||'Player';document.getElementById('profile-display-name').textContent=displayName;document.getElementById('display-name').value=profile.display_name||'';
      document.getElementById('email').value=profile.email||user.email||'';document.getElementById('account-type').value=profile.account_type==='premium'?'Premium ‚≠ê':'Free';document.getElementById('member-since').value=new Date(profile.created_at).toLocaleDateString();
      selectedAvatar=profile.avatar||'üòé';document.getElementById('avatar-display').textContent=selectedAvatar;
      document.getElementById('member-since-text').textContent=`Member since ${new Date(profile.created_at).toLocaleDateString('en-US',{month:'short',year:'numeric'})}`;
      const xp=profile.xp||0,level=getLevelFromXP(xp),{progress,needed,percentage}=getXPProgress(xp);
      document.getElementById('xp-level-number').textContent=level;document.getElementById('level-badge').textContent=`LVL ${level}`;document.getElementById('xp-current').textContent=xp.toLocaleString();document.getElementById('xp-needed').textContent=needed.toLocaleString();document.getElementById('xp-bar-fill').style.width=`${percentage}%`;
      document.getElementById('stat-games-played').textContent=(profile.games_played||0).toLocaleString();document.getElementById('stat-playtime').textContent=formatPlaytime(profile.playtime_minutes||0);document.getElementById('stat-personal-bests').textContent=profile.personal_bests||0;document.getElementById('stat-best-rank').textContent=profile.best_rank?`#${profile.best_rank}`:'#--';
      document.getElementById('total-games-text').textContent=`${profile.games_played||0} games played`;
      if(profile.favorite_game){document.getElementById('favorite-game').innerHTML=`<div class="favorite-game-icon">${GAME_ICONS[profile.favorite_game]||'üéÆ'}</div><div class="favorite-game-info"><h4>${GAME_NAMES[profile.favorite_game]||profile.favorite_game}</h4><p>${profile.favorite_game_plays||0} plays</p></div>`;}
      if(profile.least_played_game){document.getElementById('least-played-game').innerHTML=`<div class="favorite-game-icon">${GAME_ICONS[profile.least_played_game]||'‚ùì'}</div><div class="favorite-game-info"><h4>${GAME_NAMES[profile.least_played_game]||profile.least_played_game}</h4><p>Give it a try!</p></div>`;}
      if(profile.cosmetics?.title)document.getElementById('profile-title-display').textContent=profile.cosmetics.title;
      document.getElementById('email-newsletter').checked=profile.email_newsletter||false;document.getElementById('email-new-games').checked=profile.email_new_games||false;document.getElementById('email-sponsored').checked=profile.email_sponsored||false;
      if(profile.cosmetics)cosmetics={...cosmetics,...profile.cosmetics};
      document.getElementById('preview-name').textContent=displayName;
      isPremium=profile.account_type==='premium';
      if(isPremium){document.getElementById('premium-cta').style.display='none';document.getElementById('premium-active-banner').style.display='flex';document.getElementById('premium-badge').style.display='inline-block';unlockCosmeticsForPremium();}else{document.getElementById('premium-cta').style.display='block';document.getElementById('premium-active-banner').style.display='none';document.getElementById('premium-badge').style.display='none';lockCosmeticsForFreeUsers();}
      initCosmeticsUI();loadLeaderboardRanks();
    }
    async function loadLeaderboardRanks(){
      const games=['aim-trainer','typing-test','reaction-time','chimp-test','number-memory'];
      const container=document.getElementById('leaderboard-ranks');container.innerHTML='';
      for(const game of games){
        const{data:userScore}=await supabaseClient.from('leaderboard_entries').select('score').eq('user_id',currentUser.id).eq('game_id',game).order('score',{ascending:game==='reaction-time'}).limit(1).single();
        let rank='--',score='--',rankClass='unranked';
        if(userScore){score=userScore.score.toLocaleString();const isLowerBetter=game==='reaction-time';const{count}=await supabaseClient.from('leaderboard_entries').select('*',{count:'exact',head:true}).eq('game_id',game).lt('score',isLowerBetter?userScore.score:-userScore.score);const userRank=(count||0)+1;rank=`#${userRank}`;if(userRank<=10)rankClass='top-10';else if(userRank<=100)rankClass='top-100';else rankClass='';}
        container.innerHTML+=`<div class="rank-card"><span class="rank-game-icon">${GAME_ICONS[game]}</span><div class="rank-info"><div class="rank-game-name">${GAME_NAMES[game]}</div><div class="rank-score">${score}</div></div><span class="rank-position ${rankClass}">${rank}</span></div>`;
      }
    }
    function initCosmeticsUI(){
      selectOption('badge-options',cosmetics.badge_icon||'');selectOption('border-options',cosmetics.border_style||'solid');selectColor(cosmetics.border_color||'gold');selectOption('effect-options',cosmetics.name_effect||'none');selectOption('entrance-options',cosmetics.entrance_animation||'fade');
      const presetTitles=Array.from(document.querySelectorAll('#title-options .title-option')).map(t=>t.dataset.value);
      if(cosmetics.title&&!presetTitles.includes(cosmetics.title)){document.getElementById('custom-title-input').value=cosmetics.title;document.getElementById('custom-title-count').textContent=cosmetics.title.length;selectTitle('');}else{selectTitle(cosmetics.title||'');}
      updatePreview();
      document.querySelectorAll('#badge-options .option-item').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.badge_icon=item.dataset.value||null;selectOption('badge-options',item.dataset.value);updatePreview();});});
      document.querySelectorAll('#border-options .option-item').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.border_style=item.dataset.value;selectOption('border-options',item.dataset.value);updatePreview();});});
      document.querySelectorAll('#color-options .color-option').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.border_color=item.dataset.value;selectColor(item.dataset.value);updatePreview();});});
      document.querySelectorAll('#effect-options .option-item').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.name_effect=item.dataset.value;selectOption('effect-options',item.dataset.value);updatePreview();});});
      document.querySelectorAll('#entrance-options .option-item').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.entrance_animation=item.dataset.value;selectOption('entrance-options',item.dataset.value);});});
      document.querySelectorAll('#title-options .title-option').forEach(item=>{item.addEventListener('click',()=>{if(!isPremium)return;cosmetics.title=item.dataset.value||null;selectTitle(item.dataset.value);document.getElementById('custom-title-input').value='';document.getElementById('custom-title-count').textContent='0';updatePreview();});});
      const customTitleInput=document.getElementById('custom-title-input'),customTitleCount=document.getElementById('custom-title-count');
      customTitleInput.addEventListener('input',(e)=>{if(!isPremium){e.target.value='';return;}const v=e.target.value;customTitleCount.textContent=v.length;if(v.trim()){cosmetics.title=v.trim();document.querySelectorAll('#title-options .title-option').forEach(t=>t.classList.remove('selected'));}else{cosmetics.title=null;}updatePreview();});
    }
    function selectOption(containerId,value){document.querySelectorAll(`#${containerId} .option-item`).forEach(item=>{item.classList.toggle('selected',item.dataset.value===value);});}
    function selectColor(value){document.querySelectorAll('#color-options .color-option').forEach(item=>{item.classList.toggle('selected',item.dataset.value===value);});}
    function selectTitle(value){document.querySelectorAll('#title-options .title-option').forEach(item=>{item.classList.toggle('selected',item.dataset.value===value);});}
    function updatePreview(){
      const nameplate=document.getElementById('preview-nameplate'),badge=document.getElementById('preview-badge'),name=document.getElementById('preview-name'),title=document.getElementById('preview-title-text');
      badge.textContent=cosmetics.badge_icon||'';badge.style.display=cosmetics.badge_icon?'inline':'none';
      const colorKey=cosmetics.border_color||'gold',color=colorMap[colorKey]||colorMap.gold;
      nameplate.setAttribute('data-color',colorKey);
      if(colorKey==='rainbow'){name.style.color='#c084fc';nameplate.style.borderColor='transparent';}else{nameplate.style.borderColor=color;name.style.color=color;}
      nameplate.style.setProperty('--current-color',color);nameplate.setAttribute('data-border',cosmetics.border_style||'solid');name.setAttribute('data-effect',cosmetics.name_effect||'none');
      title.textContent=cosmetics.title||'';title.style.display=cosmetics.title?'block':'none';
    }
    function playEntranceAnimation(){const np=document.getElementById('preview-nameplate');np.style.animation='none';void np.offsetWidth;const animMap={fade:'entranceFade',slide:'entranceSlide',pop:'entrancePop',lightning:'entranceLightning',fire:'entranceFire',sparkle:'entranceSparkle',smoke:'entranceSmoke',glitch:'entranceGlitch'};np.style.animation=`${animMap[cosmetics.entrance_animation]||'entranceFade'} 0.6s ease both`;}
    document.getElementById('save-cosmetics').addEventListener('click',async()=>{if(!isPremium){showStatus('Upgrade to Premium to save cosmetics!','error');return;}if(cosmetics.title&&containsProfanity(cosmetics.title)){showStatus('Your title contains inappropriate language.','error');return;}const{error}=await supabaseClient.from('profiles').update({cosmetics}).eq('id',currentUser.id);if(error){showStatus('Error: '+error.message,'error');return;}document.getElementById('profile-title-display').textContent=cosmetics.title||'';showStatus('Cosmetics saved! üé®','success');});
    document.getElementById('profile-form').addEventListener('submit',async(e)=>{e.preventDefault();const displayName=document.getElementById('display-name').value.trim();if(containsProfanity(displayName)){showStatus('Display name contains inappropriate language.','error');return;}const{error}=await supabaseClient.from('profiles').update({display_name:displayName,gamer_tag:displayName}).eq('id',currentUser.id);if(error){showStatus('Error: '+error.message,'error');return;}document.getElementById('preview-name').textContent=displayName||'YourName';document.getElementById('profile-display-name').textContent=displayName||'Player';try{const initial=(displayName||'P').charAt(0).toUpperCase();localStorage.setItem('tgco_header_label',initial);headerUsernameLabel.textContent=initial;}catch(e){}showStatus('Profile updated!','success');});
    document.getElementById('save-email-prefs').addEventListener('click',async()=>{const{error}=await supabaseClient.from('profiles').update({email_newsletter:document.getElementById('email-newsletter').checked,email_new_games:document.getElementById('email-new-games').checked,email_sponsored:document.getElementById('email-sponsored').checked}).eq('id',currentUser.id);if(error){showStatus('Error: '+error.message,'error');return;}showStatus('Preferences saved!','success');});
    document.getElementById('upgrade-btn').addEventListener('click',async()=>{const btn=document.getElementById('upgrade-btn'),btnText=document.getElementById('upgrade-btn-text'),btnLoading=document.getElementById('upgrade-btn-loading');btn.disabled=true;btnText.style.display='none';btnLoading.style.display='inline-flex';try{const response=await fetch(`${RAILWAY_URL}/create-checkout-session`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:currentUser.id,email:currentUser.email})});if(!response.ok)throw new Error(`Server error: ${response.status}`);const data=await response.json();window.location.href=data.url;}catch(error){showStatus('Error: '+error.message,'error');btn.disabled=false;btnText.style.display='inline';btnLoading.style.display='none';}});
    const urlParams=new URLSearchParams(window.location.search);if(urlParams.get('success')==='true'){showStatus('üéâ Welcome to Premium! Cosmetics unlocked.','success');window.history.replaceState({},document.title,'/profile');}else if(urlParams.get('canceled')==='true'){showStatus('Payment canceled. Upgrade anytime!','error');window.history.replaceState({},document.title,'/profile');}
    function openModal(){document.getElementById('sub-modal').classList.add('open');}function closeModal(){document.getElementById('sub-modal').classList.remove('open');}function confirmCancel(){document.getElementById('sub-modal').classList.remove('open');document.getElementById('cancel-modal').classList.add('open');}function closeCancelModal(){document.getElementById('cancel-modal').classList.remove('open');}
    document.querySelectorAll('.modal-overlay').forEach(m=>{m.addEventListener('click',(e)=>{if(e.target===m)m.classList.remove('open');});});
    document.getElementById('avatar-modal').addEventListener('click',(e)=>{if(e.target.id==='avatar-modal')closeAvatarModal();});
    document.addEventListener('keydown',(e)=>{if(e.key==='Escape'){document.querySelectorAll('.modal-overlay').forEach(m=>m.classList.remove('open'));closeAvatarModal();}});
    document.getElementById('manage-sub-btn').addEventListener('click',openModal);
    loadProfile();
  </script>
  <link rel="stylesheet" href="/social.css">
  <script src="/social.js"></script>
</body>
</html>
