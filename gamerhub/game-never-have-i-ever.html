<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Never Have I Ever - PlayHub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* All Base Styles (from previous versions) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #fafbff; color: #1a1a1a; overflow-x: hidden; position: relative; min-height: 100vh; }
        h1, h2, h3 { font-family: 'Bebas Neue', sans-serif; letter-spacing: 1px; }

        /* Animated background blobs (Copied directly for consistency) */
        .bg-shape { position: fixed; pointer-events: none; z-index: 0; opacity: 0.6; }
        .shape-1 { top: -80px; right: -80px; width: 350px; height: 350px; background: linear-gradient(135deg, #ff6b9d30 0%, #c4456930 100%); border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; animation: morph 10s ease-in-out infinite; }
        .shape-2 { top: 50%; left: -120px; width: 300px; height: 300px; background: linear-gradient(135deg, #ff6b9d30 0%, #c4456930 100%); border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; animation: morph 12s ease-in-out infinite reverse; }
        .shape-3 { bottom: -80px; right: 15%; width: 280px; height: 280px; background: linear-gradient(135deg, #ff6b9d30 0%, #c4456930 100%); border-radius: 50% 50% 30% 70% / 50% 50% 70% 30%; animation: morph 14s ease-in-out infinite; }
        @keyframes morph { 0%, 100% { border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; transform: rotate(0deg); } 50% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; transform: rotate(5deg); } }

        .container { max-width: 900px; margin: 0 auto; padding: 0 40px; position: relative; z-index: 1; min-height: 100vh; display: flex; flex-direction: column; }
        
        /* Navigation */
        nav { padding: 30px 0; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #1a1a1a; margin-bottom: 40px; position: relative; z-index: 10; }
        .logo-nav { font-family: 'Bebas Neue', sans-serif; font-size: 2.1rem; letter-spacing: 2px; color: #1a1a1a; text-decoration: none; }
        .back-btn { display: inline-flex; align-items: center; gap: 8px; color: #666; text-decoration: none; font-weight: 700; font-size: 0.95rem; transition: color 0.3s ease; }
        .back-btn:hover { color: #1a1a1a; }

        /* General Content */
        .game-content { flex: 1; display: flex; flex-direction: column; padding-bottom: 60px; }
        .hidden { display: none !important; }

        /* --- SCREEN STYLES (Category, Pack Selection) --- */
        .selection-screen { max-width: 800px; margin: 40px auto; }
        .selection-header { text-align: center; margin-bottom: 50px; }
        .selection-header h2 { font-size: 4.5rem; line-height: 1; margin-bottom: 15px; text-shadow: 2px 2px 0 rgba(255, 107, 157, 0.2); }
        .selection-header p { font-size: 1.2rem; color: #666; font-weight: 500; }
        
        /* 2x2 Grid for 4 categories (If we expand later) */
        .selection-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; } 
        
        .selection-card { background: white; border: 3px solid #1a1a1a; padding: 40px 30px; cursor: pointer; transition: all 0.3s ease; box-shadow: 5px 5px 0 #e0e0e0; text-align: center; }
        .selection-card:hover { transform: translate(2px, -2px); box-shadow: 3px 3px 0 #e0e0e0; }
        .selection-icon { font-size: 3rem; margin-bottom: 15px; }
        .selection-card h3 { font-size: 2rem; margin-bottom: 10px; line-height: 1; }
        .selection-description { font-size: 0.95rem; color: #666; margin-bottom: 12px; font-weight: 500; line-height: 1.5; }

        /* Pack Specific Styles */
        .packs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; } 

        .pack-card { background: white; border: 3px solid #1a1a1a; padding: 35px 25px; cursor: pointer; transition: all 0.3s ease; box-shadow: 5px 5px 0 #e0e0e0; text-align: center; }
        .pack-number { font-family: 'Bebas Neue', sans-serif; font-size: 3rem; color: #ff6b9d; margin-bottom: 10px; line-height: 1; }
        .pack-questions { font-family: 'Bebas Neue', sans-serif; font-size: 0.9rem; color: #666; letter-spacing: 1px; }

        .back-link { display: inline-flex; align-items: center; gap: 8px; color: #666; text-decoration: none; font-weight: 700; font-size: 0.95rem; cursor: pointer; margin-bottom: 30px; }
        .back-link:hover { color: #1a1a1a; }

        /* --- GAME SCREEN STYLES --- */
        .game-screen { display: none; }
        .progress-bar-container { background: white; border: 3px solid #1a1a1a; padding: 8px; margin-bottom: 40px; box-shadow: 4px 4px 0 #e0e0e0; }
        .progress-bar { height: 12px; background: #f0f0f0; position: relative; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%); transition: width 0.3s ease; }
        .game-header { text-align: center; margin-bottom: 40px; position: relative; }
        .quit-btn { position: absolute; right: 0; top: 0; background: white; border: 2px solid #1a1a1a; padding: 8px 20px; font-family: 'Bebas Neue', sans-serif; font-size: 1rem; letter-spacing: 1px; cursor: pointer; transition: all 0.3s ease; color: #666; }
        .quit-btn:hover { background: #f0f0f0; color: #1a1a1a; }
        
        .mode-label { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; color: #ff6b9d; letter-spacing: 2px; margin-bottom: 8px; }
        .prompt-counter { font-family: 'Bebas Neue', sans-serif; font-size: 1.3rem; color: #666; letter-spacing: 1px; }

        /* Player Turn Card - Modified to be the "Reader" card */
        .turn-card { 
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
            color: white; 
            border: 4px solid #8b2e47; 
            box-shadow: 8px 8px 0 #8b2e47; 
            padding: 60px 50px; 
            margin-bottom: 40px;
            min-height: 280px; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: center; 
            text-align: center;
        }

        .turn-card h3 {
            font-size: 3rem;
            margin-bottom: 20px;
            line-height: 1;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.1);
        }

        .turn-instruction {
            font-size: 1.2rem;
            font-weight: 500;
        }

        /* Prompt Card - Shows the question */
        .prompt-card { 
            background: white; 
            color: #1a1a1a; 
            border: 4px solid #1a1a1a; 
            padding: 60px 50px; 
            margin-bottom: 40px; 
            box-shadow: 8px 8px 0 #e0e0e0; 
            min-height: 280px; 
            display: none; /* Starts hidden */
            flex-direction: column;
            align-items: center; 
            justify-content: center; 
        }

        .prompt-text { 
            font-size: 1.8rem; 
            line-height: 1.5; 
            text-align: center; 
            font-weight: 600; 
            color: #1a1a1a; 
        }

        .answer-prompt {
            font-size: 1rem;
            color: #ff6b9d;
            font-weight: 700;
            margin-top: 20px;
        }
        
        .reveal-btn {
            background: #1a1a1a;
            color: white;
            border-color: #1a1a1a;
            box-shadow: 5px 5px 0 #e0e0e0;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 1px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .reveal-btn:hover:not(:disabled) {
            transform: translate(2px, -2px);
            box-shadow: 3px 3px 0 #e0e0e0;
        }

        .navigation { 
            display: flex; 
            gap: 15px;
            justify-content: center; /* Center navigation buttons */
        }
        .nav-btn { flex: 1; padding: 18px 30px; font-size: 1.2rem; font-family: 'Bebas Neue', sans-serif; letter-spacing: 1px; border: 3px solid #1a1a1a; cursor: pointer; transition: all 0.3s ease; }
        .nav-btn.prev { 
            background: white; color: #1a1a1a; box-shadow: 5px 5px 0 #e0e0e0;
            flex-grow: 0.5; /* Make previous button smaller */
        }
        .nav-btn.prev:hover:not(:disabled) { transform: translate(2px, -2px); box-shadow: 3px 3px 0 #e0e0e0; }
        .nav-btn.next { 
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%); color: white; border-color: #8b2e47; box-shadow: 5px 5px 0 #8b2e47; 
            flex-grow: 1; /* Make next button primary width */
        }
        .nav-btn.next:hover:not(:disabled) { transform: translate(2px, -2px); box-shadow: 3px 3px 0 #8b2e47; }
        .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }

        /* End Screen */
        .end-screen { display: none; text-align: center; max-width: 700px; margin: 80px auto; }
        .end-screen h2 { font-size: 5.5rem; line-height: 1; margin-bottom: 30px; text-shadow: 3px 3px 0 rgba(255, 107, 157, 0.2); }
        .end-message { font-size: 1.3rem; line-height: 1.8; color: #666; margin-bottom: 50px; font-weight: 500; }
        .end-actions { display: flex; flex-direction: column; gap: 15px; }
        .action-btn { padding: 18px 40px; font-size: 1.3rem; font-family: 'Bebas Neue', sans-serif; letter-spacing: 1px; border: 3px solid #1a1a1a; cursor: pointer; transition: all 0.3s ease; }
        .action-btn.primary { background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%); color: white; border-color: #8b2e47; box-shadow: 5px 5px 0 #8b2e47; }
        .action-btn.secondary { background: white; color: #1a1a1a; box-shadow: 5px 5px 0 #e0e0e0; }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container { padding: 0 20px; }
            .selection-header h2, .end-screen h2 { font-size: 3.5rem; }
            .selection-grid { grid-template-columns: 1fr; } 
            .packs-grid { grid-template-columns: 1fr; }
            .quit-btn { position: static; margin-bottom: 15px; display: block; width: 100%; }
            .prompt-text { font-size: 1.4rem; }
            .turn-card, .prompt-card { padding: 40px 30px; min-height: 240px; }
            .turn-card h3 { font-size: 2.2rem; }
            .nav-btn { font-size: 1.1rem; padding: 15px 20px; }
        }
    </style>
</head>
<body>
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>
    <div class="bg-shape shape-3"></div>

    <div class="container">
        <nav>
            <a href="index.html" class="logo-nav">PLAYHUB</a>
            <a href="date-night.html" class="back-btn">
                ‚Üê Back to Games
            </a>
        </nav>

        <div class="game-content">
            
            <div class="selection-screen" id="categorySelection">
                <div class="selection-header">
                    <h2>NEVER HAVE I EVER</h2>
                    <p>Choose a category and discover your partner's playful secrets!</p>
                </div>

                <div class="selection-grid">
                    
                    <div class="selection-card" onclick="showPacks('icebreaker')">
                        <div class="selection-icon">üßä</div>
                        <h3>BREAKING THE ICE</h3>
                        <p class="selection-description">Lighthearted, funny statements about travel, habits, and silly mistakes.</p>
                    </div>

                    <div class="selection-card" onclick="showPacks('personal')">
                        <div class="selection-icon">üí≠</div>
                        <h3>DEEP & PERSONAL</h3>
                        <p class="selection-description">Truths about past regrets, strong opinions, and big life choices.</p>
                    </div>
                    
                    <div class="selection-card" onclick="showPacks('spicy')">
                        <div class="selection-icon">üî•</div>
                        <h3>SPICY & FLIRTY</h3>
                        <p class="selection-description">Intimate questions about dating history, fantasy, and sensual experiences.</p>
                    </div>

                </div>
            </div>

            <div class="selection-screen hidden" id="packSelection">
                <span class="back-link" onclick="backToCategories()">‚Üê Back to Categories</span>
                
                <div class="selection-header">
                    <h2 id="packCategoryTitle"></h2>
                    <p>Choose a pack of 20 prompts</p>
                </div>

                <div class="packs-grid" id="packsGrid">
                    </div>
            </div>

            <div class="game-screen" id="gameScreen">
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div class="game-header">
                    <button class="quit-btn" onclick="quitToPacks()">QUIT</button>
                    <div class="mode-label">NEVER HAVE I EVER</div>
                    <div class="prompt-counter" id="promptCounter">PROMPT 1 OF 20</div>
                </div>

                <div class="turn-card" id="turnCard">
                    <h3 id="turnPlayer">PASS TO PLAYER 1</h3>
                    <p class="turn-instruction" id="turnInstruction">
                        Player 1, read the prompt on the next card out loud to both players.
                    </p>
                    <button class="reveal-btn" id="showPromptBtn" onclick="showPromptCard()">SHOW PROMPT</button>
                </div>

                <div class="prompt-card" id="promptCard">
                    <p class="prompt-text" id="promptText"></p>
                    <p class="answer-prompt">Answer together, then discuss your 'I Have's!</p>
                </div>

                <div class="navigation">
                    <button class="nav-btn prev" id="prevBtn" onclick="previousPrompt()">‚Üê PREVIOUS</button>
                    <button class="nav-btn next" id="nextBtn" onclick="nextPrompt()">NEXT ‚Üí</button>
                </div>
            </div>

            <div class="end-screen" id="endScreen">
                <h2>YOU DID IT! üéâ</h2>
                <p class="end-message">
                    Great revelations! Hope you learned something new about your partner.
                </p>
                <div class="end-actions">
                    <button class="action-btn primary" onclick="backToPackSelection()">TRY ANOTHER PACK</button>
                    <button class="action-btn secondary" onclick="backToGames()">BACK TO DATE NIGHT</button>
                </div>
            </div>
        </div>

        <footer>
            </footer>
    </div>

    <script>
        // --- GAME STATE & DATA ---
        let currentPromptIndex = 0;
        let currentCategory = '';
        let currentPack = '';
        let currentPrompts = [];
        let currentPlayer = 1; // Start with Player 1 reading
        const PROMPT_COUNT = 20; 

        const categoryTitles = {
            'icebreaker': 'BREAKING THE ICE',
            'personal': 'DEEP & PERSONAL',
            'spicy': 'SPICY & FLIRTY',
        };
        
        // --- NEVER HAVE I EVER PROMPTS (3 CATEGORIES, 3 PACKS EACH) ---
        const nhiePrompts = {
            icebreaker: {
                pack1: [
                    "forgotten my wallet and had to borrow money from a stranger.",
                    "lied to a friend about where I was going.",
                    "spilled a drink all over myself in public.",
                    "re-gifted a present.",
                    "snuck into a movie theater.",
                    "eaten cereal for dinner.",
                    "pretended to know a song when I didn't.",
                    "gone a full 24 hours without checking my phone.",
                    "gotten lost in my own city.",
                    "watched a movie more than three times in a single week.",
                    "accidentally sent a text message to the wrong person.",
                    "faked sick to get out of an obligation.",
                    "worn the same outfit two days in a row.",
                    "fallen asleep during a date.",
                    "dyed my hair a crazy color.",
                    "cried over spilled milk (literally).",
                    "gone skinny dipping.",
                    "forgotten someone's name right after they told me.",
                    "broken something valuable and tried to hide it.",
                    "been on a cruise ship."
                ],
                pack2: [
                    "eaten food that fell on the floor.",
                    "regretted a purchase over $100 immediately.",
                    "left the country without telling anyone.",
                    "tried to cut my own hair.",
                    "taken a bubble bath since I was 10.",
                    "had a nightmare about work.",
                    "been caught singing in the car.",
                    "had a crush on a fictional character.",
                    "spent an entire paycheck in one day.",
                    "gotten a bad fortune cookie.",
                    "had to wear a terrible uniform.",
                    "been snow skiing.",
                    "lied about my age.",
                    "thought I saw a ghost.",
                    "read a book in one sitting.",
                    "had a terrible roommate.",
                    "pulled an all-nighter for fun.",
                    "tried a social media trend.",
                    "worn sunglasses indoors.",
                    "tried to learn a foreign language and quit."
                ],
                pack3: [
                    "been banned from a website.",
                    "gone viral on social media.",
                    "had a near-death experience.",
                    "flown first class.",
                    "used a fake ID.",
                    "won a contest.",
                    "eaten something exotic (e.g., bugs).",
                    "taken a spontaneous road trip.",
                    "spent a night sleeping under the stars.",
                    "had a fight with a stranger.",
                    "danced on a table.",
                    "broken a bone.",
                    "had a pet snake.",
                    "been scuba diving.",
                    "been recognized by someone famous.",
                    "crashed a party.",
                    "witnessed something paranormal.",
                    "made up an excuse to skip a family event.",
                    "gotten a tattoo I regret.",
                    "sent a risky email or text."
                ]
            },
            personal: {
                pack1: [
                    "questioned my career path this past month.",
                    "felt like I didn't belong in a group.",
                    "cried in front of my boss.",
                    "lied to protect someone else's feelings.",
                    "held a grudge for more than a year.",
                    "kept a secret from my partner.",
                    "been genuinely surprised by my partner's generosity.",
                    "dreamed about quitting my job and traveling.",
                    "made a big purchase purely out of impulse.",
                    "felt deeply insecure about my appearance.",
                    "wished I had handled a past relationship differently.",
                    "helped a stranger anonymously.",
                    "voted in every election since I was eligible.",
                    "felt a strong spiritual connection.",
                    "feared getting old.",
                    "been jealous of my partner's friends.",
                    "thought about moving to a different continent.",
                    "started a big project and never finished it.",
                    "regretted saying 'I love you' too soon.",
                    "changed a core belief I had since childhood."
                ],
                pack2: [
                    "cried while watching a cartoon.",
                    "wished I were better at managing money.",
                    "made a huge life decision without asking for advice.",
                    "felt proud of myself this week.",
                    "been told I talk too much.",
                    "worried about money in the last week.",
                    "apologized when I wasn't wrong, just to keep the peace.",
                    "felt true fear of failure.",
                    "kept a serious mistake secret from my family.",
                    "made a donation to a charity this year.",
                    "had an intense argument with a loved one.",
                    "struggled with my body image.",
                    "felt truly isolated, even when surrounded by people.",
                    "used alcohol to cope with stress.",
                    "had a complicated relationship with a family member.",
                    "had a childhood dream come true.",
                    "sacrificed my happiness for someone else's.",
                    "broken a promise to myself.",
                    "tried therapy or counseling.",
                    "helped a rival or competitor."
                ],
                pack3: [
                    "felt undervalued by someone I love.",
                    "been envious of my partner's success.",
                    "lied about being busy to avoid someone.",
                    "spent time thinking about my own funeral.",
                    "been misunderstood in a relationship.",
                    "thought about having an open relationship.",
                    "been judged unfairly based on my looks.",
                    "had a breakdown in public.",
                    "given up on a major life goal.",
                    "had a secret crush on someone I shouldn't.",
                    "been a victim of bullying.",
                    "thought about quitting social media permanently.",
                    "forgiven someone who didn't deserve it.",
                    "taken full responsibility for something that wasn't my fault.",
                    "been afraid of true intimacy.",
                    "made a major sacrifice for my partner.",
                    "believed in a conspiracy theory.",
                    "had a friend betray my trust.",
                    "felt immense gratitude for my partner.",
                    "written a letter that I never sent."
                ]
            },
            spicy: {
                pack1: [
                    "flirted with a co-worker.",
                    "had a one-night stand.",
                    "lied about my number of past partners.",
                    "hooked up in public.",
                    "faked a reason to leave a date early.",
                    "read my partner's private messages without permission.",
                    "had a secret admirer.",
                    "kissed someone the first night I met them.",
                    "used sex to get something I wanted.",
                    "had a crush on a friend's sibling.",
                    "broken up with someone over text.",
                    "sent a risky photo or video.",
                    "had a dream about cheating.",
                    "been sexually propositioned by a stranger.",
                    "kissed a partner just to shut them up.",
                    "felt jealous of my partner's past.",
                    "thought about experimenting with my sexuality.",
                    "been nude in public (not skinny dipping).",
                    "had a partner cry during sex.",
                    "dated two people at the same time."
                ],
                pack2: [
                    "faked an orgasm.",
                    "kissed someone in front of my current partner just to make a point.",
                    "used a dating app while in a committed relationship.",
                    "had a sexual fantasy involving someone famous.",
                    "hooked up with a boss or subordinate.",
                    "lied to a partner about where I was going.",
                    "had an accidental wardrobe malfunction in public.",
                    "given someone a gift I knew they would hate.",
                    "been turned on by a romantic comedy.",
                    "had a partner who was significantly older or younger.",
                    "flirted with a service professional (waiter, bartender).",
                    "made a suggestive joke to a stranger.",
                    "had sex in a place I regretted immediately.",
                    "thought about marrying someone for money.",
                    "had a partner whose parent hated me.",
                    "broken up with someone right before a major holiday.",
                    "secretly wished a date would end faster.",
                    "gotten back together with an ex more than once.",
                    "had a friend try to sabotage my relationship.",
                    "cheated on a test using my phone."
                ],
                pack3: [
                    "used a safe word outside of intimacy.",
                    "been caught making out.",
                    "had sex on a beach.",
                    "sent a very drunk text to an ex.",
                    "kissed someone with terrible breath.",
                    "been sexually rejected.",
                    "had a partner get caught cheating.",
                    "had sex in a vehicle.",
                    "been attracted to a friend of my partner.",
                    "had a partner who was terrible in bed.",
                    "had a three-way.",
                    "used my looks to get out of trouble.",
                    "thought my current partner was cheating.",
                    "been asked to keep a relationship secret.",
                    "had a fight that almost ended my relationship.",
                    "been naked outside in the winter.",
                    "had a partner who was secretly rich.",
                    "been caught masturbating.",
                    "hooked up in a public bathroom.",
                    "used my partner's toothbrush without telling them."
                ]
            }
        };

        // --- CORE GAME FUNCTIONS ---

        function init() {
            document.getElementById('categorySelection').style.display = 'block';
        }

        function showPacks(categoryId) {
            currentCategory = categoryId;
            document.getElementById('categorySelection').classList.add('hidden');
            document.getElementById('packSelection').classList.remove('hidden');
            
            document.getElementById('packCategoryTitle').textContent = categoryTitles[categoryId];
            
            const packsGrid = document.getElementById('packsGrid');
            packsGrid.innerHTML = '';
            
            const categoryPacks = nhiePrompts[categoryId];
            let packIndex = 1;

            // Iterate through every pack ID in the category
            for (const packId in categoryPacks) {
                if (categoryPacks.hasOwnProperty(packId) && categoryPacks[packId].length > 0) {
                    const promptsCount = categoryPacks[packId].length;
                    
                    const packCard = `
                        <div class="pack-card" onclick="selectPack('${packId}')">
                            <div class="pack-number">${packIndex}</div>
                            <h3>PACK ${packIndex}</h3>
                            <p class="pack-questions">${promptsCount} PROMPTS</p>
                        </div>
                    `;
                    packsGrid.innerHTML += packCard;
                    packIndex++;
                }
            }
        }

        function selectPack(packId) {
            currentPack = packId;
            currentPrompts = nhiePrompts[currentCategory][packId];
            
            if (currentPrompts.length === 0) {
                 alert(`Selected pack is empty. Please choose an active pack.`);
                 return;
            }

            currentPromptIndex = 0;
            currentPlayer = 1; // Always reset to P1 reading
            
            document.getElementById('packSelection').classList.add('hidden');
            document.getElementById('gameScreen').style.display = 'block';
            
            updateDisplay();
            showTurnCard(); // Start with the turn card
        }

        function updateDisplay() {
            const totalPrompts = currentPrompts.length;
            const promptsPlayed = currentPromptIndex + 1;
            const progress = (promptsPlayed / totalPrompts) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('promptCounter').textContent = `PROMPT ${promptsPlayed} OF ${totalPrompts}`;
            
            // --- Update Turn Card Info ---
            document.getElementById('turnPlayer').textContent = `PASS TO PLAYER ${currentPlayer}`;
            document.getElementById('turnInstruction').textContent = `Player ${currentPlayer}, read the prompt on the next card out loud to both players.`;
            
            // --- Update Prompt Card Info ---
            document.getElementById('promptText').textContent = "Never have I ever " + currentPrompts[currentPromptIndex] + ".";
            
            // Disable previous button if at the start
            document.getElementById('prevBtn').disabled = currentPromptIndex === 0;
            document.getElementById('nextBtn').textContent = currentPromptIndex === totalPrompts - 1 ? 'FINISH' : 'NEXT ‚Üí';
        }
        
        function showPromptCard() {
             // Hide the turn card, show the prompt card
            document.getElementById('turnCard').style.display = 'none';
            document.getElementById('promptCard').style.display = 'flex';
        }
        
        function showTurnCard() {
             // Show the turn card, hide the prompt card
            document.getElementById('turnCard').style.display = 'flex';
            document.getElementById('promptCard').style.display = 'none';
        }

        function nextPrompt() {
            // Logic only runs when the prompt card is showing (meaning prompt was read)
            if (document.getElementById('promptCard').style.display === 'flex') {
                if (currentPromptIndex === currentPrompts.length - 1) {
                    showEndScreen();
                } else {
                    currentPromptIndex++;
                    // Swap player turn for the next prompt (1 -> 2, 2 -> 1)
                    currentPlayer = currentPlayer === 1 ? 2 : 1; 
                    updateDisplay();
                    showTurnCard(); // Go back to the turn pass card
                }
            } else {
                 // If on the turn card, clicking next means they haven't read the prompt yet
                 alert("Please click 'SHOW PROMPT' first so both players can answer!");
            }
        }

        function previousPrompt() {
            if (currentPromptIndex > 0) {
                currentPromptIndex--;
                // Restore the player who *read* the last prompt (opposite of the new current player)
                currentPlayer = currentPlayer === 1 ? 2 : 1; 
                updateDisplay();
                showTurnCard(); // Go back to the turn pass card
            }
        }

        // --- BACK/QUIT FUNCTIONS ---
        
        function backToCategories() {
            document.getElementById('packSelection').classList.add('hidden');
            document.getElementById('categorySelection').classList.remove('hidden');
        }

        function quitToPacks() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('packSelection').classList.remove('hidden');
            currentPromptIndex = 0;
        }

        function showEndScreen() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('endScreen').style.display = 'block';
        }

        function backToPackSelection() {
            document.getElementById('endScreen').style.display = 'none';
            document.getElementById('packSelection').classList.remove('hidden');
            currentPromptIndex = 0;
        }

        function backToGames() {
            window.location.href = 'date-night.html';
        }

        // --- KEYBOARD NAVIGATION (Right arrow reveals, then advances) ---
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('gameScreen').style.display === 'block') {
                if (e.key === 'ArrowRight') {
                    if (document.getElementById('turnCard').style.display !== 'none') {
                        showPromptCard(); // Reveal prompt
                    } else {
                        nextPrompt(); // Advance to next turn pass card
                    }
                } else if (e.key === 'ArrowLeft' && currentPromptIndex > 0) {
                    previousPrompt();
                }
            }
        });

        window.onload = init;
    </script>
</body>
</html>
