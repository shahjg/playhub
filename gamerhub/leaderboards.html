<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    
    <title>Leaderboards ‚Äì Top Scores & Global Rankings | TheGaming.co</title>
    <meta name="description" content="Compete for glory on global leaderboards. Reaction Time, Typing Speed, Aim Trainer, Connections & more. See the world's fastest players and claim your rank.">
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="https://thegaming.co/leaderboards.html">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Leaderboards ‚Äì Global Rankings | TheGaming.co">
    <meta property="og:description" content="Compete for glory. See the world's fastest players and claim your rank.">
    <meta property="og:url" content="https://thegaming.co/leaderboards.html">
    <meta property="og:site_name" content="TheGaming.co">

    <meta name="theme-color" content="#0a0a0f">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --gold:#ffd700;--gold-dark:#c9a800;--gold-dim:#a08600;--gold-glow:rgba(255,215,0,0.3);
            --silver:#a8b4c0;--bronze:#cd7f32;
            --pink:#ff6b9d;--blue:#4facfe;--purple:#a855f7;--teal:#00d9a5;
            --dark:#08080c;--dark-card:#0c0c12;
            --text-light:#ffffff;--text-muted:rgba(255,255,255,0.45);
        }
        body{font-family:'Inter',sans-serif;background:var(--dark);color:var(--text-light);overflow-x:hidden;min-height:100vh;min-height:100dvh;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
        h1,h2,h3,h4{font-family:'Bebas Neue',sans-serif;letter-spacing:1px}
        a{color:inherit;text-decoration:none}
        input,textarea,select,button{font-size:16px}

        /* ========== BACKGROUND ========== */
        .page-bg{
            position:fixed;inset:0;
            background:
                radial-gradient(ellipse 120% 60% at 50% -10%,rgba(255,215,0,0.12) 0%,transparent 50%),
                radial-gradient(ellipse 80% 50% at 20% 50%,rgba(255,215,0,0.04) 0%,transparent 50%),
                radial-gradient(ellipse 80% 50% at 80% 80%,rgba(255,215,0,0.03) 0%,transparent 50%),
                linear-gradient(180deg,#0a0a10 0%,#08080c 100%);
            pointer-events:none;z-index:0;
        }

        .particles{position:fixed;inset:0;overflow:hidden;pointer-events:none;z-index:1}
        .particle{position:absolute;width:2px;height:2px;background:var(--gold);border-radius:50%;opacity:0.4;animation:drift 20s infinite linear}
        .particle:nth-child(1){left:5%;top:10%;animation-delay:0s;animation-duration:18s}
        .particle:nth-child(2){left:15%;top:60%;animation-delay:-3s;animation-duration:22s;width:3px;height:3px}
        .particle:nth-child(3){left:28%;top:30%;animation-delay:-6s;animation-duration:19s}
        .particle:nth-child(4){left:45%;top:80%;animation-delay:-2s;animation-duration:24s;width:1px;height:1px}
        .particle:nth-child(5){left:60%;top:20%;animation-delay:-8s;animation-duration:21s}
        .particle:nth-child(6){left:75%;top:50%;animation-delay:-4s;animation-duration:17s;width:3px;height:3px}
        .particle:nth-child(7){left:88%;top:70%;animation-delay:-10s;animation-duration:23s}
        .particle:nth-child(8){left:95%;top:15%;animation-delay:-5s;animation-duration:20s}
        @keyframes drift{0%{transform:translateY(0) translateX(0);opacity:0}10%{opacity:0.5}90%{opacity:0.5}100%{transform:translateY(-100vh) translateX(20px);opacity:0}}

        /* ========== HEADER ========== */
        header{
            position:fixed;top:0;left:0;right:0;z-index:100;
            height:60px;display:flex;align-items:center;
            padding:0 max(18px,env(safe-area-inset-left)) 0 max(18px,env(safe-area-inset-right));
            background:rgba(8,8,12,0.92);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
            border-bottom:1px solid rgba(255,215,0,0.08);
        }
        .nav-inner{width:100%;max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:24px}
        .nav-left{justify-self:flex-start}
        .nav-right-wrapper{justify-self:flex-end;display:flex;justify-content:flex-end}
        .header-logo{font-family:'Bebas Neue',sans-serif;font-size:1.6rem;letter-spacing:4px;color:white;position:relative;white-space:nowrap;justify-self:center}
        .header-logo::after{content:'';position:absolute;bottom:-2px;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--pink),var(--blue),var(--purple))}
        .header-actions{display:flex;align-items:center;gap:16px}
        .nav-right-logged-out,.nav-right-logged-in{display:none!important}
        .auth-link{font-size:0.85rem;font-weight:600;color:rgba(255,255,255,0.75);letter-spacing:0.08em;text-transform:uppercase;transition:color 0.2s;height:36px;display:inline-flex;align-items:center}
        .auth-link:hover{color:#fff}

        /* User Pill */
        .user-menu-wrapper{position:relative}
        .user-pill{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--pink),var(--purple));cursor:pointer;transition:transform 0.15s,box-shadow 0.15s;color:#fff;border:none}
        .user-pill:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(255,107,157,0.4)}
        .user-pill-label{font-family:'Inter',sans-serif;font-size:0.9rem;font-weight:700;color:#fff;text-transform:uppercase}
        .user-pill-skeleton{width:36px;height:36px;border-radius:50%;background:linear-gradient(90deg,rgba(255,255,255,0.04) 0%,rgba(255,255,255,0.08) 50%,rgba(255,255,255,0.04) 100%);background-size:200% 100%;animation:shimmer 1.5s infinite}
        @keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
        .user-menu{position:absolute;top:calc(100% + 8px);right:0;min-width:170px;padding:6px;border-radius:14px;background:rgba(10,10,15,0.97);border:1px solid rgba(255,255,255,0.14);box-shadow:0 18px 55px rgba(0,0,0,0.8);opacity:0;transform:translateY(-4px);pointer-events:none;transition:opacity 0.15s,transform 0.15s;backdrop-filter:blur(10px);z-index:120}
        .user-menu.open{opacity:1;transform:translateY(0);pointer-events:auto}
        .user-menu-item{width:100%;display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:9px;font-size:0.85rem;color:rgba(255,255,255,0.9);background:none;border:none;text-align:left;cursor:pointer;font-family:'Inter',sans-serif}
        .user-menu-item:hover{background:rgba(255,255,255,0.08)}

        /* ========== CONTENT ========== */
        .page-content{position:relative;z-index:2;min-height:100vh;min-height:100dvh;display:flex;flex-direction:column}

        /* ========== HERO ========== */
        .hero{padding:130px 20px 40px;padding-top:calc(130px + env(safe-area-inset-top));text-align:center}
        .hero-content{max-width:600px;margin:0 auto}
        .trophy-icon{width:70px;height:70px;margin:0 auto 20px;position:relative}
        .trophy-icon svg{width:100%;height:100%;filter:drop-shadow(0 0 30px var(--gold-glow));animation:trophyPulse 3s ease-in-out infinite}
        @keyframes trophyPulse{0%,100%{transform:scale(1);filter:drop-shadow(0 0 25px rgba(255,215,0,0.3))}50%{transform:scale(1.05);filter:drop-shadow(0 0 40px rgba(255,215,0,0.5))}}
        .hero-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(3rem,10vw,5rem);letter-spacing:8px;line-height:1;margin-bottom:12px;background:linear-gradient(180deg,#ffffff 20%,var(--gold) 80%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .hero-subtitle{font-size:1rem;color:rgba(255,215,0,0.5);letter-spacing:3px;text-transform:uppercase}

        /* ========== MAIN ========== */
        main{flex:1;padding:16px 20px 80px;padding-left:max(20px,env(safe-area-inset-left));padding-right:max(20px,env(safe-area-inset-right));padding-bottom:max(80px,calc(60px + env(safe-area-inset-bottom)))}
        .container{max-width:800px;margin:0 auto}

        /* ========== GAME CATEGORIES ========== */
        .game-categories{display:flex;justify-content:center;gap:8px;margin-bottom:12px;flex-wrap:wrap}
        .cat-btn{padding:8px 14px;border-radius:20px;background:rgba(255,215,0,0.03);border:1px solid rgba(255,215,0,0.1);font-size:0.72rem;font-weight:700;color:rgba(255,255,255,0.5);cursor:pointer;transition:all 0.25s;text-transform:uppercase;letter-spacing:0.5px}
        .cat-btn:hover{color:var(--gold);border-color:rgba(255,215,0,0.25)}
        .cat-btn.active{background:linear-gradient(135deg,rgba(255,215,0,0.15) 0%,rgba(255,215,0,0.05) 100%);border-color:var(--gold);color:var(--gold);box-shadow:0 0 20px rgba(255,215,0,0.12)}

        /* ========== GAME SELECTOR ========== */
        .game-selector{display:flex;justify-content:center;flex-wrap:wrap;gap:6px;margin-bottom:12px}
        .game-btn{padding:9px 13px;border-radius:8px;background:rgba(255,215,0,0.02);border:1px solid rgba(255,215,0,0.08);font-size:0.75rem;font-weight:600;color:rgba(255,255,255,0.4);cursor:pointer;transition:all 0.25s;white-space:nowrap}
        .game-btn:hover{color:var(--gold);border-color:rgba(255,215,0,0.2);background:rgba(255,215,0,0.06)}
        .game-btn.active{background:linear-gradient(135deg,rgba(255,215,0,0.15) 0%,rgba(255,215,0,0.06) 100%);border-color:var(--gold);color:var(--gold);box-shadow:0 0 20px rgba(255,215,0,0.15)}
        .game-btn.featured{border-color:rgba(168,85,247,0.4);background:linear-gradient(135deg,rgba(168,85,247,0.1) 0%,rgba(255,107,157,0.05) 100%)}
        .game-btn.featured.active{border-color:var(--purple);box-shadow:0 0 20px rgba(168,85,247,0.2)}

        /* ========== VARIANT FILTERS ========== */
        .variant-filter{display:none;justify-content:center;gap:6px;margin-bottom:16px}
        .variant-filter.show{display:flex}
        .variant-btn{padding:7px 12px;border-radius:6px;background:rgba(255,215,0,0.02);border:1px solid rgba(255,215,0,0.08);font-size:0.7rem;font-weight:700;color:rgba(255,255,255,0.4);cursor:pointer;transition:all 0.25s}
        .variant-btn:hover{color:var(--gold);border-color:rgba(255,215,0,0.2)}
        .variant-btn.active{background:rgba(255,215,0,0.1);border-color:var(--gold-dim);color:var(--gold)}

        /* ========== LEADERBOARD PANEL ========== */
        .leaderboard-panel{background:rgba(12,12,18,0.6);border-radius:20px;overflow:hidden;border:1px solid rgba(255,215,0,0.1);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:0 0 80px rgba(255,215,0,0.03),0 30px 60px rgba(0,0,0,0.4)}
        .panel-header{display:flex;align-items:center;justify-content:space-between;padding:18px 20px;border-bottom:1px solid rgba(255,215,0,0.08);flex-wrap:wrap;gap:12px;background:linear-gradient(180deg,rgba(255,215,0,0.04) 0%,transparent 100%)}
        .panel-title{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
        .panel-title h2{font-size:1.2rem;letter-spacing:3px;color:white}
        .panel-badge{padding:4px 10px;background:rgba(255,215,0,0.08);border:1px solid rgba(255,215,0,0.15);border-radius:6px;font-size:0.62rem;font-weight:700;color:var(--gold);text-transform:uppercase;letter-spacing:1px}
        .panel-tabs{display:flex;gap:3px;background:rgba(0,0,0,0.3);padding:3px;border-radius:8px}
        .panel-tab{padding:7px 12px;border-radius:5px;font-size:0.7rem;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;cursor:pointer;color:rgba(255,255,255,0.4);background:transparent;border:none;transition:all 0.25s;white-space:nowrap}
        .panel-tab:hover{color:white}
        .panel-tab.active{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:var(--dark);box-shadow:0 4px 15px rgba(255,215,0,0.25)}
        .panel-tab.friends{color:rgba(168,85,247,0.7)}
        .panel-tab.friends:hover{color:var(--purple)}
        .panel-tab.friends.active{background:linear-gradient(135deg,var(--purple),var(--pink));color:white}
        .panel-body{padding:20px}

        /* ========== PODIUM ========== */
        .podium{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:16px;align-items:end}
        .podium-spot{text-align:center;padding:16px 8px;border-radius:14px;position:relative;transition:transform 0.3s}
        .podium-spot:hover{transform:translateY(-4px)}
        .podium-spot.gold{background:linear-gradient(180deg,rgba(255,215,0,0.12) 0%,rgba(255,215,0,0.02) 100%);border:2px solid var(--gold);order:2;padding-top:24px;padding-bottom:24px;min-height:165px;box-shadow:0 0 50px rgba(255,215,0,0.12),inset 0 1px 0 rgba(255,255,255,0.05);animation:goldPulse 4s ease-in-out infinite}
        @keyframes goldPulse{0%,100%{box-shadow:0 0 40px rgba(255,215,0,0.1)}50%{box-shadow:0 0 60px rgba(255,215,0,0.2)}}
        .podium-spot.silver{background:linear-gradient(180deg,rgba(168,180,192,0.1) 0%,rgba(168,180,192,0.02) 100%);border:2px solid var(--silver);order:1;min-height:140px}
        .podium-spot.bronze{background:linear-gradient(180deg,rgba(205,127,50,0.1) 0%,rgba(205,127,50,0.02) 100%);border:2px solid var(--bronze);order:3;min-height:120px}
        .podium-rank{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;line-height:1;margin-bottom:4px}
        .podium-spot.gold .podium-rank{color:var(--gold);font-size:2.2rem;text-shadow:0 0 20px var(--gold-glow)}
        .podium-spot.silver .podium-rank{color:var(--silver)}
        .podium-spot.bronze .podium-rank{color:var(--bronze)}
        .podium-label{font-size:0.48rem;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;margin-bottom:8px}
        .podium-spot.gold .podium-label{color:var(--gold)}
        .podium-spot.silver .podium-label{color:var(--silver)}
        .podium-spot.bronze .podium-label{color:var(--bronze)}
        .podium-avatar{width:36px;height:36px;border-radius:50%;margin:0 auto 6px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.85rem;text-transform:uppercase}
        .podium-spot.gold .podium-avatar{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:var(--dark);width:42px;height:42px;font-size:1rem;box-shadow:0 4px 15px rgba(255,215,0,0.3)}
        .podium-spot.silver .podium-avatar{background:linear-gradient(135deg,var(--silver),#8a9aa8);color:var(--dark)}
        .podium-spot.bronze .podium-avatar{background:linear-gradient(135deg,var(--bronze),#a56528);color:white}
        .podium-name{font-weight:700;font-size:0.78rem;color:white;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:0 4px}
        .podium-spot.gold .podium-name{font-size:0.88rem}
        .podium-score{font-family:'Bebas Neue',sans-serif;font-size:1.05rem;letter-spacing:1px}
        .podium-spot.gold .podium-score{color:var(--gold);font-size:1.25rem}
        .podium-spot.silver .podium-score{color:var(--silver)}
        .podium-spot.bronze .podium-score{color:var(--bronze)}

        /* ========== LIST ========== */
        .lb-list{display:flex;flex-direction:column;gap:5px}
        .lb-row{display:grid;grid-template-columns:32px 32px 1fr auto;align-items:center;gap:10px;padding:10px 12px;background:rgba(255,215,0,0.015);border-radius:10px;transition:all 0.25s;border:1px solid transparent}
        .lb-row:hover{background:rgba(255,215,0,0.04);border-color:rgba(255,215,0,0.08);transform:translateX(4px)}
        .lb-row.you{background:linear-gradient(90deg,rgba(168,85,247,0.1) 0%,rgba(168,85,247,0.02) 100%);border:1px solid rgba(168,85,247,0.3)}
        .lb-row.you:hover{border-color:rgba(168,85,247,0.5)}
        .lb-rank{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:rgba(255,215,0,0.4);text-align:center}
        .lb-avatar{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--pink),var(--purple));display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:700;color:white;text-transform:uppercase}
        .lb-player{display:flex;flex-direction:column;min-width:0}
        .lb-name{font-weight:600;font-size:0.8rem;color:white;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .lb-you-badge{font-size:0.6rem;color:var(--purple);font-weight:700;text-transform:uppercase;letter-spacing:0.5px}
        .lb-date{font-size:0.65rem;color:var(--text-muted)}
        .lb-score{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:var(--gold);letter-spacing:1px}
        .lb-empty{text-align:center;padding:40px 20px;color:var(--text-muted);font-size:0.85rem}
        .lb-empty-icon{font-size:2.5rem;margin-bottom:12px;opacity:0.5}

        /* ========== FRIENDS EMPTY STATE ========== */
        .friends-empty{text-align:center;padding:50px 20px}
        .friends-empty-icon{font-size:3rem;margin-bottom:16px}
        .friends-empty h4{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;letter-spacing:2px;margin-bottom:8px;color:white}
        .friends-empty p{color:var(--text-muted);font-size:0.88rem;margin-bottom:20px;max-width:280px;margin-left:auto;margin-right:auto;line-height:1.5}
        .friends-empty .btn{display:inline-flex;align-items:center;gap:8px}

        /* ========== LOGIN GATE ========== */
        .lb-login-gate{text-align:center;padding:50px 20px;position:relative}
        .lb-login-gate::before{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:250px;height:250px;background:radial-gradient(circle,rgba(255,215,0,0.06) 0%,transparent 70%);pointer-events:none}
        .lb-login-title{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;letter-spacing:3px;background:linear-gradient(135deg,#ffffff 0%,var(--gold) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px}
        .lb-login-desc{color:var(--text-muted);font-size:0.88rem;max-width:280px;margin:0 auto 18px;line-height:1.5}
        .btn{padding:11px 24px;border-radius:8px;border:none;font-weight:700;font-size:0.82rem;cursor:pointer;text-transform:uppercase;letter-spacing:1px;font-family:'Inter',sans-serif;display:inline-block;transition:all 0.3s}
        .btn-gold{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:var(--dark);box-shadow:0 6px 25px rgba(255,215,0,0.25)}
        .btn-gold:hover{transform:translateY(-2px);box-shadow:0 10px 35px rgba(255,215,0,0.35)}
        .btn-purple{background:linear-gradient(135deg,var(--purple),var(--pink));color:white;box-shadow:0 6px 25px rgba(168,85,247,0.25)}
        .btn-purple:hover{transform:translateY(-2px);box-shadow:0 10px 35px rgba(168,85,247,0.35)}
        .lb-login-subtext{margin-top:12px;font-size:0.75rem;color:var(--text-muted)}
        .lb-login-subtext a{color:var(--gold);font-weight:600}

        /* ========== PLAY CTA ========== */
        .play-cta{margin-top:20px;text-align:center}
        .play-cta a{display:inline-flex;align-items:center;gap:10px;padding:11px 26px;border-radius:50px;background:rgba(255,215,0,0.05);border:1px solid rgba(255,215,0,0.2);color:var(--gold);font-weight:700;font-size:0.82rem;text-transform:uppercase;letter-spacing:1px;transition:all 0.3s}
        .play-cta a:hover{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:var(--dark);border-color:transparent;transform:translateY(-2px);box-shadow:0 8px 30px rgba(255,215,0,0.25)}
        .play-cta a svg{width:14px;height:14px;fill:currentColor}

        /* ========== FOOTER ========== */
        footer{background:#050508;margin-top:auto;position:relative;z-index:2}
        .footer-border{height:1px;background:linear-gradient(90deg,transparent,rgba(255,215,0,0.3),transparent)}
        .footer-main{max-width:1100px;margin:0 auto;padding:35px 20px 20px;padding-left:max(20px,env(safe-area-inset-left));padding-right:max(20px,env(safe-area-inset-right));padding-bottom:max(20px,env(safe-area-inset-bottom))}
        .footer-links{display:grid;grid-template-columns:repeat(3,1fr);gap:30px;margin-bottom:25px;max-width:450px;margin-left:auto;margin-right:auto}
        .footer-column{text-align:center}
        .footer-column h5{font-family:'Bebas Neue',sans-serif;font-size:0.8rem;letter-spacing:2px;margin-bottom:10px;color:rgba(255,215,0,0.7)}
        .footer-column ul{list-style:none;display:flex;flex-direction:column;gap:6px}
        .footer-column a{color:rgba(255,255,255,0.35);font-size:0.78rem;transition:color 0.2s}
        .footer-column a:hover{color:var(--gold)}
        .footer-bottom{padding-top:18px;border-top:1px solid rgba(255,215,0,0.06);text-align:center}
        .footer-copyright{font-size:0.75rem;color:rgba(255,255,255,0.25)}

        /* ========== RESPONSIVE ========== */
        @media(max-width:700px){
            header{height:56px;padding:0 14px;padding-left:max(14px,env(safe-area-inset-left));padding-right:max(14px,env(safe-area-inset-right))}
            .header-logo{font-size:1.4rem;letter-spacing:3px}
            .hero{padding:100px 20px 30px;padding-top:calc(100px + env(safe-area-inset-top))}
            .trophy-icon{width:55px;height:55px}
            .hero-title{font-size:2.8rem;letter-spacing:5px}
            .hero-subtitle{font-size:0.85rem;letter-spacing:2px}
            main{padding:12px 14px 60px}
            .game-categories{gap:6px}
            .cat-btn{padding:6px 10px;font-size:0.68rem}
            .game-selector{gap:4px}
            .game-btn{padding:7px 10px;font-size:0.68rem}
            .variant-btn{padding:5px 9px;font-size:0.65rem}
            .leaderboard-panel{border-radius:14px}
            .panel-header{padding:14px;flex-direction:column;align-items:flex-start}
            .panel-title h2{font-size:1rem}
            .panel-badge{font-size:0.58rem;padding:3px 8px}
            .panel-tabs{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}
            .panel-tab{flex:1;text-align:center;padding:7px 8px;font-size:0.65rem}
            .panel-body{padding:14px}
            .podium{gap:5px}
            .podium-spot{padding:10px 5px;border-radius:10px}
            .podium-spot.gold{padding-top:14px;padding-bottom:14px;min-height:135px}
            .podium-spot.silver{min-height:115px}
            .podium-spot.bronze{min-height:100px}
            .podium-rank{font-size:1.4rem}
            .podium-spot.gold .podium-rank{font-size:1.7rem}
            .podium-label{font-size:0.42rem}
            .podium-avatar{width:30px;height:30px;font-size:0.75rem}
            .podium-spot.gold .podium-avatar{width:36px;height:36px;font-size:0.9rem}
            .podium-name{font-size:0.68rem}
            .podium-spot.gold .podium-name{font-size:0.75rem}
            .podium-score{font-size:0.9rem}
            .podium-spot.gold .podium-score{font-size:1.05rem}
            .lb-row{padding:8px 10px;gap:8px;grid-template-columns:28px 28px 1fr auto}
            .lb-rank{font-size:0.9rem}
            .lb-avatar{width:24px;height:24px;font-size:0.62rem}
            .lb-name{font-size:0.75rem}
            .lb-score{font-size:0.9rem}
            .footer-links{grid-template-columns:1fr;gap:18px}
        }

        @media(max-width:380px){
            .hero-title{font-size:2.4rem;letter-spacing:4px}
            .game-btn{padding:6px 8px;font-size:0.62rem}
            .panel-tab{padding:6px 6px;font-size:0.6rem}
            .podium-spot.gold{min-height:120px}
            .podium-spot.silver{min-height:105px}
            .podium-spot.bronze{min-height:92px}
        }

        @media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:0.01ms!important;animation-iteration-count:1!important;transition-duration:0.01ms!important}}
    </style>
</head>
<body>

    <div class="page-bg"></div>
    <div class="particles">
        <div class="particle"></div><div class="particle"></div><div class="particle"></div><div class="particle"></div>
        <div class="particle"></div><div class="particle"></div><div class="particle"></div><div class="particle"></div>
    </div>

    <div class="page-content">
        <header>
            <nav class="nav-inner">
                <div class="nav-left"></div>
                <a href="/" class="header-logo">THEGAMING.CO</a>
                <div class="nav-right-wrapper">
                    <div class="header-actions">
                        <div class="user-pill-skeleton" id="auth-skeleton"></div>
                        <div class="nav-right-logged-out">
                            <a href="/login.html" class="auth-link">Sign In</a>
                        </div>
                        <div class="nav-right-logged-in">
                            <div class="user-menu-wrapper">
                                <button class="user-pill" type="button" id="user-menu-button">
                                    <span class="user-pill-label" id="header-username-label">P</span>
                                </button>
                                <div class="user-menu" id="user-menu">
                                    <a href="/profile.html" class="user-menu-item">Profile</a>
                                    <a href="/leaderboards.html" class="user-menu-item">Leaderboards</a>
                                    <button type="button" class="user-menu-item" id="user-menu-signout">Sign Out</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <section class="hero">
            <div class="hero-content">
                <div class="trophy-icon">
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 8h24v4H20z" fill="#c9a800"/>
                        <path d="M18 12h28v20c0 8-6 14-14 14s-14-6-14-14V12z" fill="#ffd700" stroke="#c9a800" stroke-width="2"/>
                        <path d="M18 16H8c0 8 4 12 10 12v-12zM46 16h10c0 8-4 12-10 12v-12z" fill="#ffd700" stroke="#c9a800" stroke-width="2"/>
                        <rect x="26" y="46" width="12" height="6" fill="#c9a800"/>
                        <rect x="22" y="52" width="20" height="4" rx="1" fill="#ffd700" stroke="#c9a800" stroke-width="1"/>
                    </svg>
                </div>
                <h1 class="hero-title">LEADERBOARDS</h1>
                <p class="hero-subtitle">Compete globally. Prove you're the best.</p>
            </div>
        </section>

        <main>
            <div class="container">
                
                <!-- Game Categories -->
                <div class="game-categories">
                    <button class="cat-btn active" data-cat="solo">Solo Games</button>
                    <button class="cat-btn" data-cat="daily">Daily Challenge</button>
                </div>

                <!-- Solo Games -->
                <div class="game-selector" id="solo-games">
                    <button class="game-btn active" data-game="reaction-time">Reaction</button>
                    <button class="game-btn" data-game="typing-test">Typing</button>
                    <button class="game-btn" data-game="aim-trainer">Aim</button>
                    <button class="game-btn" data-game="chimp-test">Chimp</button>
                    <button class="game-btn" data-game="number-memory">Numbers</button>
                    <button class="game-btn" data-game="sequence-memory">Sequence</button>
                    <button class="game-btn" data-game="visual-memory">Visual</button>
                    <button class="game-btn" data-game="verbal-memory">Verbal</button>
                    <button class="game-btn" data-game="math-speed">Math</button>
                </div>

                <!-- Daily Games -->
                <div class="game-selector" id="daily-games" style="display:none">
                    <button class="game-btn featured active" data-game="connections">Connections</button>
                </div>

                <!-- Variant Filters -->
                <div class="variant-filter" id="duration-filter">
                    <button class="variant-btn" data-duration="15">15s</button>
                    <button class="variant-btn" data-duration="30">30s</button>
                    <button class="variant-btn active" data-duration="60">60s</button>
                    <button class="variant-btn" data-duration="120">2m</button>
                </div>

                <div class="variant-filter" id="target-filter">
                    <button class="variant-btn" data-targets="15">15</button>
                    <button class="variant-btn active" data-targets="30">30</button>
                    <button class="variant-btn" data-targets="50">50</button>
                </div>

                <div class="variant-filter" id="operation-filter">
                    <button class="variant-btn active" data-op="add">+</button>
                    <button class="variant-btn" data-op="sub">‚àí</button>
                    <button class="variant-btn" data-op="mul">√ó</button>
                    <button class="variant-btn" data-op="div">√∑</button>
                </div>

                <div class="leaderboard-panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <h2>TOP PLAYERS</h2>
                            <span class="panel-badge" id="panel-badge">Reaction Time</span>
                        </div>
                        <div class="panel-tabs" id="panel-tabs">
                            <button class="panel-tab active" data-type="global">Global</button>
                            <button class="panel-tab" data-type="today">Today</button>
                            <button class="panel-tab" data-type="week">Week</button>
                            <button class="panel-tab friends" data-type="friends">Friends</button>
                        </div>
                    </div>

                    <div class="panel-body">
                        <div class="lb-login-gate" id="lb-login-gate" style="display:none">
                            <h3 class="lb-login-title">Sign In to View</h3>
                            <p class="lb-login-desc">Log in to see leaderboards, save scores, and compete globally.</p>
                            <a href="/login.html" class="btn btn-gold">Log In</a>
                            <p class="lb-login-subtext">No account? <a href="/login.html">Sign up free</a></p>
                        </div>

                        <div id="lb-content">
                            <div class="podium" id="podium">
                                <div class="podium-spot silver" id="podium-2">
                                    <div class="podium-rank">2</div>
                                    <div class="podium-label">Silver</div>
                                    <div class="podium-avatar">‚Äî</div>
                                    <div class="podium-name">‚Äî</div>
                                    <div class="podium-score">‚Äî</div>
                                </div>
                                <div class="podium-spot gold" id="podium-1">
                                    <div class="podium-rank">1</div>
                                    <div class="podium-label">Champion</div>
                                    <div class="podium-avatar">‚Äî</div>
                                    <div class="podium-name">‚Äî</div>
                                    <div class="podium-score">‚Äî</div>
                                </div>
                                <div class="podium-spot bronze" id="podium-3">
                                    <div class="podium-rank">3</div>
                                    <div class="podium-label">Bronze</div>
                                    <div class="podium-avatar">‚Äî</div>
                                    <div class="podium-name">‚Äî</div>
                                    <div class="podium-score">‚Äî</div>
                                </div>
                            </div>
                            <div class="lb-list" id="lb-list"></div>
                        </div>

                        <!-- Friends Empty State -->
                        <div class="friends-empty" id="friends-empty" style="display:none">
                            <div class="friends-empty-icon">üë•</div>
                            <h4>No Friends Yet</h4>
                            <p>Add friends to compare scores and see who's the best!</p>
                            <a href="/profile.html" class="btn btn-purple">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>
                                Find Friends
                            </a>
                        </div>
                    </div>
                </div>

                <div class="play-cta">
                    <a href="/games/solo/reaction-time.html" id="play-link">
                        <svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                        Play Now
                    </a>
                </div>

            </div>
        </main>

        <footer>
            <div class="footer-border"></div>
            <div class="footer-main">
                <div class="footer-links">
                    <div class="footer-column">
                        <h5>GAMES</h5>
                        <ul>
                            <li><a href="/solo.html">Solo</a></li>
                            <li><a href="/duos.html">Duos</a></li>
                            <li><a href="/squad-games.html">Squad</a></li>
                            <li><a href="/party-games.html">Party</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h5>COMMUNITY</h5>
                        <ul>
                            <li><a href="/leaderboards.html">Leaderboards</a></li>
                            <li><a href="/supporters.html">Hall of Champions</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h5>COMPANY</h5>
                        <ul>
                            <li><a href="/about.html">About</a></li>
                            <li><a href="mailto:hello@thegaming.co">Contact</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p class="footer-copyright">¬© 2025 TheGaming.co ‚Äî Free games, forever.</p>
                </div>
            </div>
        </footer>
    </div>

<script>
const SUPABASE_URL='https://tvvivtmzofsyehatzlvl.supabase.co';
const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR2dml2dG16b2ZzeWVoYXR6bHZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4OTExODYsImV4cCI6MjA4MDQ2NzE4Nn0.Qy8kHMO0Nb4yJ0ZHjby7RuQtzwWB8rUcZvkdnbL1b3M';
const supabaseClient=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

const GAMES={
    'reaction-time':{name:'Reaction Time',unit:'ms',ascending:true,playUrl:'/games/solo/reaction-time.html',table:'solo_scores'},
    'typing-test':{name:'Typing Test',unit:'WPM',ascending:false,playUrl:'/games/solo/typing-test.html',table:'solo_scores',hasDurations:true},
    'aim-trainer':{name:'Aim Trainer',unit:'TPM',ascending:false,playUrl:'/games/solo/aim-trainer.html',table:'solo_scores',hasTargets:true},
    'chimp-test':{name:'Chimp Test',unit:'Level',ascending:false,playUrl:'/games/solo/chimp-test.html',table:'solo_scores'},
    'number-memory':{name:'Number Memory',unit:'Digits',ascending:false,playUrl:'/games/solo/number-memory.html',table:'solo_scores'},
    'sequence-memory':{name:'Sequence Memory',unit:'Level',ascending:false,playUrl:'/games/solo/sequence-memory.html',table:'solo_scores'},
    'visual-memory':{name:'Visual Memory',unit:'Level',ascending:false,playUrl:'/games/solo/visual-memory.html',table:'solo_scores'},
    'verbal-memory':{name:'Verbal Memory',unit:'words',ascending:false,playUrl:'/games/solo/verbal-memory.html',table:'solo_scores'},
    'math-speed':{name:'Math Speed',unit:'solved',ascending:false,playUrl:'/games/solo/math-speed.html',table:'solo_scores',hasOperations:true},
    'connections':{name:'Connections',unit:'score',ascending:true,playUrl:'/connections.html',table:'daily_scores',isDaily:true}
};

const OP_LABELS={add:'+',sub:'‚àí',mul:'√ó',div:'√∑'};

let currentCat='solo';
let currentGame='reaction-time';
let currentDuration=60;
let currentTargets=30;
let currentOp='add';
let currentTab='global';
let isLoggedIn=false;
let currentUserId=null;
let friendIds=[];

// DOM
const authSkeleton=document.getElementById('auth-skeleton');
const loggedOutNav=document.querySelector('.nav-right-logged-out');
const loggedInNav=document.querySelector('.nav-right-logged-in');
const headerUsernameLabel=document.getElementById('header-username-label');
const userMenuButton=document.getElementById('user-menu-button');
const userMenu=document.getElementById('user-menu');
const userMenuSignOut=document.getElementById('user-menu-signout');

const catBtns=document.querySelectorAll('.cat-btn');
const soloGames=document.getElementById('solo-games');
const dailyGames=document.getElementById('daily-games');
const gameBtns=document.querySelectorAll('.game-btn');
const durationFilter=document.getElementById('duration-filter');
const durationBtns=durationFilter.querySelectorAll('.variant-btn');
const targetFilter=document.getElementById('target-filter');
const targetBtns=targetFilter.querySelectorAll('.variant-btn');
const operationFilter=document.getElementById('operation-filter');
const operationBtns=operationFilter.querySelectorAll('.variant-btn');
const panelBadge=document.getElementById('panel-badge');
const panelTabs=document.getElementById('panel-tabs');
const tabBtns=panelTabs.querySelectorAll('.panel-tab');
const lbLoginGate=document.getElementById('lb-login-gate');
const lbContent=document.getElementById('lb-content');
const lbList=document.getElementById('lb-list');
const friendsEmpty=document.getElementById('friends-empty');
const playLink=document.getElementById('play-link');
const podium=document.getElementById('podium');

// Auth
function updateAuthUI(user){
    if(authSkeleton)authSkeleton.style.display='none';
    if(user){
        loggedOutNav?.style.setProperty('display','none','important');
        loggedInNav?.style.setProperty('display','flex','important');
        isLoggedIn=true;
        currentUserId=user.id;
    }else{
        loggedOutNav?.style.setProperty('display','flex','important');
        loggedInNav?.style.setProperty('display','none','important');
        isLoggedIn=false;
        currentUserId=null;
    }
    updateLeaderboardVisibility();
}

async function loadSessionAndProfile(){
    const{data,error}=await supabaseClient.auth.getSession();
    if(error)return updateAuthUI(null);
    const user=data?.session?.user??null;
    updateAuthUI(user);
    if(!user)return;
    
    const{data:profile}=await supabaseClient.from('profiles').select('display_name,gamer_tag').eq('id',user.id).single();
    if(profile){
        const name=profile.display_name||profile.gamer_tag||user.email.split('@')[0];
        headerUsernameLabel.textContent=name.charAt(0).toUpperCase();
        headerUsernameLabel.title=name;
        try{
            localStorage.setItem('tgco_header_label',name.charAt(0).toUpperCase());
            localStorage.setItem('tgco_header_full',name);
        }catch(e){}
    }
    
    // Load friends
    await loadFriends();
}

async function loadFriends(){
    if(!currentUserId)return;
    try{
        // Try to get accepted friendships
        const{data:friends}=await supabaseClient.from('friendships')
            .select('user_id,friend_id')
            .or(`user_id.eq.${currentUserId},friend_id.eq.${currentUserId}`)
            .eq('status','accepted');
        
        if(friends&&friends.length>0){
            friendIds=friends.map(f=>f.user_id===currentUserId?f.friend_id:f.user_id);
        }
    }catch(e){
        // Friendships table might not exist yet
        friendIds=[];
    }
}

// Prime from cache
(function primeFromCache(){
    try{
        const cachedLabel=localStorage.getItem('tgco_header_label');
        if(cachedLabel){
            headerUsernameLabel.textContent=cachedLabel;
            if(authSkeleton)authSkeleton.style.display='none';
            if(loggedInNav)loggedInNav.style.setProperty('display','flex','important');
        }
    }catch(e){}
})();

loadSessionAndProfile();
supabaseClient.auth.onAuthStateChange((_event,session)=>{
    updateAuthUI(session?.user??null);
    if(session?.user)loadSessionAndProfile();
});

// User menu
let userMenuOpen=false;
userMenuButton?.addEventListener('click',e=>{e.stopPropagation();userMenuOpen=!userMenuOpen;userMenu.classList.toggle('open',userMenuOpen)});
document.addEventListener('click',()=>{userMenuOpen=false;userMenu?.classList.remove('open')});
userMenuSignOut?.addEventListener('click',async()=>{
    try{localStorage.removeItem('tgco_header_label');localStorage.removeItem('tgco_header_full')}catch(e){}
    await supabaseClient.auth.signOut();
    window.location.href='/';
});

// Category selection
catBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentCat=btn.dataset.cat;
        catBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        
        if(currentCat==='solo'){
            soloGames.style.display='flex';
            dailyGames.style.display='none';
            currentGame='reaction-time';
            soloGames.querySelector('[data-game="reaction-time"]').classList.add('active');
            dailyGames.querySelectorAll('.game-btn').forEach(b=>b.classList.remove('active'));
        }else{
            soloGames.style.display='none';
            dailyGames.style.display='flex';
            currentGame='connections';
            dailyGames.querySelector('[data-game="connections"]').classList.add('active');
            soloGames.querySelectorAll('.game-btn').forEach(b=>b.classList.remove('active'));
        }
        
        updateFiltersAndBadge();
        fetchLeaderboard();
    });
});

// Game selection
gameBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentGame=btn.dataset.game;
        gameBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        updateFiltersAndBadge();
        fetchLeaderboard();
    });
});

// Filters
durationBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentDuration=parseInt(btn.dataset.duration);
        durationBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        updateFiltersAndBadge();
        fetchLeaderboard();
    });
});

targetBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentTargets=parseInt(btn.dataset.targets);
        targetBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        updateFiltersAndBadge();
        fetchLeaderboard();
    });
});

operationBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentOp=btn.dataset.op;
        operationBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        updateFiltersAndBadge();
        fetchLeaderboard();
    });
});

// Tab selection
tabBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
        currentTab=btn.dataset.type;
        tabBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        fetchLeaderboard();
    });
});

function updateFiltersAndBadge(){
    const game=GAMES[currentGame];
    
    durationFilter.classList.toggle('show',!!game.hasDurations);
    targetFilter.classList.toggle('show',!!game.hasTargets);
    operationFilter.classList.toggle('show',!!game.hasOperations);
    
    let badge=game.name;
    if(game.hasDurations)badge+=` ‚Ä¢ ${currentDuration>=60?(currentDuration/60)+'m':currentDuration+'s'}`;
    if(game.hasTargets)badge+=` ‚Ä¢ ${currentTargets}`;
    if(game.hasOperations)badge+=` ‚Ä¢ ${OP_LABELS[currentOp]}`;
    panelBadge.textContent=badge;
    
    playLink.href=game.playUrl;
}

function updateLeaderboardVisibility(){
    if(isLoggedIn){
        panelTabs.style.display='flex';
        lbContent.style.display='block';
        lbLoginGate.style.display='none';
        friendsEmpty.style.display='none';
        fetchLeaderboard();
    }else{
        panelTabs.style.display='none';
        lbContent.style.display='none';
        lbLoginGate.style.display='block';
        friendsEmpty.style.display='none';
    }
}

function getGameId(){
    if(currentGame==='typing-test')return`typing-test-${currentDuration}`;
    if(currentGame==='aim-trainer')return`aim-trainer-${currentTargets}`;
    if(currentGame==='math-speed')return`math-speed-${currentOp}`;
    return currentGame;
}

function clearPodium(){
    [1,2,3].forEach(i=>{
        const spot=document.getElementById(`podium-${i}`);
        spot.querySelector('.podium-avatar').textContent='‚Äî';
        spot.querySelector('.podium-name').textContent='‚Äî';
        spot.querySelector('.podium-score').textContent='‚Äî';
    });
}

async function fetchLeaderboard(){
    if(!isLoggedIn)return;

    clearPodium();
    lbList.innerHTML='';
    podium.style.display='grid';
    friendsEmpty.style.display='none';

    const game=GAMES[currentGame];
    const gameId=getGameId();
    const table=game.table;
    
    // Friends tab special handling
    if(currentTab==='friends'){
        if(friendIds.length===0){
            podium.style.display='none';
            lbList.innerHTML='';
            friendsEmpty.style.display='block';
            return;
        }
    }

    let query;
    
    if(game.isDaily){
        // Daily scores table
        const scoreField=game.ascending?'score':'score';
        query=supabaseClient.from(table)
            .select('score,mistakes,time_seconds,puzzle_date,user_id')
            .eq('game_type',currentGame)
            .order('score',{ascending:game.ascending})
            .limit(50);
    }else{
        // Solo scores table
        query=supabaseClient.from(table)
            .select('score,created_at,user_id')
            .eq('game_id',gameId)
            .order('score',{ascending:game.ascending})
            .limit(50);
    }

    // Time filters
    if(currentTab==='today'){
        const today=new Date();today.setHours(0,0,0,0);
        if(game.isDaily){
            query=query.eq('puzzle_date',today.toISOString().split('T')[0]);
        }else{
            query=query.gte('created_at',today.toISOString());
        }
    }else if(currentTab==='week'){
        const weekAgo=new Date();weekAgo.setDate(weekAgo.getDate()-7);
        if(game.isDaily){
            query=query.gte('puzzle_date',weekAgo.toISOString().split('T')[0]);
        }else{
            query=query.gte('created_at',weekAgo.toISOString());
        }
    }else if(currentTab==='friends'){
        const allFriendIds=[...friendIds,currentUserId];
        query=query.in('user_id',allFriendIds);
    }

    const{data,error}=await query;
    
    if(error||!data?.length){
        clearPodium();
        if(currentTab==='friends'){
            podium.style.display='none';
            friendsEmpty.style.display='block';
            friendsEmpty.querySelector('h4').textContent='No Scores Yet';
            friendsEmpty.querySelector('p').textContent='You or your friends haven\'t played this game yet!';
        }else{
            lbList.innerHTML=`<div class="lb-empty"><div class="lb-empty-icon">üèÜ</div>${currentTab==='today'?'No scores today yet.':currentTab==='week'?'No scores this week.':'No scores yet.'} Be the first!</div>`;
        }
        return;
    }

    const userIds=[...new Set(data.map(e=>e.user_id))];
    const{data:profiles}=await supabaseClient.from('profiles').select('id,display_name,gamer_tag').in('id',userIds);
    const profileMap={};
    profiles?.forEach(p=>profileMap[p.id]=p);

    renderLeaderboard(data,profileMap,game);
}

function renderLeaderboard(data,profileMap,game){
    // Format score based on game type
    function formatScore(entry){
        if(game.isDaily){
            // Connections: show mistakes and time
            const mins=Math.floor(entry.time_seconds/60);
            const secs=entry.time_seconds%60;
            return`${entry.mistakes} err ¬∑ ${mins}:${String(secs).padStart(2,'0')}`;
        }
        return`${entry.score} ${game.unit}`;
    }

    // Podium
    [1,2,3].forEach(rank=>{
        const entry=data[rank-1];
        const spot=document.getElementById(`podium-${rank}`);
        if(entry){
            const profile=profileMap[entry.user_id];
            const name=profile?.display_name||profile?.gamer_tag||'Anonymous';
            const initial=name.charAt(0).toUpperCase();
            spot.querySelector('.podium-avatar').textContent=initial;
            spot.querySelector('.podium-name').textContent=name;
            spot.querySelector('.podium-score').textContent=formatScore(entry);
        }
    });

    // List (4+)
    lbList.innerHTML='';
    data.slice(3).forEach((entry,i)=>{
        const profile=profileMap[entry.user_id];
        const name=profile?.display_name||profile?.gamer_tag||'Anonymous';
        const initial=name.charAt(0).toUpperCase();
        const isYou=entry.user_id===currentUserId;
        const dateField=game.isDaily?entry.puzzle_date:entry.created_at;
        const date=new Date(dateField).toLocaleDateString('en-US',{month:'short',day:'numeric'});
        
        const row=document.createElement('div');
        row.className=`lb-row${isYou?' you':''}`;
        row.innerHTML=`
            <div class="lb-rank">${i+4}</div>
            <div class="lb-avatar">${escapeHtml(initial)}</div>
            <div class="lb-player">
                <div class="lb-name">${escapeHtml(name)}</div>
                ${isYou?'<div class="lb-you-badge">You</div>':`<div class="lb-date">${date}</div>`}
            </div>
            <div class="lb-score">${formatScore(entry)}</div>
        `;
        lbList.appendChild(row);
    });
}

function escapeHtml(text){
    const div=document.createElement('div');
    div.textContent=text;
    return div.innerHTML;
}

// URL params
function handleUrlParams(){
    const params=new URLSearchParams(window.location.search);
    const gameParam=params.get('game');
    if(gameParam&&GAMES[gameParam]){
        currentGame=gameParam;
        if(GAMES[gameParam].isDaily){
            currentCat='daily';
            catBtns.forEach(b=>b.classList.toggle('active',b.dataset.cat==='daily'));
            soloGames.style.display='none';
            dailyGames.style.display='flex';
        }
        gameBtns.forEach(b=>b.classList.toggle('active',b.dataset.game===gameParam));
    }
}

// Init
handleUrlParams();
updateFiltersAndBadge();
updateLeaderboardVisibility();
</script>

<!-- Social System -->
<link rel="stylesheet" href="/social.css">
<script src="/social.js" defer></script>

</body>
</html>
