<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <title>Daily Crossword ‚Äì Free Mini Puzzle | TheGaming.co</title>
    <meta name="description" content="Play free daily mini crossword puzzles. Quick 5-minute brain workout with new puzzles every day.">
    <meta name="theme-color" content="#0a0a0f">
    <link rel="stylesheet" href="/header.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --accent:#8b5cf6;--accent-dark:#7c3aed;--accent-light:#ede9fe;
            --gold:#fbbf24;--green:#22c55e;--text-dark:#1a1a2e;--text-muted:#6b7280;
        }
        html,body{overscroll-behavior:none}
        body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#faf5ff 0%,#ede9fe 50%,#f5f3ff 100%);color:var(--text-dark);min-height:100vh;min-height:100dvh;display:flex;flex-direction:column}
        h1,h2,h3,h4{font-family:'Bebas Neue',sans-serif;letter-spacing:1px}
        a{color:inherit;text-decoration:none}

        main{flex:1;display:flex;flex-direction:column;padding-top:60px}
        
        .game-hero{
            background:linear-gradient(135deg,#7c3aed 0%,#8b5cf6 50%,#a78bfa 100%);
            padding:40px 20px;
            text-align:center;
            position:relative;
            overflow:hidden;
        }
        .game-hero::before{
            content:'';position:absolute;inset:0;
            background:radial-gradient(circle at 20% 30%,rgba(255,255,255,0.15) 0%,transparent 50%),
                       radial-gradient(circle at 80% 70%,rgba(139,92,246,0.3) 0%,transparent 50%);
        }
        .game-hero::after{
            content:'';position:absolute;bottom:0;left:0;right:0;height:60px;
            background:linear-gradient(to top,rgba(250,245,255,0.3),transparent);
        }
        .game-hero-content{position:relative;z-index:1;max-width:600px;margin:0 auto}
        
        .game-icon{
            width:80px;height:80px;margin:0 auto 16px;
            background:rgba(255,255,255,0.15);
            border-radius:20px;
            padding:12px;
            backdrop-filter:blur(10px);
            animation:iconFloat 3s ease-in-out infinite;
        }
        @keyframes iconFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
        
        .game-hero-title{
            font-size:clamp(2.8rem,8vw,4rem);
            line-height:0.95;margin-bottom:8px;
            color:#fff;letter-spacing:4px;
            text-shadow:0 4px 20px rgba(0,0,0,0.2);
        }
        .game-hero-desc{font-size:0.95rem;color:rgba(255,255,255,0.85)}
        
        .daily-badge{
            display:inline-flex;align-items:center;gap:6px;
            margin-top:14px;padding:8px 18px;
            background:rgba(255,255,255,0.2);
            backdrop-filter:blur(10px);
            border:1px solid rgba(255,255,255,0.3);
            color:#fff;border-radius:50px;
            font-size:0.75rem;font-weight:700;
            text-transform:uppercase;letter-spacing:1px;
        }

        .game-wrapper{flex:1;display:flex;flex-direction:column;align-items:center;padding:30px 16px 50px}
        .game-container{width:100%;max-width:800px;display:flex;flex-direction:column;gap:20px}

        .puzzle-info{
            display:flex;justify-content:space-between;align-items:center;
            flex-wrap:wrap;gap:12px;
            padding:16px 20px;
            background:#fff;
            border-radius:16px;
            box-shadow:0 4px 20px rgba(139,92,246,0.1);
        }
        .puzzle-date{
            font-family:'Bebas Neue',sans-serif;
            font-size:1.4rem;letter-spacing:1px;
            background:linear-gradient(135deg,var(--accent),var(--accent-dark));
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
        }
        .puzzle-timer{
            font-family:'Bebas Neue',sans-serif;
            font-size:1.4rem;color:var(--text-muted);
            display:flex;align-items:center;gap:6px;
        }
        .puzzle-timer::before{content:'‚è±Ô∏è';font-size:1rem}

        .crossword-layout{display:grid;grid-template-columns:auto 1fr;gap:20px}
        @media(max-width:700px){.crossword-layout{grid-template-columns:1fr}}

        .game-board{
            background:#fff;
            border-radius:24px;
            padding:24px;
            box-shadow:0 8px 40px rgba(139,92,246,0.12);
            display:flex;flex-direction:column;align-items:center;
        }
        
        .crossword-grid{
            display:grid;
            gap:3px;
            background:linear-gradient(135deg,#1e1b4b,#312e81);
            padding:4px;
            border-radius:12px;
            box-shadow:0 4px 20px rgba(30,27,75,0.3);
        }
        
        .cw-cell{
            width:52px;height:52px;
            background:#fff;
            display:flex;align-items:center;justify-content:center;
            position:relative;
            cursor:pointer;
            transition:all 0.15s ease;
            border-radius:4px;
        }
        .cw-cell.black{
            background:linear-gradient(135deg,#1e1b4b,#312e81);
            cursor:default;
        }
        .cw-cell.selected{
            background:linear-gradient(135deg,var(--accent-light),#ddd6fe);
            box-shadow:inset 0 0 0 3px var(--accent);
        }
        .cw-cell.highlighted{
            background:#fef3c7;
        }
        .cw-cell.correct{
            background:linear-gradient(135deg,#dcfce7,#bbf7d0);
        }
        .cw-cell.correct::after{
            content:'‚úì';position:absolute;top:2px;right:3px;
            font-size:0.5rem;color:var(--green);
        }
        .cw-cell-number{
            position:absolute;top:3px;left:4px;
            font-size:0.65rem;font-weight:800;
            color:var(--accent-dark);
        }
        .cw-cell-input{
            width:100%;height:100%;
            border:none;background:transparent;
            text-align:center;
            font-family:'Bebas Neue',sans-serif;
            font-size:1.6rem;
            text-transform:uppercase;
            outline:none;cursor:pointer;
            color:var(--text-dark);
            caret-color:var(--accent);
        }

        .controls{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:20px}
        .ctrl-btn{
            padding:12px 20px;
            border-radius:12px;
            background:linear-gradient(135deg,#f5f3ff,#ede9fe);
            border:2px solid rgba(139,92,246,0.2);
            font-family:'Bebas Neue',sans-serif;
            font-size:0.95rem;letter-spacing:1px;
            color:var(--accent-dark);
            cursor:pointer;
            transition:all 0.2s;
            display:flex;align-items:center;gap:6px;
        }
        .ctrl-btn:hover{
            background:var(--accent);color:#fff;
            border-color:var(--accent);
            transform:translateY(-2px);
            box-shadow:0 6px 20px rgba(139,92,246,0.3);
        }

        .clues-panel{
            background:#fff;
            border-radius:24px;
            padding:24px;
            box-shadow:0 8px 40px rgba(139,92,246,0.12);
            max-height:520px;overflow-y:auto;
        }
        .clues-section{margin-bottom:20px}
        .clues-title{
            font-family:'Bebas Neue',sans-serif;
            font-size:1.3rem;letter-spacing:2px;
            color:var(--accent);
            margin-bottom:12px;
            padding-bottom:10px;
            border-bottom:3px solid var(--accent-light);
            display:flex;align-items:center;gap:8px;
        }
        .clues-title::before{content:'';width:4px;height:20px;background:var(--accent);border-radius:2px}
        
        .clue-item{
            padding:10px 14px;
            border-radius:10px;
            font-size:0.88rem;line-height:1.5;
            cursor:pointer;
            transition:all 0.15s;
            margin-bottom:6px;
            border-left:3px solid transparent;
        }
        .clue-item:hover{
            background:rgba(139,92,246,0.08);
            border-left-color:var(--accent);
        }
        .clue-item.active{
            background:var(--accent-light);
            border-left-color:var(--accent);
            font-weight:600;
        }
        .clue-item.solved{
            color:var(--green);
            text-decoration:line-through;
            opacity:0.6;
        }
        .clue-number{
            font-weight:800;
            color:var(--accent);
            margin-right:8px;
            font-size:0.95rem;
        }

        .casual-notice{
            background:linear-gradient(135deg,rgba(139,92,246,0.08),rgba(139,92,246,0.04));
            border:2px solid rgba(139,92,246,0.15);
            border-radius:16px;
            padding:18px 24px;
            text-align:center;
            display:flex;align-items:center;justify-content:center;gap:10px;
        }
        .casual-notice p{color:var(--text-muted);font-size:0.85rem}
        .casual-notice strong{color:var(--accent)}

        .complete-overlay{
            position:fixed;inset:0;
            background:rgba(0,0,0,0.85);
            display:none;align-items:center;justify-content:center;
            z-index:200;padding:20px;
            backdrop-filter:blur(8px);
        }
        .complete-overlay.show{display:flex}
        .complete-modal{
            background:#fff;
            border-radius:28px;
            padding:40px 32px;
            text-align:center;
            max-width:360px;width:100%;
            box-shadow:0 25px 80px rgba(0,0,0,0.4);
            animation:modalPop 0.3s ease;
        }
        @keyframes modalPop{from{transform:scale(0.9);opacity:0}to{transform:scale(1);opacity:1}}
        
        .complete-icon{font-size:4.5rem;margin-bottom:12px;animation:bounce 0.5s ease}
        @keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}
        
        .complete-title{
            font-size:2rem;letter-spacing:3px;
            background:linear-gradient(135deg,var(--green),#16a34a);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            margin-bottom:6px;
        }
        .complete-time{
            font-family:'Bebas Neue',sans-serif;
            font-size:3rem;
            color:var(--accent);margin:16px 0;
        }
        .complete-message{color:var(--text-muted);margin-bottom:24px;font-size:0.9rem}
        
        .btn{
            padding:14px 28px;border-radius:50px;border:none;
            font-weight:700;font-size:0.9rem;cursor:pointer;
            transition:all 0.3s;text-transform:uppercase;
            letter-spacing:1px;width:100%;margin-bottom:10px;
        }
        .btn-primary{
            background:linear-gradient(135deg,var(--accent),var(--accent-dark));
            color:#fff;
            box-shadow:0 6px 25px rgba(139,92,246,0.35);
        }
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(139,92,246,0.45)}
        .btn-secondary{
            background:#fff;color:var(--text-dark);
            border:2px solid rgba(139,92,246,0.25);
        }

        @media(max-width:500px){
            .cw-cell{width:46px;height:46px}
            .cw-cell-input{font-size:1.4rem}
            .cw-cell-number{font-size:0.55rem}
            .clues-panel{max-height:400px}
        }
    </style>
</head>
<body>
    <div id="site-header"></div>

    <main>
        <section class="game-hero">
            <div class="game-hero-content">
                <div class="game-icon">
                    <svg viewBox="0 0 56 56" fill="none">
                        <rect x="2" y="2" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="20" y="2" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="38" y="2" width="16" height="16" rx="2" fill="rgba(255,255,255,0.3)"/>
                        <rect x="2" y="20" width="16" height="16" rx="2" fill="rgba(255,255,255,0.3)"/>
                        <rect x="20" y="20" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="38" y="20" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="2" y="38" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="20" y="38" width="16" height="16" rx="2" fill="#fff"/>
                        <rect x="38" y="38" width="16" height="16" rx="2" fill="#fff"/>
                        <text x="10" y="14" fill="#8b5cf6" font-family="sans-serif" font-size="11" font-weight="bold" text-anchor="middle">A</text>
                        <text x="28" y="14" fill="#8b5cf6" font-family="sans-serif" font-size="11" font-weight="bold" text-anchor="middle">B</text>
                    </svg>
                </div>
                <h1 class="game-hero-title">CROSSWORD</h1>
                <p class="game-hero-desc">Quick 5√ó5 mini puzzles ‚Ä¢ A new challenge every day!</p>
                <div class="daily-badge">‚ú® Daily Puzzle</div>
            </div>
        </section>

        <div class="game-wrapper">
            <div class="game-container">
                <div class="puzzle-info">
                    <div class="puzzle-date" id="puzzle-date">Loading...</div>
                    <div class="puzzle-timer" id="timer">0:00</div>
                </div>

                <div class="crossword-layout">
                    <div class="game-board">
                        <div class="crossword-grid" id="crossword-grid"></div>
                        <div class="controls">
                            <button class="ctrl-btn" onclick="checkAnswers()">‚úî Check</button>
                            <button class="ctrl-btn" onclick="revealWord()">üëÅ Reveal</button>
                            <button class="ctrl-btn" onclick="clearGrid()">‚úñ Clear</button>
                        </div>
                    </div>

                    <div class="clues-panel">
                        <div class="clues-section">
                            <h3 class="clues-title">ACROSS</h3>
                            <div id="across-clues"></div>
                        </div>
                        <div class="clues-section">
                            <h3 class="clues-title">DOWN</h3>
                            <div id="down-clues"></div>
                        </div>
                    </div>
                </div>

                <div class="casual-notice">
                    <p>üß© <strong>Casual Mode</strong> ‚Äî No pressure, just enjoy the puzzle at your own pace!</p>
                </div>
            </div>
        </div>
    </main>

    <div class="complete-overlay" id="complete-overlay">
        <div class="complete-modal">
            <div class="complete-icon">üéâ</div>
            <h2 class="complete-title">COMPLETE!</h2>
            <div class="complete-time" id="complete-time">0:00</div>
            <p class="complete-message">Great job! Come back tomorrow for a new puzzle.</p>
            <button class="btn btn-primary" onclick="sharePuzzle()">üì§ SHARE RESULT</button>
            <button class="btn btn-secondary" onclick="document.getElementById('complete-overlay').classList.remove('show')">CLOSE</button>
        </div>
    </div>

<script>
const SUPABASE_URL='https://tvvivtmzofsyehatzlvl.supabase.co';
const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR2dml2dG16b2ZzeWVoYXR6bHZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4OTExODYsImV4cCI6MjA4MDQ2NzE4Nn0.Qy8kHMO0Nb4yJ0ZHjby7RuQtzwWB8rUcZvkdnbL1b3M';
const supabaseClient=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

const PUZZLES=[
    {
        grid:[['C','A','T','S','#'],['A','#','O','#','S'],['R','I','D','E','S'],['E','#','A','#','K'],['#','B','Y','E','S']],
        across:{1:{clue:'Feline pets',row:0,col:0,len:4},5:{clue:'Travels on horseback',row:2,col:0,len:5},6:{clue:'Farewells',row:4,col:1,len:4}},
        down:{1:{clue:'Vehicle',row:0,col:0,len:4},2:{clue:'Present moment',row:0,col:2,len:5},3:{clue:'Requests',row:0,col:4,len:4},4:{clue:'Short laugh',row:2,col:1,len:3}}
    },
    {
        grid:[['S','T','A','R','S'],['H','#','#','O','#'],['O','P','E','N','S'],['W','#','#','E','#'],['S','T','E','P','S']],
        across:{1:{clue:'Celestial bodies',row:0,col:0,len:5},4:{clue:'Unlocks',row:2,col:0,len:5},6:{clue:'Stairs',row:4,col:0,len:5}},
        down:{1:{clue:'Displays',row:0,col:0,len:5},2:{clue:'Solo performance',row:0,col:3,len:4},3:{clue:'Foot movements',row:2,col:1,len:3}}
    },
    {
        grid:[['P','L','A','N','E'],['I','#','#','O','#'],['Z','O','N','E','S'],['Z','#','#','S','#'],['A','R','E','A','S']],
        across:{1:{clue:'Aircraft',row:0,col:0,len:5},4:{clue:'Regions',row:2,col:0,len:5},6:{clue:'Sections',row:4,col:0,len:5}},
        down:{1:{clue:'Italian pie',row:0,col:0,len:5},2:{clue:'Proboscis',row:0,col:3,len:4},3:{clue:'Single',row:2,col:1,len:3}}
    },
    {
        grid:[['B','E','A','C','H'],['A','#','#','A','#'],['S','A','N','D','Y'],['I','#','#','E','#'],['C','O','A','S','T']],
        across:{1:{clue:'Seaside spot',row:0,col:0,len:5},4:{clue:'Full of sand',row:2,col:0,len:5},6:{clue:'Shoreline',row:4,col:0,len:5}},
        down:{1:{clue:'Fundamental',row:0,col:0,len:5},2:{clue:'Playing cards',row:0,col:3,len:4},3:{clue:'Land',row:2,col:1,len:3}}
    },
    {
        grid:[['M','U','S','I','C'],['A','#','#','N','#'],['G','A','M','E','S'],['I','#','#','R','#'],['C','H','E','S','S']],
        across:{1:{clue:'Melodies and rhythm',row:0,col:0,len:5},4:{clue:'Fun activities',row:2,col:0,len:5},6:{clue:'Board game with kings',row:4,col:0,len:5}},
        down:{1:{clue:'Wizardry',row:0,col:0,len:5},2:{clue:'Interior',row:0,col:3,len:4},3:{clue:'Breakfast food',row:2,col:1,len:3}}
    },
    {
        grid:[['W','O','R','D','S'],['A','#','#','A','#'],['T','I','M','E','S'],['E','#','#','S','#'],['R','I','V','E','R']],
        across:{1:{clue:'Vocabulary units',row:0,col:0,len:5},4:{clue:'Occasions',row:2,col:0,len:5},6:{clue:'Flowing water body',row:4,col:0,len:5}},
        down:{1:{clue:'H2O',row:0,col:0,len:5},2:{clue:'Information',row:0,col:3,len:4},3:{clue:'Myself',row:2,col:1,len:3}}
    },
    {
        grid:[['L','I','G','H','T'],['E','#','#','O','#'],['A','D','U','L','T'],['R','#','#','E','#'],['N','I','G','H','T']],
        across:{1:{clue:'Illumination',row:0,col:0,len:5},4:{clue:'Grown-up',row:2,col:0,len:5},6:{clue:'Evening darkness',row:4,col:0,len:5}},
        down:{1:{clue:'Study',row:0,col:0,len:5},2:{clue:'Vacation inn',row:0,col:3,len:4},3:{clue:'Commercial',row:2,col:1,len:3}}
    }
];

let currentPuzzle,userGrid,selectedCell=null,selectedDirection='across',timerInterval=null,seconds=0,completed=false;

function getDailyPuzzle(){
    const today=new Date().toISOString().split('T')[0];
    const seed=hashCode(today);
    return PUZZLES[Math.abs(seed)%PUZZLES.length];
}

function hashCode(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0}return h}

function initPuzzle(){
    currentPuzzle=getDailyPuzzle();
    userGrid=currentPuzzle.grid.map(row=>row.map(cell=>cell==='#'?'#':''));
    completed=false;
    seconds=0;
    
    const today=new Date();
    document.getElementById('puzzle-date').textContent=today.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'});
    
    renderGrid();
    renderClues();
    startTimer();
}

function renderGrid(){
    const gridEl=document.getElementById('crossword-grid');
    gridEl.style.gridTemplateColumns='repeat(5,1fr)';
    gridEl.innerHTML='';
    
    let cellNum=1;
    const numberMap={};
    
    for(let r=0;r<5;r++){
        for(let c=0;c<5;c++){
            if(currentPuzzle.grid[r][c]==='#')continue;
            const needsNumber=(c===0||currentPuzzle.grid[r][c-1]==='#')||(r===0||currentPuzzle.grid[r-1][c]==='#');
            if(needsNumber){numberMap[`${r}-${c}`]=cellNum++}
        }
    }
    
    for(let r=0;r<5;r++){
        for(let c=0;c<5;c++){
            const cell=document.createElement('div');
            cell.className='cw-cell';
            cell.dataset.row=r;cell.dataset.col=c;
            
            if(currentPuzzle.grid[r][c]==='#'){
                cell.classList.add('black');
            }else{
                const num=numberMap[`${r}-${c}`];
                if(num){
                    const numSpan=document.createElement('span');
                    numSpan.className='cw-cell-number';
                    numSpan.textContent=num;
                    cell.appendChild(numSpan);
                }
                
                const input=document.createElement('input');
                input.className='cw-cell-input';
                input.maxLength=1;
                input.value=userGrid[r][c];
                input.addEventListener('focus',()=>selectCell(r,c));
                input.addEventListener('input',e=>handleInput(r,c,e));
                input.addEventListener('keydown',e=>handleKeydown(r,c,e));
                cell.appendChild(input);
                cell.addEventListener('click',()=>selectCell(r,c));
            }
            gridEl.appendChild(cell);
        }
    }
}

function renderClues(){
    const acrossEl=document.getElementById('across-clues');
    const downEl=document.getElementById('down-clues');
    acrossEl.innerHTML='';downEl.innerHTML='';
    
    Object.entries(currentPuzzle.across).forEach(([num,data])=>{
        const div=document.createElement('div');
        div.className='clue-item';
        div.dataset.num=num;div.dataset.dir='across';
        div.innerHTML=`<span class="clue-number">${num}.</span>${data.clue}`;
        div.addEventListener('click',()=>{selectedDirection='across';selectClue(num,'across')});
        acrossEl.appendChild(div);
    });
    
    Object.entries(currentPuzzle.down).forEach(([num,data])=>{
        const div=document.createElement('div');
        div.className='clue-item';
        div.dataset.num=num;div.dataset.dir='down';
        div.innerHTML=`<span class="clue-number">${num}.</span>${data.clue}`;
        div.addEventListener('click',()=>{selectedDirection='down';selectClue(num,'down')});
        downEl.appendChild(div);
    });
}

function selectCell(r,c){
    if(currentPuzzle.grid[r][c]==='#')return;
    if(selectedCell&&selectedCell.r===r&&selectedCell.c===c){
        selectedDirection=selectedDirection==='across'?'down':'across';
    }
    selectedCell={r,c};
    highlightCells();
    const input=document.querySelector(`.cw-cell[data-row="${r}"][data-col="${c}"] input`);
    if(input)input.focus();
}

function selectClue(num,dir){
    const data=dir==='across'?currentPuzzle.across[num]:currentPuzzle.down[num];
    selectedCell={r:data.row,c:data.col};
    selectedDirection=dir;
    highlightCells();
    const input=document.querySelector(`.cw-cell[data-row="${data.row}"][data-col="${data.col}"] input`);
    if(input)input.focus();
}

function highlightCells(){
    document.querySelectorAll('.cw-cell').forEach(cell=>cell.classList.remove('selected','highlighted'));
    document.querySelectorAll('.clue-item').forEach(item=>item.classList.remove('active'));
    if(!selectedCell)return;
    
    const{r,c}=selectedCell;
    document.querySelector(`.cw-cell[data-row="${r}"][data-col="${c}"]`)?.classList.add('selected');
    
    if(selectedDirection==='across'){
        let startC=c;
        while(startC>0&&currentPuzzle.grid[r][startC-1]!=='#')startC--;
        for(let i=startC;i<5&&currentPuzzle.grid[r][i]!=='#';i++){
            document.querySelector(`.cw-cell[data-row="${r}"][data-col="${i}"]`)?.classList.add('highlighted');
        }
    }else{
        let startR=r;
        while(startR>0&&currentPuzzle.grid[startR-1][c]!=='#')startR--;
        for(let i=startR;i<5&&currentPuzzle.grid[i][c]!=='#';i++){
            document.querySelector(`.cw-cell[data-row="${i}"][data-col="${c}"]`)?.classList.add('highlighted');
        }
    }
}

function handleInput(r,c,e){
    const val=e.target.value.toUpperCase().replace(/[^A-Z]/g,'');
    e.target.value=val;
    userGrid[r][c]=val;
    if(val)moveNext(r,c);
    checkCompletion();
}

function handleKeydown(r,c,e){
    if(e.key==='Backspace'&&!userGrid[r][c]){
        e.preventDefault();
        movePrev(r,c);
    }else if(e.key==='ArrowRight'){e.preventDefault();moveToCell(r,c+1)}
    else if(e.key==='ArrowLeft'){e.preventDefault();moveToCell(r,c-1)}
    else if(e.key==='ArrowDown'){e.preventDefault();moveToCell(r+1,c)}
    else if(e.key==='ArrowUp'){e.preventDefault();moveToCell(r-1,c)}
    else if(e.key===' '){e.preventDefault();selectedDirection=selectedDirection==='across'?'down':'across';highlightCells()}
}

function moveNext(r,c){
    if(selectedDirection==='across'){
        for(let i=c+1;i<5;i++)if(currentPuzzle.grid[r][i]!=='#'){moveToCell(r,i);return}
    }else{
        for(let i=r+1;i<5;i++)if(currentPuzzle.grid[i][c]!=='#'){moveToCell(i,c);return}
    }
}

function movePrev(r,c){
    if(selectedDirection==='across'){
        for(let i=c-1;i>=0;i--)if(currentPuzzle.grid[r][i]!=='#'){moveToCell(r,i);return}
    }else{
        for(let i=r-1;i>=0;i--)if(currentPuzzle.grid[i][c]!=='#'){moveToCell(i,c);return}
    }
}

function moveToCell(r,c){
    if(r<0||r>=5||c<0||c>=5||currentPuzzle.grid[r][c]==='#')return;
    selectCell(r,c);
}

function checkAnswers(){
    document.querySelectorAll('.cw-cell').forEach(cell=>{
        const r=parseInt(cell.dataset.row),c=parseInt(cell.dataset.col);
        if(currentPuzzle.grid[r][c]==='#')return;
        cell.classList.remove('correct');
        if(userGrid[r][c]===currentPuzzle.grid[r][c])cell.classList.add('correct');
    });
}

function revealWord(){
    if(!selectedCell)return;
    const{r,c}=selectedCell;
    if(selectedDirection==='across'){
        let startC=c;
        while(startC>0&&currentPuzzle.grid[r][startC-1]!=='#')startC--;
        for(let i=startC;i<5&&currentPuzzle.grid[r][i]!=='#';i++){
            userGrid[r][i]=currentPuzzle.grid[r][i];
            const input=document.querySelector(`.cw-cell[data-row="${r}"][data-col="${i}"] input`);
            if(input)input.value=currentPuzzle.grid[r][i];
        }
    }else{
        let startR=r;
        while(startR>0&&currentPuzzle.grid[startR-1][c]!=='#')startR--;
        for(let i=startR;i<5&&currentPuzzle.grid[i][c]!=='#';i++){
            userGrid[i][c]=currentPuzzle.grid[i][c];
            const input=document.querySelector(`.cw-cell[data-row="${i}"][data-col="${c}"] input`);
            if(input)input.value=currentPuzzle.grid[i][c];
        }
    }
    checkCompletion();
}

function clearGrid(){
    for(let r=0;r<5;r++)for(let c=0;c<5;c++)if(currentPuzzle.grid[r][c]!=='#')userGrid[r][c]='';
    document.querySelectorAll('.cw-cell-input').forEach(input=>input.value='');
    document.querySelectorAll('.cw-cell').forEach(cell=>cell.classList.remove('correct'));
}

function checkCompletion(){
    for(let r=0;r<5;r++){
        for(let c=0;c<5;c++){
            if(currentPuzzle.grid[r][c]!=='#'&&userGrid[r][c]!==currentPuzzle.grid[r][c])return;
        }
    }
    if(!completed){
        completed=true;
        clearInterval(timerInterval);
        document.getElementById('complete-time').textContent=formatTime(seconds);
        document.getElementById('complete-overlay').classList.add('show');
    }
}

function startTimer(){
    clearInterval(timerInterval);
    timerInterval=setInterval(()=>{seconds++;document.getElementById('timer').textContent=formatTime(seconds)},1000);
}

function formatTime(s){return`${Math.floor(s/60)}:${(s%60).toString().padStart(2,'0')}`}

function sharePuzzle(){
    const today=new Date().toLocaleDateString('en-US',{month:'short',day:'numeric'});
    const text=`üìù Mini Crossword - ${today}\n‚è±Ô∏è ${formatTime(seconds)}\n\nthegaming.co/games/solo/crossword.html`;
    if(navigator.share)navigator.share({text});
    else{navigator.clipboard.writeText(text);alert('Copied to clipboard!')}
}

initPuzzle();
</script>
<script src="/header.js"></script>
</body>
</html>
